{"version":3,"sources":["webpack://slender/./data/assets.js","webpack://slender/./data/sounds.js","webpack://slender/./js/components/Audio/GameSounds.js","webpack://slender/./js/components/Audio/MenuSounds.js","webpack://slender/./js/components/Audio/NoiseSounds.js","webpack://slender/./js/components/Audio/PaperSounds.js","webpack://slender/./js/components/Audio/PlayerSounds.js","webpack://slender/./js/components/Audio/Sounds.js","webpack://slender/./js/components/Audio/index.js","webpack://slender/./js/components/Bitmap.js","webpack://slender/./js/components/Camera.js","webpack://slender/./js/components/Controls.js","webpack://slender/./js/components/Game.js","webpack://slender/./js/components/GameLoop.js","webpack://slender/./js/components/Map.js","webpack://slender/./js/components/NPC.js","webpack://slender/./js/components/Objects.js","webpack://slender/./js/components/Paper.js","webpack://slender/./js/components/Player.js","webpack://slender/./js/utils/calc.js","webpack://slender/./js/utils/sound.js","webpack://slender/./img/bushes/bush_0.png","webpack://slender/./img/bushes/bush_1.png","webpack://slender/./img/bushes/bush_2.png","webpack://slender/./img/bushes/bush_3.png","webpack://slender/./img/bushes/bush_4.png","webpack://slender/./img/bushes/rain_bush_0.png","webpack://slender/./img/bushes/rain_bush_1.png","webpack://slender/./img/bushes/rain_bush_2.png","webpack://slender/./img/bushes/rain_bush_3.png","webpack://slender/./img/bushes/rain_bush_4.png","webpack://slender/./img/fence_door_0.jpg","webpack://slender/./img/npc/npc-1.png","webpack://slender/./img/npc/npc-2.png","webpack://slender/./img/npc/npc-3.png","webpack://slender/./img/npc/npc-4.png","webpack://slender/./img/npc/npc2-1.png","webpack://slender/./img/npc/npc2-2.png","webpack://slender/./img/npc/npc2-3.png","webpack://slender/./img/npc/npc2-4.png","webpack://slender/./img/npc/npc3-1.png","webpack://slender/./img/npc/npc3-2.png","webpack://slender/./img/npc/npc3-3.png","webpack://slender/./img/npc/npc3-4.png","webpack://slender/./img/npc/npc_die.gif","webpack://slender/./img/papers/paper_0.png","webpack://slender/./img/papers/paper_1.png","webpack://slender/./img/papers/paper_2.png","webpack://slender/./img/papers/paper_3.png","webpack://slender/./img/papers/paper_4.png","webpack://slender/./img/papers/paper_5.png","webpack://slender/./img/papers/paper_6.png","webpack://slender/./img/papers/paper_7.png","webpack://slender/./img/rain/rain_fence.jpg","webpack://slender/./img/rain/rain_sky_panorama.jpg","webpack://slender/./img/rain/rain_wall_texture.jpg","webpack://slender/./img/slender/left_hand.png","webpack://slender/./img/slender/right_hand.png","webpack://slender/./img/snow/fence_snow.png","webpack://slender/./img/snow/sky_panorama_snow.jpg","webpack://slender/./img/snow/wall_texture_snow.jpg","webpack://slender/./img/trees/rain_tree_0.png","webpack://slender/./img/trees/rain_tree_1.png","webpack://slender/./img/trees/rain_tree_2.png","webpack://slender/./img/trees/rain_tree_3.png","webpack://slender/./img/trees/tree_0.png","webpack://slender/./img/trees/tree_1.png","webpack://slender/./img/trees/tree_2.png","webpack://slender/./img/trees/tree_3.png","webpack://slender/./sounds/ambient/ghost_in_the_house.mp3","webpack://slender/./sounds/ambient/just_horror_ambient.mp3","webpack://slender/./sounds/ambient/piano_menu_ambient.mp3","webpack://slender/./sounds/ambient/rain_ambient.mp3","webpack://slender/./sounds/ambient/scary_piano.mp3","webpack://slender/./sounds/ambient/static_menu_ambient.mp3","webpack://slender/./sounds/ambient/weird_noises.mp3","webpack://slender/./sounds/ambient/wind_ambient.mp3","webpack://slender/./sounds/ending/come_out.mp3","webpack://slender/./sounds/ending/ghost_scream.mp3","webpack://slender/./sounds/ending/lululala.mp3","webpack://slender/./sounds/menu/about_game.mp3","webpack://slender/./sounds/menu/about_us.mp3","webpack://slender/./sounds/menu/ho_ho_ho.mp3","webpack://slender/./sounds/menu/play_button_hover.mp3","webpack://slender/./sounds/menu/slender_logo_hover.mp3","webpack://slender/./sounds/objects/entering_area.mp3","webpack://slender/./sounds/objects/hitting_the_fence.mp3","webpack://slender/./sounds/objects/hitting_the_rain_fence.mp3","webpack://slender/./sounds/objects/hitting_the_wall.mp3","webpack://slender/./sounds/objects/killing.mp3","webpack://slender/./sounds/objects/placing_bomb.mp3","webpack://slender/./sounds/objects/placing_loo_paper.mp3","webpack://slender/./sounds/objects/placing_paper.mp3","webpack://slender/./sounds/objects/slashing.mp3","webpack://slender/./sounds/walking/backward_step.mp3","webpack://slender/./sounds/walking/dodge_step_0.mp3","webpack://slender/./sounds/walking/dodge_step_1.mp3","webpack://slender/./sounds/walking/forward_step.mp3","webpack://slender/./sounds/walking/rain_backward_step.mp3","webpack://slender/./sounds/walking/rain_dodge_step_0.mp3","webpack://slender/./sounds/walking/rain_dodge_step_1.mp3","webpack://slender/./sounds/walking/rain_forward_step.mp3","webpack://slender/./sounds/walking/rain_running.mp3","webpack://slender/./sounds/walking/rain_step.mp3","webpack://slender/./sounds/walking/running.mp3","webpack://slender/./img/intro.mp4","webpack://slender/./node_modules/soundmanager2/script/soundmanager2.js","webpack://slender/webpack/bootstrap","webpack://slender/webpack/runtime/compat get default export","webpack://slender/webpack/runtime/define property getters","webpack://slender/webpack/runtime/global","webpack://slender/webpack/runtime/hasOwnProperty shorthand","webpack://slender/webpack/runtime/make namespace object","webpack://slender/webpack/runtime/node module decorator","webpack://slender/webpack/runtime/publicPath","webpack://slender/./js/main.js","webpack://slender/./css/style.css","webpack://slender/./css/font-awesome.min.css"],"names":["ASSETS","trees","texture","require","width","height","rain_trees","bushes","rain_bushes","papers","slender","npc","mode","fenceDoor","snow","fence","sky","wall","default","rain","SOUNDS","MENU","PIANO_MENU","id","url","STATIC_MENU","volume","SLENDER_LOGO","PLAY_BUTTON","HO_HO","ABOUT_US","ABOUT_GAME","WINTER","WIND","FORWARD_STEP","BACKWARD_STEP","DODGE_STEP_0","DODGE_STEP_1","RUNNING","VANILLA","RAIN","RAIN_FORWARD_STEP","RAIN_BACKWARD_STEP","RAIN_STEP","RAIN_DODGE_STEP_0","RAIN_DODGE_STEP_1","RAIN_RUNNING","END","GHOST","COME_OUT","LULU","GENERAL","ENTERING","HIT_FENCE","HIT_RAIN_FENCE","HIT_WALL","PLACE_PAPER","PLACE_LOO_PAPER","PLACE_BOMB","SLASHING","KILLING","RANDOM","JUST_HORROR","WEIRD_NOISES","SCARY_PIANO","SOUND_MAP","LULULALA","GHOST_SCREAM","GameSounds","Sounds","constructor","game","state","sounds","makeSound","soundId","callback","startHandler","finishHandler","scream","gameEnded","ambient","winter","ambientWinter","ambientRain","loopSound","ending","endingSong","getRandomInt","endingComeOut","endingLulu","window","location","reload","HO_HO_HO","playButton","document","querySelector","logoBlock","aboutUsBlock","aboutGameBlock","MenuSounds","player","disableMenuSounds","soundManager","startSoundHandler","nextSound","currentSound","stopSoundHandler","startPlayHandler","stopPlayHandler","startLogoHandler","stopLogoHandler","startAboutUsHandler","stopAboutUsHandler","startAboutGameHandler","stopAboutGameHandler","enableMenuSounds","addEventListener","bind","winterModeSound","NoiseSounds","noisesEnd","noises","playNoises","noiseNum","playSM","multiShotEvents","onfinish","PLACING_LOO_PAPER","PLACING_BOMB","PLACING_PAPER","PlayerSounds","place","paperType","placeLoo","placeBomb","placeNormal","HITTING_THE_FENCE","HITTING_THE_RAIN_FENCE","HITTING_THE_WALL","walk","snowWalk","rainWalk","dodge","snowDodge","rainDodge","hitWall","hitFence","snowFenceHit","rainFenceHit","attack","kill","running","Math","random","isKillingEnded","killingEnded","sound_end","SM_URL","debugMode","preferFlash","useHighPerformance","onready","precreateSounds","stopSound","stopSM","muteSound","unmuteSound","makeSoundV2","allSoundsEnded","soundStates","Object","values","soundsEnded","every","sound","Bitmap","src","image","Image","Camera","canvas","resolution","fov","CIRCLE","map","PAPER_NUM","ctx","getContext","innerWidth","innerHeight","spacing","range","scale","render","drawSky","direction","skybox","light","drawColumns","drawWeapon","left_hand","right_hand","paces","grabDist","put_dist","drawMiniMap","drawNumber","drawPaper","drawNoPaper","drawLoo","drawBomb","drawTip","drawWarning","drawDie","drawTaken","drawAllDead","left","save","drawImage","fillStyle","ground","globalAlpha","param","fillRect","restore","drawColumn","column","ray","angle","lightRange","floor","ceil","wallTexture","hit","objects","hitDistance","step","length","s","fenceDoorTexture","fenceTexture","drops_seed","rainDrops","pow","drops_amount","project","distance","textureX","offset","top","shadows","shading","max","object","push","drops","drops_opacity","particlesWidth","particlesHeight","allObjects","cast","columnProps","drawSprites","screenWidth","screenHeight","screenRatio","setSpriteDistances","sprites","Array","prototype","slice","call","sprite","distX","x","distY","y","distanceFromPlayer","renderedFloorOffset","floorOffset","angleToPlayer","atan2","numColumns","angleRelativeToPlayerView","cameraXOffset","firstColumn","sqrt","sort","a","b","drawSpriteColumn","columnWidth","props","obj","projection","mappedColumnObj","spriteIsInColumn","filter","i","grab","put","bobX","cos","bobY","sin","left_r","left_l","miniMapSize","blockSize","size","triangleX","triangleY","wallGrid","row","col","color","logic","undefined","moveTo","translate","rotate","PI","beginPath","lineTo","fill","font","text","people","fillText","show_no_paper","show_loo","show_bomb","show_tip","show_warning","show_die","w","h","show_taken","show_all_dead","z","wallHeight","bottom","canvasBlock","lockHandler","body","requestPointerLock","mozRequestPointerLock","webkitRequestPointerLock","KEY_MAP","MOUSE_SENSITIVITY","Controls","states","right","forward","backward","shift","sideLeft","sideRight","onKeyDown","onKeyUp","onTouch","onTouchEnd","onMouseMovement","e","t","touches","pageY","onKey","keyCode","pageX","preventDefault","stopPropagation","action","dosmth","movementX","mozMovementX","webkitMovementX","videoBlock","messageBlock","messageChildBlock","Game","PPL_NUM","PPL_XY","MAP_SIZE","RESOLUTION","enterFS","intro","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","exitFS","exitFullscreen","mozExitFullScreen","webkitExitFullscreen","mouseLock","showEndingScreen","classList","add","innerHTML","setAttribute","remove","loadGame","Map","camera","gameLoop","GameLoop","noiseSounds","gameSounds","Player","controls","setMode","addPeople","buildMap","startGame","start","seconds","lightning","update","changeAmbient","checkEnding","playerSounds","makeEndmode","endGame","stop","picNum","addObject","NPC","next","setToWinter","fence_door","fence_texture","sky_texture","wall_texture","setToVanilla","previousTime","frame","stopped","loopId","requestAnimationFrame","currentTime","cancelAnimationFrame","Uint8Array","get","addTrees","num","Objects","addBushes","point","self","noWall","length2","Infinity","origin","stepX","stepY","nextStep","inspect","concat","rise","run","inverted","dx","dy","shiftX","shiftY","getObject","forEach","item","count","speed","alive","found_paper","taking_paper","paperNearPerson","getRandomFloat","searchForPaper","wonderAround","distToPlayer","distTo","inDirectionX","inDirectionY","move","distToPaper","paper","some","Paper","isNearPaper","takingPaper","approachPaper","takePaper","idx","indexOf","splice","showTakenMessage","distToWalk","die","setTimeout","thing","paperSounds","PaperSounds","prev_paper_place","grab_state","put_state","walking","placePaper","victim","nearVictim","eat","showDieMessage","noPapersToPlace","showNoPaperMessage","isSamePlace","readyToPlaceHere","paperBitmap","showPlacementMessage","showWarningMessage","showLooMessage","showBombMessage","showPaperMessage","min","minInt","maxInt","prepareFunc","func","group","entries","_","val","precreateGroup","preloadGroup","preloadSounds","config","SLIDE_MAP","LEFT","RIGHT","SLIDE_CONFIG","title","data","snowBlock","checkbox","mainBlock","hideMainBlock","snowHandler","style","display","setSlides","side","isHovered","value","mouseMoveHandler","changeGameMode","menuSounds","checked","initializeSlides","init","checkboxHandler","gameHandler"],"mappings":"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;;;;;;;;;;;ACApE,iEAAe,qBAAuB,8BAA8B,E;;;;;;;;;;;;;;;ACApE,iEAAe,qBAAuB,8BAA8B,E;;;;;;;;;;;;;;;ACApE,iEAAe,qBAAuB,8BAA8B,E;;;;;;;;;;;;;;;ACApE,iEAAe,qBAAuB,8BAA8B,E;;;;;;;;;;;;;;;ACApE,iEAAe,qBAAuB,8BAA8B,E;;;;;;;;;;;;;;;ACApE,iEAAe,qBAAuB,8BAA8B,E;;;;;;;;;;;;;;;ACApE,iEAAe,qBAAuB,iCAAiC,E;;;;;;;;;;;;;;;ACAvE,iEAAe,qBAAuB,wCAAwC,E;;;;;;;;;;;;;;;ACA9E,iEAAe,qBAAuB,wCAAwC,E;;;;;;;;;;;;;;;ACA9E,iEAAe,qBAAuB,gCAAgC,E;;;;;;;;;;;;;;;ACAtE,iEAAe,qBAAuB,iCAAiC,E;;;;;;;;;;;;;;;ACAvE,iEAAe,qBAAuB,iCAAiC,E;;;;;;;;;;;;;;;ACAvE,iEAAe,qBAAuB,wCAAwC,E;;;;;;;;;;;;;;;ACA9E,iEAAe,qBAAuB,wCAAwC,E;;;;;;;;;;;;;;;ACA9E,iEAAe,qBAAuB,kCAAkC,E;;;;;;;;;;;;;;;ACAxE,iEAAe,qBAAuB,kCAAkC,E;;;;;;;;;;;;;;;ACAxE,iEAAe,qBAAuB,kCAAkC,E;;;;;;;;;;;;;;;ACAxE,iEAAe,qBAAuB,kCAAkC,E;;;;;;;;;;;;;;;ACAxE,iEAAe,qBAAuB,6BAA6B,E;;;;;;;;;;;;;;;ACAnE,iEAAe,qBAAuB,6BAA6B,E;;;;;;;;;;;;;;;ACAnE,iEAAe,qBAAuB,6BAA6B,E;;;;;;;;;;;;;;;ACAnE,iEAAe,qBAAuB,6BAA6B,E;;;;;;;;;;;;;;;ACAnE,iEAAe,qBAAuB,wCAAwC,E;;;;;;;;;;;;;;;ACA9E,iEAAe,qBAAuB,yCAAyC,E;;;;;;;;;;;;;;;ACA/E,iEAAe,qBAAuB,wCAAwC,E;;;;;;;;;;;;;;;ACA9E,iEAAe,qBAAuB,kCAAkC,E;;;;;;;;;;;;;;;ACAxE,iEAAe,qBAAuB,iCAAiC,E;;;;;;;;;;;;;;;ACAvE,iEAAe,qBAAuB,yCAAyC,E;;;;;;;;;;;;;;;ACA/E,iEAAe,qBAAuB,kCAAkC,E;;;;;;;;;;;;;;;ACAxE,iEAAe,qBAAuB,kCAAkC,E;;;;;;;;;;;;;;;ACAxE,iEAAe,qBAAuB,8BAA8B,E;;;;;;;;;;;;;;;ACApE,iEAAe,qBAAuB,kCAAkC,E;;;;;;;;;;;;;;;ACAxE,iEAAe,qBAAuB,8BAA8B,E;;;;;;;;;;;;;;;ACApE,iEAAe,qBAAuB,gCAAgC,E;;;;;;;;;;;;;;;ACAtE,iEAAe,qBAAuB,8BAA8B,E;;;;;;;;;;;;;;;ACApE,iEAAe,qBAAuB,8BAA8B,E;;;;;;;;;;;;;;;ACApE,iEAAe,qBAAuB,uCAAuC,E;;;;;;;;;;;;;;;ACA7E,iEAAe,qBAAuB,wCAAwC,E;;;;;;;;;;;;;;;ACA9E,iEAAe,qBAAuB,mCAAmC,E;;;;;;;;;;;;;;;ACAzE,iEAAe,qBAAuB,uCAAuC,E;;;;;;;;;;;;;;;ACA7E,iEAAe,qBAAuB,4CAA4C,E;;;;;;;;;;;;;;;ACAlF,iEAAe,qBAAuB,sCAAsC,E;;;;;;;;;;;;;;;ACA5E,iEAAe,qBAAuB,6BAA6B,E;;;;;;;;;;;;;;;ACAnE,iEAAe,qBAAuB,kCAAkC,E;;;;;;;;;;;;;;;ACAxE,iEAAe,qBAAuB,uCAAuC,E;;;;;;;;;;;;;;;ACA7E,iEAAe,qBAAuB,mCAAmC,E;;;;;;;;;;;;;;;ACAzE,iEAAe,qBAAuB,8BAA8B,E;;;;;;;;;;;;;;;ACApE,iEAAe,qBAAuB,mCAAmC,E;;;;;;;;;;;;;;;ACAzE,iEAAe,qBAAuB,kCAAkC,E;;;;;;;;;;;;;;;ACAxE,iEAAe,qBAAuB,kCAAkC,E;;;;;;;;;;;;;;;ACAxE,iEAAe,qBAAuB,kCAAkC,E;;;;;;;;;;;;;;;ACAxE,iEAAe,qBAAuB,wCAAwC,E;;;;;;;;;;;;;;;ACA9E,iEAAe,qBAAuB,uCAAuC,E;;;;;;;;;;;;;;;ACA7E,iEAAe,qBAAuB,uCAAuC,E;;;;;;;;;;;;;;;ACA7E,iEAAe,qBAAuB,uCAAuC,E;;;;;;;;;;;;;;;ACA7E,iEAAe,qBAAuB,kCAAkC,E;;;;;;;;;;;;;;;ACAxE,iEAAe,qBAAuB,+BAA+B,E;;;;;;;;;;;;;;;ACArE,iEAAe,qBAAuB,6BAA6B,E;;;;;;;;;;;;;;;ACAnE,iEAAe,qBAAuB,2BAA2B,E;;;;;;;;;;;ACAjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD;AACvD;AACA;AACA,uFAAuF;AACvF;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,UAAU;AACV,YAAY,aAAa;AACzB;;AAEA;;AAEA;AACA;AACA;AACA,gFAAgF,8BAA8B;AAC9G;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8FAA8F;AAC9F;AACA,+DAA+D,KAAK;AACpE;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,yBAAyB;AACzB;AACA,KAAK;;AAEL;AACA;AACA,wBAAwB;AACxB;AACA,KAAK;;AAEL;AACA,wBAAwB;AACxB;AACA,KAAK;;AAEL;AACA,wBAAwB;AACxB;AACA,KAAK;;AAEL;AACA,wBAAwB;AACxB;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA,qGAAqG;AACrG;AACA;AACA;;AAEA,+DAA+D,IAAI;;AAEnE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,OAAO,iCAAiC;AACrD;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,OAAO;;AAEP;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,OAAO;;AAEP;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA,SAAS;;AAET;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,uGAAuG,QAAQ;;AAE/G;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,2BAA2B;;AAE3B;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB,cAAc,OAAO;AACrB;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,eAAe,yBAAyB;AACxC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,SAAS;AACtB,aAAa,OAAO;AACpB,cAAc,QAAQ;AACtB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,SAAS;AACtB,cAAc,QAAQ;AACtB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,cAAc,QAAQ;AACtB;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AAC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A;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,cAAc,QAAQ;AACtB;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,eAAe,OAAO;AACtB,gBAAgB,QAAQ;AACxB;;AAEA;;AAEA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,SAAS;;AAET;;AAEA;;AAEA,OAAO;;AAEP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA,WAAW;AACX;AACA;;AAEA,SAAS;;AAET;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,OAAO;;AAEP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,eAAe,OAAO;AACtB,gBAAgB,QAAQ;AACxB;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA,+EAA+E;AAC/E;;AAEA;;AAEA,SAAS;;AAET;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,WAAW;;AAEX;AACA;;AAEA,WAAW;;AAEX;;AAEA;;AAEA;;AAEA;AACA;;AAEA,SAAS;;AAET;;AAEA;;AAEA,SAAS;;AAET;;AAEA;;AAEA,OAAO;;AAEP;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,OAAO;;AAEP;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa;;AAEb,WAAW;;AAEX;;AAEA;;AAEA;AACA;AACA,aAAa;;AAEb;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,SAAS;;AAET;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,WAAW;;AAEX;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,4EAA4E;AAC5E;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,eAAe,QAAQ;AACvB,gBAAgB,QAAQ;AACxB;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,SAAS;;AAET;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,eAAe,QAAQ;AACvB;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,eAAe,OAAO;AACtB,gBAAgB,QAAQ;AACxB;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,eAAe,OAAO;AACtB,gBAAgB,QAAQ;AACxB;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA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EA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,SAAS;;AAET;;AAEA;;AAEA,SAAS;;AAET;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,WAAW;;AAEX;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,OAAO;;AAEP;;AAEA;AACA;;AAEA,SAAS;;AAET;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,OAAO;;AAEP;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA,OAAO;;AAEP;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB,MAAM;AACvB,iBAAiB,MAAM;AACvB;;AAEA;;AAEA,oBAAoB;;AAEpB,sCAAsC,OAAO;AAC7C;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB,MAAM;AACvB,iBAAiB,MAAM;AACvB;;AAEA;;AAEA;;AAEA,uCAAuC,OAAO;AAC9C;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;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;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,QAAQ;AACvE;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA,kCAAkC,OAAO;AACzC;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;;AAEA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,SAAS;;AAET;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,oCAAoC,OAAO;AAC3C;AACA;AACA;AACA;;AAEA;;AAEA;AACA,mCAAmC,OAAO;;AAE1C;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,KAAK;;AAEL;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,oCAAoC;AACpC;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA,aAAa;;AAEb;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA,eAAe,gBAAgB,0DAA0D,0CAA0C;AACnI;;AAEA;;AAEA;;AAEA;AACA,iCAAiC,OAAO;;AAExC;;AAEA;AACA;AACA;AACA;AACA;;AAEA,SAAS;;AAET;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,KAAK;;AAEL;AACA;;AAEA;;AAEA;;AAEA;;;AAGA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,qCAAqC,QAAQ;;AAE7C;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,oDAAoD;;AAEpD;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,iDAAiD,QAAQ;AACzD;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,KAAK;;AAEL;AACA;;AAEA,KAAK;;AAEL;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,OAAO;;AAEP;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,OAAO;AACP;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,SAAS;;AAET;;AAEA;;AAEA,OAAO;;AAEP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;A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AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,QAAQ;AACR,MAAM;AACN;;AAEA,EAAE,mCAAO;AACT;AACA;AACA;AACA;AACA,eAAe,SAAS;AACxB,gBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AAAA,kGAAC;;AAEJ;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,CAAC;;;;;;;UCrpMD;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCzBA;WACA;WACA;WACA;WACA;WACA,gCAAgC,YAAY;WAC5C;WACA,E;;;;;WCPA;WACA;WACA;WACA;WACA,wCAAwC,yCAAyC;WACjF;WACA;WACA,E;;;;;WCPA;WACA;WACA;WACA;WACA,EAAE;WACF;WACA;WACA,CAAC,I;;;;;WCPD,wF;;;;;WCAA;WACA;WACA;WACA,sDAAsD,kBAAkB;WACxE;WACA,+CAA+C,cAAc;WAC7D,E;;;;;WCNA;WACA;WACA;WACA;WACA,E;;;;;WCJA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,kC;;;;;;;;;;;;;;;;;ACfA;AACA;AACA;AACA;AAEA,MAAM+f,SAAS,GAAG;AAChBC,MAAI,EAAE,MADU;AAEhBC,OAAK,EAAE;AAFS,CAAlB;AAKA,MAAMC,YAAY,GAAG;AACnB,GAACH,SAAS,CAACC,IAAX,GAAkB;AAChBG,SAAK,EAAE1b,QAAQ,CAACC,aAAT,CAAwB,WAAUqb,SAAS,CAACC,IAAK,gBAAjD,CADS;AAEhBI,QAAI,EAAE3b,QAAQ,CAACC,aAAT,CAAwB,WAAUqb,SAAS,CAACC,IAAK,eAAjD;AAFU,GADC;AAKnB,GAACD,SAAS,CAACE,KAAX,GAAmB;AACjBE,SAAK,EAAE1b,QAAQ,CAACC,aAAT,CAAwB,WAAUqb,SAAS,CAA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","file":"index.js","sourcesContent":["/* eslint-disable global-require */\n\nconst ASSETS = {\n  trees: [\n    {\n      texture: require('../img/trees/tree_0.png').default,\n      width: 200,\n      height: 200,\n    },\n    {\n      texture: require('../img/trees/tree_1.png').default,\n      width: 200,\n      height: 200,\n    },\n    {\n      texture: require('../img/trees/tree_2.png').default,\n      width: 200,\n      height: 200,\n    },\n    {\n      texture: require('../img/trees/tree_3.png').default,\n      width: 200,\n      height: 200,\n    },\n  ],\n  rain_trees: [\n    {\n      texture: require('../img/trees/rain_tree_0.png').default,\n      width: 200,\n      height: 200,\n    },\n    {\n      texture: require('../img/trees/rain_tree_1.png').default,\n      width: 200,\n      height: 200,\n    },\n    {\n      texture: require('../img/trees/rain_tree_2.png').default,\n      width: 200,\n      height: 200,\n    },\n    {\n      texture: require('../img/trees/rain_tree_3.png').default,\n      width: 200,\n      height: 200,\n    },\n  ],\n  bushes: [\n    {\n      texture: require('../img/bushes/bush_0.png').default,\n      width: 200,\n      height: 109,\n    },\n    {\n      texture: require('../img/bushes/bush_1.png').default,\n      width: 200,\n      height: 105,\n    },\n    {\n      texture: require('../img/bushes/bush_2.png').default,\n      width: 200,\n      height: 311,\n    },\n    {\n      texture: require('../img/bushes/bush_3.png').default,\n      width: 200,\n      height: 168,\n    },\n    {\n      texture: require('../img/bushes/bush_4.png').default,\n      width: 200,\n      height: 278,\n    },\n  ],\n  rain_bushes: [\n    {\n      texture: require('../img/bushes/rain_bush_0.png').default,\n      width: 200,\n      height: 152,\n    },\n    {\n      texture: require('../img/bushes/rain_bush_1.png').default,\n      width: 200,\n      height: 138,\n    },\n    {\n      texture: require('../img/bushes/rain_bush_2.png').default,\n      width: 217,\n      height: 200,\n    },\n    {\n      texture: require('../img/bushes/rain_bush_3.png').default,\n      width: 201,\n      height: 200,\n    },\n    {\n      texture: require('../img/bushes/rain_bush_4.png').default,\n      width: 200,\n      height: 200,\n    },\n  ],\n  papers: [\n    {\n      texture: require('../img/papers/paper_0.png').default,\n      width: 118,\n      height: 100,\n    },\n    {\n      texture: require('../img/papers/paper_1.png').default,\n      width: 145,\n      height: 100,\n    },\n    {\n      texture: require('../img/papers/paper_2.png').default,\n      width: 100,\n      height: 100,\n    },\n    {\n      texture: require('../img/papers/paper_3.png').default,\n      width: 207,\n      height: 100,\n    },\n    {\n      texture: require('../img/papers/paper_4.png').default,\n      width: 133,\n      height: 100,\n    },\n    {\n      texture: require('../img/papers/paper_5.png').default,\n      width: 195,\n      height: 100,\n    },\n    {\n      texture: require('../img/papers/paper_6.png').default,\n      width: 310,\n      height: 100,\n    },\n    {\n      texture: require('../img/papers/paper_7.png').default,\n      width: 164,\n      height: 100,\n    },\n  ],\n  slender: [\n    {\n      texture: require('../img/slender/right_hand.png').default,\n      width: 200,\n      height: 200,\n    },\n    {\n      texture: require('../img/slender/left_hand.png').default,\n      width: 200,\n      height: 200,\n    },\n  ],\n  npc: [\n    require('../img/npc/npc_die.gif').default,\n    require('../img/npc/npc-1.png').default,\n    require('../img/npc/npc-2.png').default,\n    require('../img/npc/npc-3.png').default,\n    require('../img/npc/npc-4.png').default,\n    require('../img/npc/npc2-1.png').default,\n    require('../img/npc/npc2-2.png').default,\n    require('../img/npc/npc2-3.png').default,\n    require('../img/npc/npc2-4.png').default,\n    require('../img/npc/npc3-1.png').default,\n    require('../img/npc/npc3-2.png').default,\n    require('../img/npc/npc3-3.png').default,\n    require('../img/npc/npc3-4.png').default,\n  ],\n  mode: {\n    fenceDoor: require('../img/fence_door_0.jpg').default,\n    snow: {\n      fence: require('../img/snow/fence_snow.png').default,\n      sky: require('../img/snow/sky_panorama_snow.jpg').default,\n      wall: require('../img/snow/wall_texture_snow.jpg').default,\n    },\n    rain: {\n      fence: require('../img/rain/rain_fence.jpg').default,\n      sky: require('../img/rain/rain_sky_panorama.jpg').default,\n      wall: require('../img/rain/rain_wall_texture.jpg').default,\n    },\n  },\n};\n\nexport default ASSETS;\n","/* eslint-disable global-require */\n\nconst SOUNDS = {\n  MENU: {\n    PIANO_MENU: {\n      id: 'piano_menu_ambient',\n      url: require('../sounds/ambient/piano_menu_ambient.mp3').default,\n    },\n    STATIC_MENU: {\n      id: 'static_menu_ambient',\n      url: require('../sounds/ambient/static_menu_ambient.mp3').default,\n      volume: 50,\n    },\n    SLENDER_LOGO: {\n      id: 'slender_logo_hover',\n      url: require('../sounds/menu/slender_logo_hover.mp3').default,\n    },\n    PLAY_BUTTON: {\n      id: 'play_button_hover',\n      url: require('../sounds/menu/play_button_hover.mp3').default,\n    },\n    HO_HO: {\n      id: 'ho_ho_ho',\n      url: require('../sounds/menu/ho_ho_ho.mp3').default,\n    },\n    ABOUT_US: {\n      id: 'about_us',\n      url: require('../sounds/menu/about_us.mp3').default,\n    },\n    ABOUT_GAME: {\n      id: 'about_game',\n      url: require('../sounds/menu/about_game.mp3').default,\n    },\n  },\n  WINTER: {\n    WIND: {\n      id: 'wind_ambient',\n      url: require('../sounds/ambient/wind_ambient.mp3').default,\n    },\n    FORWARD_STEP: {\n      id: 'forward_step',\n      url: require('../sounds/walking/forward_step.mp3').default,\n    },\n    BACKWARD_STEP: {\n      id: 'backward_step',\n      url: require('../sounds/walking/backward_step.mp3').default,\n    },\n    DODGE_STEP_0: {\n      id: 'dodge_step_0',\n      url: require('../sounds/walking/dodge_step_0.mp3').default,\n    },\n    DODGE_STEP_1: {\n      id: 'dodge_step_1',\n      url: require('../sounds/walking/dodge_step_1.mp3').default,\n    },\n    RUNNING: {\n      id: 'running',\n      url: require('../sounds/walking/running.mp3').default,\n    },\n  },\n  VANILLA: {\n    RAIN: {\n      id: 'rain_ambient',\n      url: require('../sounds/ambient/rain_ambient.mp3').default,\n      volume: 80,\n    },\n    RAIN_FORWARD_STEP: {\n      id: 'rain_forward_step',\n      url: require('../sounds/walking/rain_forward_step.mp3').default,\n    },\n    RAIN_BACKWARD_STEP: {\n      id: 'rain_backward_step',\n      url: require('../sounds/walking/rain_backward_step.mp3').default,\n    },\n    RAIN_STEP: {\n      id: 'rain_step',\n      url: require('../sounds/walking/rain_step.mp3').default,\n    },\n    RAIN_DODGE_STEP_0: {\n      id: 'rain_dodge_step_0',\n      url: require('../sounds/walking/rain_dodge_step_0.mp3').default,\n    },\n    RAIN_DODGE_STEP_1: {\n      id: 'rain_dodge_step_1',\n      url: require('../sounds/walking/rain_dodge_step_1.mp3').default,\n    },\n    RAIN_RUNNING: {\n      id: 'rain_running',\n      url: require('../sounds/walking/rain_running.mp3').default,\n    },\n  },\n  END: {\n    GHOST: {\n      id: 'ghost_scream',\n      url: require('../sounds/ending/ghost_scream.mp3').default,\n    },\n    COME_OUT: {\n      id: 'come_out',\n      url: require('../sounds/ending/come_out.mp3').default,\n    },\n    LULU: {\n      id: 'lululala',\n      url: require('../sounds/ending/lululala.mp3').default,\n    },\n  },\n  GENERAL: {\n    ENTERING: {\n      id: 'entering_area',\n      url: require('../sounds/objects/entering_area.mp3').default,\n    },\n    HIT_FENCE: {\n      id: 'hitting_the_fence',\n      url: require('../sounds/objects/hitting_the_fence.mp3').default,\n    },\n    HIT_RAIN_FENCE: {\n      id: 'hitting_the_rain_fence',\n      url: require('../sounds/objects/hitting_the_rain_fence.mp3').default,\n      volume: 50,\n    },\n    HIT_WALL: {\n      id: 'hitting_the_wall',\n      url: require('../sounds/objects/hitting_the_wall.mp3').default,\n    },\n    PLACE_PAPER: {\n      id: 'placing_paper',\n      url: require('../sounds/objects/placing_paper.mp3').default,\n    },\n    PLACE_LOO_PAPER: {\n      id: 'placing_loo_paper',\n      url: require('../sounds/objects/placing_loo_paper.mp3').default,\n      volume: 40,\n    },\n    PLACE_BOMB: {\n      id: 'placing_bomb',\n      url: require('../sounds/objects/placing_bomb.mp3').default,\n    },\n    SLASHING: {\n      id: 'slashing',\n      url: require('../sounds/objects/slashing.mp3').default,\n    },\n    KILLING: {\n      id: 'killing',\n      url: require('../sounds/objects/killing.mp3').default,\n    },\n  },\n  RANDOM: {\n    GHOST: {\n      id: 'ghost_in_the_house',\n      url: require('../sounds/ambient/ghost_in_the_house.mp3').default,\n    },\n    JUST_HORROR: {\n      id: 'just_horror_ambient',\n      url: require('../sounds/ambient/just_horror_ambient.mp3').default,\n    },\n    WEIRD_NOISES: {\n      id: 'weird_noises',\n      url: require('../sounds/ambient/weird_noises.mp3').default,\n    },\n    SCARY_PIANO: {\n      id: 'scary_piano',\n      url: require('../sounds/ambient/scary_piano.mp3').default,\n    },\n  },\n};\n\nexport default SOUNDS;\n","import SOUNDS from '../../../data/sounds';\n\nimport { getRandomInt } from '../../utils/calc';\n\nimport Sounds from './Sounds';\n\nconst SOUND_MAP = {\n  COME_OUT: 'come_out',\n  LULULALA: 'lululala',\n  GHOST_SCREAM: 'ghost_scream',\n};\n\nclass GameSounds extends Sounds {\n  constructor(game, mode) {\n    super();\n    this.game = game;\n    this.mode = mode;\n    this.state = {\n      sounds: {\n        [SOUND_MAP.COME_OUT]: true,\n        [SOUND_MAP.LULULALA]: true,\n        [SOUND_MAP.GHOST_SCREAM]: true,\n      },\n    };\n  }\n\n  makeSound(soundId, callback) {\n    if (this.state.sounds[soundId]) {\n      this.startHandler(soundId);\n      const finishHandler = callback\n        ? () => callback(soundId)\n        : () => this.finishHandler(soundId);\n      Sounds.makeSoundV2(soundId, finishHandler);\n    }\n  }\n\n  startHandler(soundId) {\n    this.state.sounds[soundId] = false;\n  }\n\n  finishHandler(soundId) {\n    this.state.sounds[soundId] = true;\n  }\n\n  scream() {\n    this.makeSound(SOUND_MAP.GHOST_SCREAM, (soundId) => {\n      this.game.gameEnded = true;\n      this.state.sounds[soundId] = true;\n    });\n  }\n\n  ambient() {\n    switch (this.mode.winter) {\n      case true:\n        this.ambientWinter();\n        break;\n      default:\n        this.ambientRain();\n        break;\n    }\n  }\n\n  ambientWinter() {\n    this.loopSound(SOUNDS.WINTER.WIND.id);\n  }\n\n  ambientRain() {\n    this.loopSound(SOUNDS.VANILLA.RAIN.id);\n  }\n\n  ending() {\n    const endingSong = getRandomInt(0, 2);\n    switch (endingSong) {\n      case 0:\n        this.endingComeOut();\n        break;\n      case 1:\n        this.endingLulu();\n        break;\n      default:\n        this.endingComeOut();\n        break;\n    }\n  }\n\n  endingComeOut() {\n    this.makeSound(SOUND_MAP.COME_OUT, () => window.location.reload());\n  }\n\n  endingLulu() {\n    this.makeSound(SOUND_MAP.LULULALA, () => window.location.reload());\n  }\n}\n\nexport default GameSounds;\n","import { soundManager } from 'soundmanager2';\n\nimport SOUNDS from '../../../data/sounds';\n\nimport Sounds from './Sounds';\n\nconst SOUND_MAP = {\n  HO_HO_HO: 'ho_ho_ho',\n  // PIANO_MENU: '',\n  // STATIC_MENU: '',\n  // SLENDER_LOGO: '',\n  // PLAY_BUTTON: '',\n  // ABOUT_US: '',\n  // ABOUT_GAME: '',\n};\n\nconst playButton = document.querySelector('#play');\nconst logoBlock = document.querySelector('#logo');\nconst aboutUsBlock = document.querySelector('#about_us');\nconst aboutGameBlock = document.querySelector('#about_game');\n\nclass MenuSounds extends Sounds {\n  constructor(player) {\n    super();\n    this.player = player;\n\n    this.state = {\n      sounds: {\n        [SOUND_MAP.HO_HO_HO]: true,\n        // TODO: Rewrite manual logic to state logic\n        // [SOUND_MAP.PIANO_MENU]: true,\n        // [SOUND_MAP.STATIC_MENU]: true,\n        // [SOUND_MAP.SLENDER_LOGO]: true,\n        // [SOUND_MAP.PLAY_BUTTON]: true,\n        // [SOUND_MAP.ABOUT_US]: true,\n        // [SOUND_MAP.ABOUT_GAME]: true,\n      },\n    };\n  }\n\n  static disableMenuSounds() {\n    soundManager.stopAll();\n  }\n\n  makeSound(soundId) {\n    if (this.state.sounds[soundId]) {\n      this.startHandler(soundId);\n      Sounds.makeSoundV2(soundId, () => this.finishHandler(soundId));\n    }\n  }\n\n  startHandler(soundId) {\n    this.state.sounds[soundId] = false;\n  }\n\n  finishHandler(soundId) {\n    this.state.sounds[soundId] = true;\n  }\n\n  startSoundHandler(nextSound, currentSound) {\n    if (currentSound) {\n      Sounds.muteSound(currentSound);\n    }\n    this.loopSound(nextSound);\n  }\n\n  stopSoundHandler(currentSound, nextSound) {\n    if (nextSound) {\n      Sounds.unmuteSound(nextSound);\n    }\n    Sounds.stopSound(currentSound);\n  }\n\n  startPlayHandler() {\n    this.startSoundHandler(SOUNDS.MENU.PLAY_BUTTON.id);\n  }\n\n  stopPlayHandler() {\n    this.stopSoundHandler(SOUNDS.MENU.PLAY_BUTTON.id);\n  }\n\n  startLogoHandler() {\n    this.startSoundHandler(SOUNDS.MENU.SLENDER_LOGO.id);\n  }\n\n  stopLogoHandler() {\n    this.stopSoundHandler(SOUNDS.MENU.SLENDER_LOGO.id);\n  }\n\n  startAboutUsHandler() {\n    this.startSoundHandler(SOUNDS.MENU.ABOUT_US.id, SOUNDS.MENU.PIANO_MENU.id);\n  }\n\n  stopAboutUsHandler() {\n    this.stopSoundHandler(SOUNDS.MENU.ABOUT_US.id, SOUNDS.MENU.PIANO_MENU.id);\n  }\n\n  startAboutGameHandler() {\n    this.startSoundHandler(\n      SOUNDS.MENU.ABOUT_GAME.id,\n      SOUNDS.MENU.PIANO_MENU.id,\n    );\n  }\n\n  stopAboutGameHandler() {\n    this.stopSoundHandler(SOUNDS.MENU.ABOUT_GAME.id, SOUNDS.MENU.PIANO_MENU.id);\n  }\n\n  enableMenuSounds() {\n    const { PIANO_MENU, STATIC_MENU } = SOUNDS.MENU;\n\n    this.loopSound(PIANO_MENU.id);\n    this.loopSound(STATIC_MENU.id);\n\n    playButton.addEventListener('mouseover', this.startPlayHandler.bind(this));\n    playButton.addEventListener('mouseout', this.stopPlayHandler.bind(this));\n\n    logoBlock.addEventListener('mouseover', this.startLogoHandler.bind(this));\n    logoBlock.addEventListener('mouseout', this.stopLogoHandler.bind(this));\n\n    aboutUsBlock.addEventListener(\n      'mouseover',\n      this.startAboutUsHandler.bind(this),\n    );\n    aboutUsBlock.addEventListener(\n      'mouseout',\n      this.stopAboutUsHandler.bind(this),\n    );\n\n    aboutGameBlock.addEventListener(\n      'mouseover',\n      this.startAboutGameHandler.bind(this),\n    );\n    aboutGameBlock.addEventListener(\n      'mouseout',\n      this.stopAboutGameHandler.bind(this),\n    );\n  }\n\n  winterModeSound() {\n    this.makeSound(SOUND_MAP.HO_HO_HO);\n  }\n}\n\nexport default MenuSounds;\n","import SOUNDS from '../../../data/sounds.json';\n\nimport { playSM } from '../../utils/sound';\n\nclass NoiseSounds {\n  constructor() {\n    this.noisesEnd = true;\n    this.noises = {\n      0: SOUNDS.RANDOM.GHOST,\n      1: SOUNDS.RANDOM.JUST_HORROR,\n      2: SOUNDS.RANDOM.WEIRD_NOISES,\n      3: SOUNDS.RANDOM.SCARY_PIANO,\n    };\n  }\n\n  playNoises(noiseNum) {\n    this.noisesEnd = false;\n    playSM(this.noises[noiseNum], {\n      multiShotEvents: true,\n      onfinish: () => {\n        this.noisesEnd = true;\n      },\n    });\n  }\n}\n\nexport default NoiseSounds;\n","import Sounds from './Sounds';\n\nconst SOUND_MAP = {\n  PLACING_LOO_PAPER: 'placing_loo_paper',\n  PLACING_BOMB: 'placing_bomb',\n  PLACING_PAPER: 'placing_paper',\n};\n\nclass PlayerSounds extends Sounds {\n  constructor(player) {\n    super();\n    this.player = player;\n    this.state = {\n      sounds: {\n        [SOUND_MAP.PLACING_LOO_PAPER]: true,\n        [SOUND_MAP.PLACING_BOMB]: true,\n        [SOUND_MAP.PLACING_PAPER]: true,\n      },\n    };\n  }\n\n  makeSound(soundId) {\n    if (this.state.sounds[soundId]) {\n      this.startHandler(soundId);\n      Sounds.makeSoundV2(soundId, () => this.finishHandler(soundId));\n    }\n  }\n\n  startHandler(soundId) {\n    this.state.sounds[soundId] = false;\n  }\n\n  finishHandler(soundId) {\n    this.state.sounds[soundId] = true;\n  }\n\n  place() {\n    switch (this.player.paperType) {\n      case 0:\n        this.placeLoo();\n        break;\n      case 7:\n        this.placeBomb();\n        break;\n      default:\n        this.placeNormal();\n        break;\n    }\n  }\n\n  placeLoo() {\n    this.makeSound(SOUND_MAP.PLACING_LOO_PAPER);\n  }\n\n  placeBomb() {\n    this.makeSound(SOUND_MAP.PLACING_BOMB);\n  }\n\n  placeNormal() {\n    this.makeSound(SOUND_MAP.PLACING_PAPER);\n  }\n}\n\nexport default PlayerSounds;\n","import Sounds from './Sounds';\n\nconst SOUND_MAP = {\n  BACKWARD_STEP: 'backward_step',\n  DODGE_STEP_0: 'dodge_step_0',\n  DODGE_STEP_1: 'dodge_step_1',\n  FORWARD_STEP: 'forward_step',\n  HITTING_THE_FENCE: 'hitting_the_fence',\n  HITTING_THE_RAIN_FENCE: 'hitting_the_rain_fence',\n  HITTING_THE_WALL: 'hitting_the_wall',\n  KILLING: 'killing',\n  RAIN_BACKWARD_STEP: 'rain_backward_step',\n  RAIN_DODGE_STEP_0: 'rain_dodge_step_0',\n  RAIN_DODGE_STEP_1: 'rain_dodge_step_1',\n  RAIN_FORWARD_STEP: 'rain_forward_step',\n  RAIN_RUNNING: 'rain_running',\n  RAIN_STEP: 'rain_step',\n  RUNNING: 'running',\n  SLASHING: 'slashing',\n};\n\nclass PlayerSounds extends Sounds {\n  constructor(mode, player) {\n    super();\n    this.mode = mode;\n    this.player = player;\n    this.state = {\n      sounds: {\n        [SOUND_MAP.SLASHING]: true,\n        [SOUND_MAP.KILLING]: true,\n        [SOUND_MAP.RUNNING]: true,\n        [SOUND_MAP.RAIN_RUNNING]: true,\n        [SOUND_MAP.FORWARD_STEP]: true,\n        [SOUND_MAP.BACKWARD_STEP]: true,\n        [SOUND_MAP.RAIN_FORWARD_STEP]: true,\n        [SOUND_MAP.RAIN_BACKWARD_STEP]: true,\n        [SOUND_MAP.RAIN_STEP]: true,\n        [SOUND_MAP.DODGE_STEP_0]: true,\n        [SOUND_MAP.DODGE_STEP_1]: true,\n        [SOUND_MAP.RAIN_DODGE_STEP_0]: true,\n        [SOUND_MAP.RAIN_DODGE_STEP_1]: true,\n        [SOUND_MAP.HITTING_THE_FENCE]: true,\n        [SOUND_MAP.HITTING_THE_WALL]: true,\n        [SOUND_MAP.HITTING_THE_RAIN_FENCE]: true,\n      },\n    };\n  }\n\n  makeSound(soundId) {\n    if (this.state.sounds[soundId]) {\n      this.startHandler(soundId);\n      Sounds.makeSoundV2(soundId, () => this.finishHandler(soundId));\n    }\n  }\n\n  startHandler(soundId) {\n    this.state.sounds[soundId] = false;\n  }\n\n  finishHandler(soundId) {\n    this.state.sounds[soundId] = true;\n  }\n\n  walk() {\n    this.mode.winter ? this.snowWalk() : this.rainWalk();\n  }\n\n  dodge() {\n    this.mode.winter ? this.snowDodge() : this.rainDodge();\n  }\n\n  hitWall() {\n    this.makeSound(SOUND_MAP.HITTING_THE_WALL);\n  }\n\n  hitFence() {\n    this.mode.winter ? this.snowFenceHit() : this.rainFenceHit();\n  }\n\n  attack() {\n    this.makeSound(SOUND_MAP.SLASHING);\n  }\n\n  kill() {\n    this.makeSound(SOUND_MAP.KILLING);\n  }\n\n  snowWalk() {\n    if (this.player.running) {\n      this.makeSound(SOUND_MAP.RUNNING);\n    } else {\n      Math.random() > 0.5\n        ? this.makeSound(SOUND_MAP.FORWARD_STEP)\n        : this.makeSound(SOUND_MAP.BACKWARD_STEP);\n    }\n  }\n\n  rainWalk() {\n    if (this.player.running) {\n      this.makeSound(SOUND_MAP.RAIN_RUNNING);\n    } else if (Math.random() > 0.2) {\n      if (Math.random() > 0.5) {\n        this.makeSound(SOUND_MAP.RAIN_FORWARD_STEP);\n      } else {\n        this.makeSound(SOUND_MAP.RAIN_BACKWARD_STEP);\n      }\n    } else {\n      this.makeSound(SOUND_MAP.RAIN_STEP);\n    }\n  }\n\n  snowDodge() {\n    Math.random() > 0.5\n      ? this.makeSound(SOUND_MAP.DODGE_STEP_0)\n      : this.makeSound(SOUND_MAP.DODGE_STEP_1);\n  }\n\n  rainDodge() {\n    Math.random() > 0.5\n      ? this.makeSound(SOUND_MAP.RAIN_DODGE_STEP_0)\n      : this.makeSound(SOUND_MAP.RAIN_DODGE_STEP_1);\n  }\n\n  snowFenceHit() {\n    this.makeSound(SOUND_MAP.HITTING_THE_FENCE);\n  }\n\n  rainFenceHit() {\n    this.makeSound(SOUND_MAP.HITTING_THE_RAIN_FENCE);\n  }\n\n  isKillingEnded() {\n    const killingEnded = this.state.sounds[SOUND_MAP.KILLING];\n    return killingEnded;\n  }\n}\n\nexport default PlayerSounds;\n","import { soundManager } from 'soundmanager2';\n\nimport { precreateSounds, SM_URL, playSM, stopSM } from '../../utils/sound';\n\nclass Sounds {\n  constructor(game) {\n    this.game = game;\n    this.sound_end = true;\n    soundManager.setup({\n      url: SM_URL,\n      debugMode: false,\n      preferFlash: false,\n      useHighPerformance: true,\n      onready: () => precreateSounds(),\n    });\n  }\n\n  loopSound(soundId) {\n    playSM(soundId, {\n      multiShotEvents: true,\n      onfinish: () => this.loopSound(soundId),\n    });\n  }\n\n  static stopSound(soundId) {\n    stopSM(soundId);\n  }\n\n  static muteSound(soundId) {\n    soundManager.mute(soundId);\n  }\n\n  static unmuteSound(soundId) {\n    soundManager.unmute(soundId);\n  }\n\n  static makeSoundV2(soundId, finishHandler) {\n    playSM(soundId, {\n      multiShotEvents: true,\n      onfinish: finishHandler,\n    });\n  }\n\n  allSoundsEnded() {\n    const soundStates = Object.values(this.state.sounds);\n    const soundsEnded = soundStates.every((sound) => !!sound);\n    return soundsEnded;\n  }\n}\n\nexport default Sounds;\n","import GameSounds from './GameSounds';\nimport MenuSounds from './MenuSounds';\nimport NoiseSounds from './NoiseSounds';\nimport PaperSounds from './PaperSounds';\nimport PlayerSounds from './PlayerSounds';\nimport Sounds from './Sounds';\n\nexport {\n  GameSounds,\n  MenuSounds,\n  NoiseSounds,\n  PaperSounds,\n  PlayerSounds,\n  Sounds,\n};\n","class Bitmap {\n  constructor(src, width, height) {\n    this.image = new Image();\n    this.image.src = src;\n    this.width = width;\n    this.height = height;\n  }\n}\n\nexport default Bitmap;\n","import { getRandomInt } from '../utils/calc';\n\nclass Camera {\n  constructor(canvas, resolution, fov, mode, CIRCLE, map, PAPER_NUM) {\n    this.CIRCLE = CIRCLE;\n    this.PAPER_NUM = PAPER_NUM;\n    this.mode = mode;\n    this.ctx = canvas.getContext('2d');\n    this.width = canvas.width = window.innerWidth;\n    this.height = canvas.height = window.innerHeight;\n    this.resolution = resolution;\n    this.map = map;\n    this.spacing = this.width / resolution;\n    this.fov = fov;\n    this.range = 14;\n    this.scale = (this.width + this.height) / 1200;\n  }\n\n  render(player, map) {\n    this.drawSky(player.direction, map.skybox, map.light);\n    this.drawColumns(player, map);\n    this.drawWeapon(\n      player.left_hand,\n      player.right_hand,\n      player.paces,\n      player.grabDist,\n      player.put_dist,\n    );\n    this.drawMiniMap(player, map);\n    this.drawNumber();\n    this.drawPaper();\n    this.drawNoPaper();\n    this.drawLoo();\n    this.drawBomb();\n    this.drawTip();\n    this.drawWarning();\n    this.drawDie();\n    this.drawTaken();\n    this.drawAllDead();\n  }\n\n  drawSky(direction, sky, ambient) {\n    const width = sky.width * (this.height / sky.height) * 2;\n    const left = (-width * direction) / this.CIRCLE;\n\n    this.ctx.save();\n    this.ctx.drawImage(sky.image, left, 0, width, this.height);\n    if (left < width - this.width) {\n      this.ctx.drawImage(sky.image, left + width, 0, width, this.height);\n    }\n\n    if (ambient > 0) {\n      this.ctx.fillStyle = this.mode.ground;\n      this.ctx.globalAlpha = ambient * this.mode.param;\n      this.ctx.fillRect(0, this.height * 0.5, this.width, this.height * 0.5);\n    }\n    this.ctx.restore();\n  }\n\n  drawColumn(column, ray, angle, map) {\n    this.lightRange = this.mode.lightRange;\n    const { ctx } = this;\n    const left = Math.floor(column * this.spacing);\n    const width = Math.ceil(this.spacing);\n    let { wallTexture } = map;\n    let hit = -1;\n    const objects = [];\n    let hitDistance;\n    let step;\n\n    while (++hit < ray.length && ray[hit].height <= 0);\n\n    for (let s = ray.length - 1; s >= 0; s--) {\n      step = ray[s];\n      if (step.height === 3) {\n        wallTexture = map.fenceDoorTexture;\n        step.height = 1;\n      } else if (step.height === 2) {\n        wallTexture = map.fenceTexture;\n        step.height = 1;\n      } else wallTexture = map.wallTexture;\n\n      let drops_seed = 0;\n      this.mode.winter ? (drops_seed = 3) : (drops_seed = s);\n\n      let rainDrops =\n        Math.pow(Math.random(), this.mode.drops_amount) * drops_seed;\n      const rain = rainDrops > 0 && this.project(0.1, angle, step.distance);\n      let textureX;\n      let wall;\n\n      if (s === hit) {\n        textureX = Math.floor(wallTexture.width * step.offset);\n        wall = this.project(step.height, angle, step.distance);\n\n        ctx.globalAlpha = 1;\n        ctx.drawImage(\n          wallTexture.image,\n          textureX,\n          0,\n          1,\n          wallTexture.height,\n          left,\n          wall.top,\n          width,\n          wall.height,\n        );\n\n        ctx.fillStyle = this.mode.shadows;\n        this.shading = step.shading;\n        ctx.globalAlpha = Math.max(\n          (step.distance + step.shading) / this.lightRange - map.light,\n          0,\n        );\n        ctx.fillRect(left, wall.top, width, wall.height);\n        hitDistance = step.distance;\n      } else if (step.object) {\n        objects.push({\n          object: step.object,\n          distance: step.distance,\n          offset: step.offset,\n          angle,\n        });\n      }\n      ctx.fillStyle = this.mode.drops;\n      ctx.globalAlpha = this.mode.drops_opacity;\n      while (--rainDrops > 0)\n        ctx.fillRect(\n          left,\n          Math.random() * rain.top,\n          this.mode.particlesWidth,\n          this.mode.particlesHeight,\n        );\n    }\n    return {\n      objects,\n      hit: hitDistance,\n    };\n  }\n\n  drawColumns(player, map) {\n    this.ctx.save();\n    const allObjects = [];\n    for (let column = 0; column < this.resolution; column++) {\n      const angle = this.fov * (column / this.resolution - 0.5);\n      const ray = map.cast(player, player.direction + angle, this.range);\n      const columnProps = this.drawColumn(column, ray, angle, map);\n\n      allObjects.push(columnProps);\n    }\n    this.drawSprites(player, map, allObjects);\n    this.ctx.restore();\n  }\n\n  drawSprites(player, map, columnProps) {\n    const screenWidth = this.width;\n    const screenHeight = this.height;\n    const screenRatio = screenWidth / this.fov;\n    const { resolution } = this;\n\n    // calculate each sprite distance to player\n    this.setSpriteDistances(map.objects, player);\n\n    const sprites = Array.prototype.slice\n      .call(map.objects)\n      .map((sprite) => {\n        const distX = sprite.x - player.x;\n        const distY = sprite.y - player.y;\n        const width = (sprite.width * screenWidth) / sprite.distanceFromPlayer;\n        const height =\n          (sprite.height * screenHeight) / sprite.distanceFromPlayer;\n        const renderedFloorOffset =\n          sprite.floorOffset / sprite.distanceFromPlayer;\n        const angleToPlayer = Math.atan2(distY, distX);\n        const top =\n          (screenHeight / 2) * (1 + 1 / sprite.distanceFromPlayer) - height;\n        const numColumns = (width / screenWidth) * resolution;\n        let angleRelativeToPlayerView = player.direction - angleToPlayer;\n\n        if (angleRelativeToPlayerView >= this.CIRCLE / 2) {\n          angleRelativeToPlayerView -= this.CIRCLE;\n        }\n\n        const cameraXOffset =\n          this.width / 2 - screenRatio * angleRelativeToPlayerView;\n        const firstColumn = Math.floor(\n          ((cameraXOffset - width / 2) / screenWidth) * resolution,\n        );\n\n        sprite.distanceFromPlayer = Math.sqrt(\n          Math.pow(distX, 2) + Math.pow(distY, 2),\n        );\n        sprite.render = {\n          width,\n          height,\n          angleToPlayer: angleRelativeToPlayerView,\n          cameraXOffset,\n          distanceFromPlayer: sprite.distanceFromPlayer,\n          numColumns,\n          firstColumn,\n          top,\n        };\n        return sprite;\n      })\n      // sort sprites in distance order\n      .sort((a, b) => {\n        if (a.distanceFromPlayer < b.distanceFromPlayer) return 1;\n        if (a.distanceFromPlayer > b.distanceFromPlayer) return -1;\n        return 0;\n      });\n\n    this.ctx.save();\n    for (let column = 0; column < this.resolution; column++) {\n      this.drawSpriteColumn(player, map, column, columnProps[column], sprites);\n    }\n    this.ctx.restore();\n  }\n\n  drawSpriteColumn(player, map, column, columnProps, sprites) {\n    const { ctx } = this;\n    const left = Math.floor(column * this.spacing);\n    const width = Math.ceil(this.spacing);\n    const columnWidth = this.width / this.resolution;\n    const angle = this.fov * (column / this.resolution - 0.5);\n    let sprite;\n    let props;\n    let obj;\n    let textureX;\n    let height;\n    let projection;\n    let mappedColumnObj;\n    let spriteIsInColumn;\n    let top;\n\n    sprites = sprites.filter((sprite) => {\n      return !columnProps.hit || sprite.distanceFromPlayer < columnProps.hit;\n    });\n\n    for (let i = 0; i < sprites.length; i++) {\n      sprite = sprites[i];\n      spriteIsInColumn =\n        left > sprite.render.cameraXOffset - sprite.render.width / 2 &&\n        left < sprite.render.cameraXOffset + sprite.render.width / 2;\n\n      if (spriteIsInColumn) {\n        textureX = Math.floor(\n          (sprite.texture.width / sprite.render.numColumns) *\n            (column - sprite.render.firstColumn),\n        );\n        ctx.drawImage(\n          sprite.texture.image,\n          textureX,\n          0,\n          1,\n          sprite.texture.height,\n          left,\n          sprite.render.top,\n          width,\n          sprite.render.height,\n        );\n        this.ctx.fillStyle = '#000';\n        this.ctx.globalAlpha = 1;\n      }\n    }\n  }\n\n  setSpriteDistances(objects, player) {\n    let obj;\n    for (let i = 0; i < objects.length; i++) {\n      obj = objects[i];\n    }\n  }\n\n  drawWeapon(left_hand, right_hand, paces, grab, put) {\n    const bobX = Math.cos(paces * 2) * this.scale * 6;\n    const bobY = Math.sin(paces * 4) * this.scale * 6;\n    const left_r = this.width * 0.6 + bobX;\n    const left_l = this.width * 0.15 + bobX;\n    const top = this.height * 0.6 + bobY;\n    this.ctx.drawImage(\n      left_hand.image,\n      left_l + grab,\n      top + put,\n      left_hand.width * this.scale,\n      left_hand.height * this.scale,\n    );\n    this.ctx.drawImage(\n      right_hand.image,\n      left_r - grab,\n      top + put,\n      right_hand.width * this.scale,\n      right_hand.height * this.scale,\n    );\n  }\n\n  drawMiniMap(player, map) {\n    const { ctx } = this;\n    const miniMapSize = this.width * 0.2;\n    const x = this.width - miniMapSize - 10;\n    const y = 10;\n    const blockSize = miniMapSize / map.size;\n    const triangleX = x + (player.x / map.size) * miniMapSize;\n    const triangleY = y + (player.y / map.size) * miniMapSize;\n\n    ctx.save();\n\n    ctx.globalAlpha = 0.5; // map background\n    ctx.fillRect(x, y, miniMapSize, miniMapSize);\n\n    ctx.globalAlpha = 0.5; // blocks\n    ctx.fillStyle = '#4c8847';\n\n    for (let i = 0; i < map.size * map.size; i++) {\n      if (map.wallGrid[i]) {\n        if (map.wallGrid[i] === 2) {\n          ctx.fillStyle = '#35384b';\n        } else ctx.fillStyle = '#4c8847';\n        const row = Math.floor(i / map.size);\n        const col = i - map.size * row;\n        ctx.fillRect(\n          x + blockSize * col,\n          y + blockSize * row,\n          blockSize,\n          blockSize,\n        );\n      }\n    }\n    ctx.save();\n\n    for (let i = 0; i < map.objects.length; i++) {\n      // sprites\n      if (map.objects[i]) {\n        if (map.objects[i] === 1) ctx.fillStyle = map.objects[i].color;\n        ctx.globalAlpha = map.objects[i].logic ? 0.8 : 0.3;\n        if (map.objects[i].color === undefined) ctx.globalAlpha = 0;\n        ctx.fillStyle = map.objects[i].color || 'red';\n\n        ctx.fillRect(\n          x + blockSize * (map.objects[i].x - 0.5) + blockSize * 0.25,\n          y + blockSize * (map.objects[i].y - 0.5) + blockSize * 0.25,\n          blockSize * 0.5,\n          blockSize * 0.5,\n        );\n      }\n    }\n    ctx.restore();\n\n    ctx.globalAlpha = 1; // player\n    ctx.fillStyle = '#fff';\n    ctx.moveTo(triangleX, triangleY);\n    ctx.translate(triangleX, triangleY);\n\n    ctx.rotate(player.direction - Math.PI * 0.5);\n    ctx.beginPath();\n    ctx.lineTo(-2, -3); // bottom left of triangle\n    ctx.lineTo(0, 2); // tip of triangle\n    ctx.lineTo(2, -3); // bottom right of triangle\n    ctx.fill();\n\n    ctx.restore();\n  }\n\n  drawNumber() {\n    this.ctx.save();\n\n    this.ctx.font = '50px DieDieDie';\n    this.ctx.globalAlpha = 1;\n    this.mode.winter\n      ? (this.ctx.fillStyle = '#000')\n      : (this.ctx.fillStyle = '#fff');\n    const text = `Humans: ${this.map.people}`;\n    this.ctx.fillText(text, 60, 80);\n\n    this.ctx.restore();\n  }\n\n  drawPaper() {\n    this.ctx.save();\n\n    this.ctx.font = '50px DieDieDie';\n    this.ctx.globalAlpha = 1;\n    this.mode.winter\n      ? (this.ctx.fillStyle = '#000')\n      : (this.ctx.fillStyle = '#fff');\n    const text = `Papers: ${this.PAPER_NUM - this.map.papers}`;\n    this.ctx.fillText(text, 60, 160);\n\n    this.ctx.restore();\n  }\n\n  drawNoPaper() {\n    this.ctx.save();\n\n    this.ctx.font = '50px DieDieDie';\n    this.ctx.globalAlpha = this.map.show_no_paper;\n    this.mode.winter\n      ? (this.ctx.fillStyle = '#000')\n      : (this.ctx.fillStyle = '#fff');\n    this.ctx.fillText('No papers left. Use your hands!', this.width / 4, 80);\n\n    this.ctx.restore();\n  }\n\n  drawLoo() {\n    this.ctx.save();\n\n    this.ctx.font = '50px DieDieDie';\n    this.ctx.globalAlpha = this.map.show_loo;\n    this.mode.winter\n      ? (this.ctx.fillStyle = '#000')\n      : (this.ctx.fillStyle = '#fff');\n    this.ctx.fillText('Ooops, not this one :)', this.width / 3, 80);\n\n    this.ctx.restore();\n  }\n\n  drawBomb() {\n    this.ctx.save();\n\n    this.ctx.font = '50px DieDieDie';\n    this.ctx.globalAlpha = this.map.show_bomb;\n    this.mode.winter\n      ? (this.ctx.fillStyle = '#000')\n      : (this.ctx.fillStyle = '#fff');\n    this.ctx.fillText('Rush B! Terrorists always win!', this.width / 4, 80);\n\n    this.ctx.restore();\n  }\n\n  drawTip() {\n    this.ctx.save();\n\n    this.ctx.font = '50px DieDieDie';\n    this.ctx.globalAlpha = this.map.show_tip;\n    this.mode.winter\n      ? (this.ctx.fillStyle = '#000')\n      : (this.ctx.fillStyle = '#fff');\n    this.ctx.fillText('Step back, let them approach.', this.width / 4, 80);\n\n    this.ctx.restore();\n  }\n\n  drawWarning() {\n    this.ctx.save();\n\n    this.ctx.font = '50px DieDieDie';\n    this.ctx.globalAlpha = this.map.show_warning;\n    this.mode.winter\n      ? (this.ctx.fillStyle = '#000')\n      : (this.ctx.fillStyle = '#fff');\n    this.ctx.fillText('Stand still to place paper.', this.width / 3, 80);\n\n    this.ctx.restore();\n  }\n\n  drawDie() {\n    this.ctx.save();\n\n    this.ctx.font = '80px DieDieDie';\n    this.ctx.globalAlpha = this.map.show_die;\n    this.mode.winter\n      ? (this.ctx.fillStyle = '#000')\n      : (this.ctx.fillStyle = '#fff');\n    let w;\n    let h;\n    for (let i = 1; i < 30; i++) {\n      w = getRandomInt(0, 11);\n      h = getRandomInt(0, 9);\n      this.ctx.fillText('Die!', (this.width / 10) * w, (this.height / 8) * h);\n    }\n\n    this.ctx.restore();\n  }\n\n  drawTaken() {\n    this.ctx.save();\n\n    this.ctx.font = '50px DieDieDie';\n    this.ctx.globalAlpha = this.map.show_taken;\n    this.mode.winter\n      ? (this.ctx.fillStyle = '#000')\n      : (this.ctx.fillStyle = '#fff');\n    this.ctx.fillText('They took your paper!', this.width / 3, 80);\n\n    this.ctx.restore();\n  }\n\n  drawAllDead() {\n    this.ctx.save();\n\n    this.ctx.font = '50px DieDieDie';\n    this.ctx.globalAlpha = this.map.show_all_dead;\n    this.mode.winter\n      ? (this.ctx.fillStyle = '#000')\n      : (this.ctx.fillStyle = '#fff');\n    this.ctx.fillText(\n      \"They're all dead! Live another day...\",\n      this.width / 4,\n      80,\n    );\n\n    this.ctx.restore();\n  }\n\n  project(height, angle, distance) {\n    const z = distance * Math.cos(angle);\n    const wallHeight = (this.height * height) / z;\n    const bottom = (this.height / 2) * (1 + 1 / z);\n    return {\n      top: bottom - wallHeight,\n      bottom,\n      height: wallHeight,\n    };\n  }\n}\n\nexport default Camera;\n","const canvasBlock = document.querySelector('#display');\nconst lockHandler =\n  document.body.requestPointerLock ||\n  document.body.mozRequestPointerLock ||\n  document.body.webkitRequestPointerLock;\n\nconst KEY_MAP = {\n  37: 'left',\n  39: 'right',\n  38: 'forward',\n  40: 'backward',\n  65: 'sideLeft',\n  68: 'sideRight',\n  87: 'forward',\n  83: 'backward',\n  13: 'enter',\n  16: 'shift',\n  32: 'space',\n  27: 'escape',\n  69: 'attack',\n};\n\nconst MOUSE_SENSITIVITY = 100;\n\nclass Controls {\n  constructor(player) {\n    this.player = player;\n    this.states = {\n      left: false,\n      right: false,\n      forward: false,\n      backward: false,\n      shift: false,\n      sideLeft: false,\n      sideRight: false,\n    };\n    document.addEventListener('keydown', this.onKeyDown.bind(this), false);\n    document.addEventListener('keyup', this.onKeyUp.bind(this), false);\n    document.addEventListener('touchstart', this.onTouch.bind(this), false);\n    document.addEventListener('touchmove', this.onTouch.bind(this), false);\n    document.addEventListener('touchend', this.onTouchEnd.bind(this), false);\n    document.addEventListener(\n      'mousemove',\n      this.onMouseMovement.bind(this),\n      false,\n    );\n    canvasBlock.addEventListener('click', lockHandler);\n  }\n\n  onTouch(e) {\n    const t = e.touches[0];\n    this.onTouchEnd(e);\n    if (t.pageY < window.innerHeight * 0.5) this.onKey(true, { keyCode: 38 });\n    else if (t.pageX < window.innerWidth * 0.5)\n      this.onKey(true, { keyCode: 37 });\n    else if (t.pageY > window.innerWidth * 0.5)\n      this.onKey(true, { keyCode: 39 });\n  }\n\n  onTouchEnd(e) {\n    this.states = {\n      left: false,\n      right: false,\n      forward: false,\n      backward: false,\n      sideLeft: false,\n      sideRight: false,\n      shift: false,\n    };\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  onKeyDown(e) {\n    e.preventDefault();\n    e.stopPropagation();\n\n    const action = KEY_MAP[e.keyCode];\n\n    if (!action) return;\n\n    this.states[action] = true;\n\n    this.player.dosmth(action);\n  }\n\n  onKeyUp(e) {\n    e.preventDefault();\n    e.stopPropagation();\n\n    const action = KEY_MAP[e.keyCode];\n\n    if (!action) return;\n\n    this.states[action] = false;\n  }\n\n  onMouseMovement(e) {\n    const x = e.movementX || e.mozMovementX || e.webkitMovementX || 0;\n    const angle = Math.PI / MOUSE_SENSITIVITY;\n    if (x > 0) this.player.rotate(angle);\n    if (x < 0) this.player.rotate(-angle);\n  }\n}\n\nexport default Controls;\n","import { soundManager } from 'soundmanager2';\n\nimport ASSETS from '../../data/assets';\nimport SOUNDS from '../../data/sounds';\n\nimport { getRandomInt } from '../utils/calc';\nimport { playSM, preloadSounds } from '../utils/sound';\n\nimport Map from './Map';\nimport { Sounds, NoiseSounds, GameSounds } from './Audio';\nimport NPC from './NPC';\nimport Player from './Player';\nimport Camera from './Camera';\nimport Controls from './Controls';\nimport GameLoop from './GameLoop';\n\nconst videoBlock = document.querySelector('.intro');\nconst messageBlock = document.querySelector('.text');\nconst canvasBlock = document.querySelector('#display');\nconst messageChildBlock = document.querySelector('.text h1');\n\nclass Game {\n  constructor() {\n    this.CIRCLE = Math.PI * 2;\n    this.PAPER_NUM = 8;\n    this.PPL_NUM = 1;\n    this.PPL_XY = 30;\n    this.MAP_SIZE = 32;\n    this.RESOLUTION = 640;\n    this.mode = {};\n    this.gameEnded = false;\n    this.papers = ASSETS.papers;\n    this.trees = ASSETS.rain_trees;\n    this.bushes = ASSETS.rain_bushes;\n    this.sounds = new Sounds(this);\n  }\n\n  static enterFS(intro) {\n    if (intro.requestFullscreen) {\n      intro.requestFullscreen();\n    } else if (intro.mozRequestFullScreen) {\n      intro.mozRequestFullScreen();\n    } else if (intro.webkitRequestFullscreen) {\n      intro.webkitRequestFullscreen();\n    }\n  }\n\n  static exitFS(intro) {\n    if (intro.exitFullscreen) {\n      intro.exitFullscreen();\n    } else if (intro.mozExitFullScreen) {\n      intro.mozExitFullScreen();\n    } else if (intro.webkitExitFullscreen) {\n      intro.webkitExitFullscreen();\n    }\n  }\n\n  static mouseLock() {\n    if (document.body.requestPointerLock) {\n      document.body.requestPointerLock();\n    } else if (document.body.mozRequestPointerLock) {\n      document.body.mozRequestPointerLock();\n    } else if (document.body.webkitRequestPointerLock) {\n      document.body.webkitRequestPointerLock();\n    }\n  }\n\n  static showEndingScreen() {\n    messageBlock.classList.add('flex');\n    messageChildBlock.innerHTML = 'Do you want to play more?';\n    messageChildBlock.setAttribute('data-text', 'Do you want to kiLL more?');\n    canvasBlock.classList.remove('block');\n  }\n\n  loadGame() {\n    this.map = new Map(this.MAP_SIZE, this.mode);\n    this.camera = new Camera(\n      canvasBlock,\n      this.RESOLUTION,\n      0.8,\n      this.mode,\n      this.CIRCLE,\n      this.map,\n      this.PAPER_NUM,\n    );\n    this.gameLoop = new GameLoop();\n    this.noiseSounds = new NoiseSounds();\n    this.gameSounds = new GameSounds(this, this.mode);\n    this.player = new Player({ x: 1.5, y: 1.5, direction: 1.57, game: this });\n    this.controls = new Controls(this.player);\n\n    this.setMode();\n    this.addPeople();\n    this.map.buildMap(this.trees, this.bushes);\n\n    // videoBlock.classList.add('block');\n    // Game.enterFS(videoBlock);\n    // videoBlock.play();\n\n    // setTimeout(() => {\n    //   const { ENTERING } = SOUNDS.GENERAL;\n\n    //   Game.exitFS(videoBlock);\n    //   videoBlock.pause();\n    //   videoBlock.classList.remove('block');\n\n    //   messageBlock.classList.add('flex');\n    //   Game.mouseLock();\n    //   playSM(ENTERING.id, {\n    //     multiShotEvents: true,\n    //     onfinish: () => this.startGame(),\n    //   });\n    // }, 28000);\n\n    this.startGame();\n  }\n\n  startGame() {\n    messageBlock.classList.remove('flex');\n    canvasBlock.classList.add('block');\n\n    this.gameLoop.start((seconds) => {\n      if (this.mode.lightning) this.map.lightning(seconds);\n      this.map.update();\n      this.changeAmbient();\n\n      this.player.update(this.controls.states, this.map, seconds);\n      this.camera.render(this.player, this.map);\n\n      this.checkEnding();\n    });\n  }\n\n  checkEnding() {\n    if (this.map.people === 0 && this.player.playerSounds.isKillingEnded()) {\n      this.map.show_all_dead = 1;\n      this.map.show_loo = 0;\n      this.map.show_bomb = 0;\n      this.map.show_tip = 0;\n      this.map.show_warning = 0;\n\n      this.makeEndmode();\n      this.gameSounds.scream();\n    }\n\n    if (this.gameEnded) {\n      this.endGame();\n      this.gameLoop.stop();\n    }\n  }\n\n  endGame() {\n    soundManager.stopAll();\n    this.gameSounds.ending();\n    Game.showEndingScreen();\n  }\n\n  addPeople() {\n    for (let i = 0; i < this.PPL_NUM; i++) {\n      const x = getRandomInt(2, this.PPL_XY);\n      const y = getRandomInt(2, this.PPL_XY);\n      const picNum = getRandomInt(1, 5);\n      this.map.addObject(\n        new NPC(this.player, this.map, x, y, picNum, this.CIRCLE),\n      );\n      this.map.people++;\n    }\n  }\n\n  changeAmbient() {\n    if (this.noiseSounds.noisesEnd) {\n      const next = getRandomInt(0, 4);\n      this.noiseSounds.playNoises(next);\n    }\n  }\n\n  setMode() {\n    const { winter } = this.mode;\n\n    if (winter) {\n      this.trees = ASSETS.trees;\n      this.bushes = ASSETS.bushes;\n    }\n\n    this.gameSounds.ambient();\n  }\n\n  setToWinter() {\n    this.mode = {\n      winter: true,\n      light: 1,\n      lightning: false,\n      lightRange: 5,\n      shadows: '#fff',\n      drops: '#fff',\n      drops_opacity: 1,\n      drops_amount: 100,\n      ground: '#fff',\n      param: 0.5,\n      particlesWidth: 6,\n      particlesHeight: 6,\n      fence_door: ASSETS.mode.fenceDoor,\n      fence_texture: ASSETS.mode.snow.fence,\n      sky_texture: ASSETS.mode.snow.sky,\n      wall_texture: ASSETS.mode.snow.wall,\n    };\n  }\n\n  setToVanilla() {\n    this.mode = {\n      winter: false,\n      light: 2,\n      lightning: true,\n      lightRange: 5,\n      shadows: '#000',\n      drops: '#fff',\n      drops_opacity: 0.15,\n      drops_amount: 30,\n      ground: '#56361f',\n      param: 0.1,\n      particlesWidth: 2,\n      particlesHeight: 20,\n      fence_door: ASSETS.mode.fenceDoor,\n      fence_texture: ASSETS.mode.rain.fence,\n      sky_texture: ASSETS.mode.rain.sky,\n      wall_texture: ASSETS.mode.rain.wall,\n    };\n  }\n\n  makeEndmode() {\n    this.map.light = 2;\n    this.mode.param = 20;\n    this.mode.drops = '#f00';\n    this.mode.ground = '#f00';\n    this.mode.lightning = false;\n    this.mode.drops_opacity = 1;\n    this.mode.particlesWidth = 10;\n    this.mode.particlesHeight = 10;\n  }\n}\n\nexport default Game;\n","class GameLoop {\n  constructor() {\n    this.callback = () => {};\n    this.previousTime = 0;\n    this.frame = this.frame.bind(this);\n    this.stopped = false;\n  }\n\n  start(callback) {\n    this.callback = callback;\n    this.loopId = requestAnimationFrame(this.frame);\n  }\n\n  frame(currentTime) {\n    if (this.stopped) return;\n\n    const seconds = (currentTime - this.previousTime) / 1000;\n    if (seconds < 0.2) this.callback(seconds);\n\n    this.previousTime = currentTime;\n    this.loopId = requestAnimationFrame(this.frame);\n  }\n\n  stop() {\n    if (this.stopped) return;\n\n    cancelAnimationFrame(this.loopId);\n    this.stopped = true;\n  }\n}\n\nexport default GameLoop;\n","import { getRandomInt } from '../utils/calc';\n\nimport Bitmap from './Bitmap';\nimport Objects from './Objects';\nimport NPC from './NPC';\n\nclass Map {\n  constructor(size, mode) {\n    this.mode = mode;\n    this.size = size;\n    this.wallGrid = new Uint8Array(size * size);\n    this.skybox = new Bitmap(mode.sky_texture, 2000, 750);\n    this.fenceTexture = new Bitmap(mode.fence_texture, 512, 512);\n    this.fenceDoorTexture = new Bitmap(mode.fence_door, 512, 256);\n    this.wallTexture = new Bitmap(mode.wall_texture, 512, 512);\n    this.light = this.mode.light;\n    this.objects = [];\n    this.people = 0;\n    this.papers = 0;\n    this.show_no_paper = 0;\n    this.show_loo = 0;\n    this.show_bomb = 0;\n    this.show_tip = 0;\n    this.show_warning = 0;\n    this.show_die = 0;\n    this.show_taken = 0;\n    this.show_all_dead = 0;\n  }\n\n  get(x, y) {\n    x = Math.floor(x);\n    y = Math.floor(y);\n    if (x < 0 || x > this.size - 1 || y < 0 || y > this.size - 1) return -1;\n    return this.wallGrid[y * this.size + x];\n  }\n\n  addTrees(trees, col, row) {\n    if (this.get(col, row) === 0) {\n      const num = getRandomInt(0, 4);\n      this.addObject(\n        new Objects({\n          texture: new Bitmap(\n            trees[num].texture,\n            trees[num].width,\n            trees[num].height,\n          ),\n          x: col,\n          y: row,\n        }),\n      );\n    }\n  }\n\n  addBushes(bushes, col, row) {\n    if (this.get(col, row) === 0) {\n      const num = getRandomInt(0, 5);\n      this.addObject(\n        new Objects({\n          texture: new Bitmap(\n            bushes[num].texture,\n            bushes[num].width,\n            bushes[num].height,\n          ),\n          height: 0.5,\n          x: col,\n          y: row,\n        }),\n      );\n    }\n  }\n\n  buildMap(trees, bushes) {\n    let row;\n    let col;\n    this.wallGrid.fill(0);\n    for (let i = 0; i < this.size * this.size; i++) {\n      row = Math.floor(i / this.size);\n      col = i - this.size * row;\n      // Generate the labirinth\n      if (\n        row !== 1 &&\n        row !== this.size - 2 &&\n        col !== 1 &&\n        col !== this.size - 2\n      ) {\n        if (Math.random() > 0.2) {\n          Math.random() > 0.5\n            ? this.addBushes(bushes, col + 1.5, row + 1.5)\n            : this.addTrees(trees, col + 1.5, row + 1.5);\n        }\n        if (Math.random() > 0.7) {\n          this.wallGrid[i] = 1;\n        }\n      }\n      // Generate the fence\n      if (\n        row === 0 ||\n        row === this.size - 1 ||\n        col === 0 ||\n        col === this.size - 1\n      ) {\n        this.wallGrid[i] = 2;\n      }\n    }\n    this.wallGrid[1] = 3;\n  }\n\n  cast(point, angle, range) {\n    const self = this;\n    const sin = Math.sin(angle);\n    const cos = Math.cos(angle);\n    const noWall = { length2: Infinity };\n\n    return ray({\n      x: point.x,\n      y: point.y,\n      height: 0,\n      distance: 0,\n    });\n\n    function ray(origin) {\n      const stepX = step(sin, cos, origin.x, origin.y);\n      const stepY = step(cos, sin, origin.y, origin.x, true);\n      const nextStep =\n        stepX.length2 < stepY.length2\n          ? inspect(stepX, 1, 0, origin.distance, stepX.y)\n          : inspect(stepY, 0, 1, origin.distance, stepY.x);\n\n      if (nextStep.distance > range) return [origin];\n      return [origin].concat(ray(nextStep));\n    }\n\n    function step(rise, run, x, y, inverted) {\n      if (run === 0) return noWall;\n      const dx = run > 0 ? Math.floor(x + 1) - x : Math.ceil(x - 1) - x;\n      const dy = dx * (rise / run);\n      return {\n        x: inverted ? y + dy : x + dx,\n        y: inverted ? x + dx : y + dy,\n        length2: dx * dx + dy * dy,\n      };\n    }\n\n    function inspect(step, shiftX, shiftY, distance, offset) {\n      const dx = cos < 0 ? shiftX : 0;\n      const dy = sin < 0 ? shiftY : 0;\n      step.height = self.get(step.x - dx, step.y - dy);\n      step.distance = distance + Math.sqrt(step.length2);\n      step.object = self.getObject(step.x - dx, step.y - dy);\n      if (shiftX) step.shading = cos < 0 ? 2 : 0;\n      else step.shading = sin < 0 ? 2 : 1;\n      step.offset = offset - Math.floor(offset);\n      return step;\n    }\n  }\n\n  lightning(seconds) {\n    if (this.light > 0) this.light = Math.max(this.light - 10 * seconds, 0);\n    else if (Math.random() * 5 < seconds) this.light = 2;\n  }\n\n  update() {\n    this.objects.forEach((item) => {\n      if (item instanceof NPC) {\n        item.logic();\n      }\n    });\n  }\n\n  addObject(object) {\n    this.objects.push(object);\n  }\n\n  getObject(x, y) {\n    x = Math.floor(x);\n    y = Math.floor(y);\n    return this.objects[y * this.size + x];\n  }\n}\n\nexport default Map;\n","import { getRandomFloat } from '../utils/calc';\n\nimport Paper from './Paper';\nimport Bitmap from './Bitmap';\n\n\nclass NPC {\n  constructor(player, map, x, y, picNum, CIRCLE) {\n    this.CIRCLE = CIRCLE;\n    this.player = player;\n    this.map = map;\n    this.x = x;\n    this.y = y;\n    this.picNum = picNum;\n    this.color = '#cf3c8c';\n    this.texture = new Bitmap(`assets/images/npc-${picNum}.png`, 114, 300);\n    this.height = 0.6;\n    this.width = 0.225;\n    this.floorOffset = 0;\n    this.count = 0;\n    this.direction = 1;\n    this.speed = 0.7;\n    this.alive = true;\n    // this.found_dead = false;\n    this.found_paper = false;\n    this.taking_paper = false;\n    this.paperNearPerson = 0;\n  }\n\n  logic() {\n    if (this.alive) {\n      if (this.count > 270) {\n        this.direction += getRandomFloat(-(this.CIRCLE / 6), this.CIRCLE / 6);\n        this.count = 0;\n      }\n\n      // this.lookForDead()\n      this.searchForPaper();\n      if (!this.found_paper && !this.taking_paper) {\n        this.wonderAround();\n      }\n    }\n  }\n\n  wonderAround() {\n    this.count += 1;\n    this.run();\n    this.walk(0.05 * this.speed, this.direction);\n  }\n\n  run() {\n    const distToPlayer = this.distTo(this.player);\n    if (distToPlayer < 2) {\n      this.speed = 3;\n      this.direction = -this.player.direction;\n    } else this.speed = 0.7;\n  }\n\n  walk(distance, direction) {\n    const dx = Math.cos(direction) * distance;\n    const dy = Math.sin(direction) * distance;\n    const inDirectionX = this.map.get(this.x + dx, this.y);\n    const inDirectionY = this.map.get(this.x, this.y + dy);\n\n    if (\n      inDirectionX === 2 ||\n      inDirectionY === 2 ||\n      inDirectionX === 1 ||\n      inDirectionY === 1\n    ) {\n      this.direction = direction + this.CIRCLE / 6;\n    }\n    if (inDirectionX <= 0) this.x += dx;\n    if (inDirectionY <= 0) this.y += dy;\n    this.move('assets/images/npc');\n  }\n\n  move(url) {\n    if (this.count % 10 === 0) {\n      if (this.count % 20 === 0) {\n        this.texture = new Bitmap(`${url}2-${this.picNum}.png`, 114, 300);\n      } else this.texture = new Bitmap(`${url}-${this.picNum}.png`, 114, 300);\n    }\n  }\n\n  searchForPaper() {\n    let dx;\n    let dy;\n    let distToPaper;\n    let paper;\n    this.map.objects.some((item) => {\n      if (item instanceof Paper) {\n        paper = item;\n        dx = this.x - paper.x;\n        dy = this.y - paper.y;\n        distToPaper = this.distTo(paper);\n        this.isNearPaper(distToPaper, paper, dx, dy);\n      }\n    });\n  }\n\n  isNearPaper(distToPaper, paper, dx, dy) {\n    if (distToPaper < 5 && this.distTo(this.player) > 3) {\n      this.paper = paper;\n      this.found_paper = true;\n      if (distToPaper < 0.3) {\n        this.takingPaper();\n      } else {\n        this.approachPaper(dx, dy);\n      }\n    } else this.found_paper = false;\n  }\n\n  takingPaper() {\n    this.speed = 0;\n    this.taking_paper = true;\n    this.takePaper();\n  }\n\n  takePaper() {\n    this.paperNearPerson++;\n    if (this.paperNearPerson === 70) {\n      const idx = this.map.objects.indexOf(this.paper);\n      if (idx !== -1) {\n        this.map.objects.splice(idx, 1);\n      }\n      this.map.objects.forEach((item) => {\n        if (item instanceof NPC) {\n          item.found_paper = false;\n          item.taking_paper = false;\n          item.paperNearPerson = 0;\n        }\n      });\n      this.showTakenMessage();\n    }\n  }\n\n  approachPaper(dx, dy) {\n    const distToWalk = 0.007 * this.speed;\n    dx >= 0 ? (this.x -= distToWalk) : (this.x += distToWalk);\n    dy >= 0 ? (this.y -= distToWalk) : (this.y += distToWalk);\n    this.count += 0.5;\n    this.move('assets/images/npc');\n  }\n\n  /*\n  lookForDead() {\n      let dead, dx_dead, dy_dead, dist_to_dead;\n      this.map.objects.some((item)=>{\n          if(item instanceof NPC && !item.alive) {\n              dead = item;\n              dist_to_dead = this.distTo(dead);\n              this.isNearDead(dist_to_dead, dead);\n          }\n      });\n  };\n\n  isNearDead(dist_to_dead, dead) {\n      if (dist_to_dead < 3) {\n          console.log(\"OMG BODY!\")\n          this.dead = dead;\n          this.found_dead = true;\n          this.runFromDead();\n      } else {\n          this.stayCalm();\n      }\n  }\n\n  /*\n  runFromDead() {\n      this.found_paper = false;\n      this.taking_paper = false;\n      this.speed = 3;\n      this.direction = getRandomFloat(1,4);\n  };\n\n  stayCalm() {\n      this.speed = .7;\n      this.found_dead = false;\n  }; */\n\n  die() {\n    this.texture = new Bitmap('assets/images/npc_die.gif', 114, 300);\n    setTimeout(() => {\n      this.texture = new Bitmap(\n        `assets/images/npc3-${this.picNum}.png`,\n        300,\n        56,\n      );\n      this.height = 0.2;\n      this.width = 0.7;\n    }, 7000);\n  }\n\n  distTo(thing) {\n    const x = thing.x - this.x;\n    const y = thing.y - this.y;\n    return Math.sqrt(x * x + y * y);\n  }\n\n  showTakenMessage() {\n    this.map.show_taken = 1;\n    setTimeout(() => {\n      this.map.show_taken = 0;\n    }, 3000);\n  }\n}\n\nexport default NPC;\n","import ASSETS from '../../data/assets';\n\nimport Bitmap from './Bitmap';\n\nclass Objects {\n  constructor(object) {\n    this.texture =\n      object.texture || new Bitmap(ASSETS.trees[1].texture, 639, 1500);\n    this.height = object.height || 1;\n    this.width = 0.5;\n    this.x = object.x;\n    this.y = object.y;\n  }\n}\n\nexport default Objects;\n","class Paper {\n  constructor(x, y, texture) {\n    this.color = '#fff';\n    this.x = x;\n    this.y = y;\n    this.height = 0.2;\n    this.width = 0.2;\n    this.texture = texture;\n  }\n}\n\nexport default Paper;\n","import ASSETS from '../../data/assets';\n\nimport { getRandomInt } from '../utils/calc';\n\nimport Paper from './Paper';\nimport Bitmap from './Bitmap';\nimport NPC from './NPC';\nimport { PlayerSounds, PaperSounds } from './Audio';\n\nclass Player {\n  constructor(origin) {\n    this.x = origin.x;\n    this.y = origin.y;\n    this.direction = origin.direction;\n    this.CIRCLE = origin.game.CIRCLE;\n    this.PAPER_NUM = origin.game.PAPER_NUM;\n    this.papers = origin.game.papers;\n    this.map = origin.game.map;\n    this.mode = origin.game.mode;\n    this.game = origin.game;\n    this.right_hand = new Bitmap(\n      ASSETS.slender[0].texture,\n      ASSETS.slender[0].width,\n      ASSETS.slender[0].height,\n    );\n    this.left_hand = new Bitmap(\n      ASSETS.slender[1].texture,\n      ASSETS.slender[1].width,\n      ASSETS.slender[1].height,\n    );\n    this.playerSounds = new PlayerSounds(origin.game.mode, this);\n    this.paperSounds = new PaperSounds(this);\n    this.paces = 0;\n    this.prev_paper_place = [0, 0];\n    this.speed = 1;\n    this.grabDist = 0;\n    this.grab_state = false;\n    this.put_dist = 0;\n    this.put_state = false;\n    this.running = null;\n    this.paperType = null;\n  }\n\n  rotate(angle) {\n    this.direction = (this.direction + angle + this.CIRCLE) % this.CIRCLE;\n  }\n\n  walk(distance, map, direction) {\n    const dx = Math.cos(direction) * distance;\n    const dy = Math.sin(direction) * distance;\n    const inDirectionX = map.get(this.x + dx, this.y);\n    const inDirectionY = map.get(this.x, this.y + dy);\n\n    if (inDirectionX === 2 || inDirectionY === 2) this.playerSounds.hitFence();\n    if (inDirectionX === 1 || inDirectionY === 1) this.playerSounds.hitWall();\n\n    if (inDirectionX <= 0) this.x += dx;\n    if (inDirectionY <= 0) this.y += dy;\n    this.paces += distance;\n  }\n\n  update(controls, map, seconds) {\n    this.running = controls.shift;\n    this.walking =\n      controls.forward ||\n      controls.backward ||\n      controls.sideLeft ||\n      controls.sideRight;\n    if (controls.left) this.rotate(-Math.PI * seconds);\n    if (controls.right) this.rotate(Math.PI * seconds);\n    if (controls.forward) {\n      this.playerSounds.walk();\n      this.walk(this.speed * seconds, map, this.direction);\n    }\n    if (controls.backward) {\n      this.playerSounds.walk();\n      this.walk(-this.speed * seconds, map, this.direction);\n    }\n    if (controls.sideLeft) {\n      this.playerSounds.dodge();\n      this.walk((this.speed / 2) * seconds, map, this.direction - Math.PI / 2);\n    }\n    if (controls.sideRight) {\n      this.playerSounds.dodge();\n      this.walk(-(this.speed / 2) * seconds, map, this.direction - Math.PI / 2);\n    }\n    this.grab();\n    this.put();\n\n    controls.shift ? (this.speed = 3) : (this.speed = 1);\n  }\n\n  grab() {\n    if (this.grab_state === true && this.grabDist < 300) {\n      this.grabDist += 50;\n    } else {\n      this.grab_state = false;\n      if (this.grabDist !== 0) {\n        this.grabDist -= 25;\n      }\n    }\n  }\n\n  put() {\n    if (this.put_state === true && this.put_dist < 400) {\n      this.put_dist += 30;\n    } else {\n      this.put_state = false;\n      if (this.put_dist !== 0) {\n        this.put_dist -= 15;\n      }\n    }\n  }\n\n  dosmth(action) {\n    if (action === 'attack') {\n      this.grab_state = true;\n      this.attack();\n    }\n    if (action === 'space') {\n      this.put_state = true;\n      this.placePaper();\n    }\n    if (action === 'escape') window.location.reload();\n  }\n\n  attack() {\n    let x;\n    let y;\n    let victim;\n    let nearVictim = false;\n    this.map.objects.some((item) => {\n      if (item instanceof NPC && item.alive) {\n        victim = item;\n        x = this.x - victim.x;\n        y = this.y - victim.y;\n        if (Math.sqrt(x * x + y * y) < 0.5) {\n          return (nearVictim = true);\n        }\n      }\n    });\n    if (nearVictim) {\n      this.playerSounds.kill();\n      this.eat(victim);\n    } else {\n      this.playerSounds.attack();\n    }\n  }\n\n  eat(victim) {\n    victim.alive = false;\n    victim.color = undefined;\n    victim.die();\n    this.map.people--;\n    this.showDieMessage();\n  }\n\n  placePaper() {\n    const noPapersToPlace = this.map.papers >= this.PAPER_NUM;\n\n    if (noPapersToPlace) {\n      this.showNoPaperMessage();\n    } else {\n      const isSamePlace =\n        this.prev_paper_place[0] === this.x &&\n        this.prev_paper_place[1] === this.y;\n\n      const readyToPlaceHere =\n        !isSamePlace &&\n        !this.running &&\n        !this.walking &&\n        this.playerSounds.allSoundsEnded();\n\n      if (readyToPlaceHere) {\n        this.paperType = getRandomInt(0, 8);\n\n        const paperBitmap = new Bitmap(\n          this.papers[this.paperType].texture,\n          this.papers[this.paperType].width,\n          this.papers[this.paperType].height,\n        );\n\n        const paper = new Paper(this.x, this.y, paperBitmap);\n\n        this.map.addObject(paper);\n\n        this.paperSounds.place();\n\n        this.showPlacementMessage();\n\n        this.prev_paper_place = [this.x, this.y];\n        this.map.papers++;\n      } else {\n        this.showWarningMessage();\n      }\n    }\n  }\n\n  showPlacementMessage() {\n    if (this.paperType === 0) {\n      this.showLooMessage();\n    } else if (this.paperType === 7) {\n      this.showBombMessage();\n    } else {\n      this.showPaperMessage();\n    }\n  }\n\n  showNoPaperMessage() {\n    this.map.show_no_paper = 1;\n    this.map.show_loo = 0;\n    this.map.show_bomb = 0;\n    this.map.show_tip = 0;\n    this.map.show_warning = 0;\n    setTimeout(() => {\n      this.map.show_no_paper = 0;\n    }, 3000);\n  }\n\n  showLooMessage() {\n    this.map.show_loo = 1;\n    this.map.show_bomb = 0;\n    this.map.show_tip = 0;\n    this.map.show_warning = 0;\n    setTimeout(() => {\n      this.map.show_loo = 0;\n    }, 3000);\n  }\n\n  showBombMessage() {\n    this.map.show_loo = 0;\n    this.map.show_bomb = 1;\n    this.map.show_tip = 0;\n    this.map.show_warning = 0;\n    setTimeout(() => {\n      this.map.show_bomb = 0;\n    }, 3000);\n  }\n\n  showPaperMessage() {\n    this.map.show_loo = 0;\n    this.map.show_bomb = 0;\n    this.map.show_tip = 1;\n    this.map.show_warning = 0;\n    setTimeout(() => {\n      this.map.show_tip = 0;\n    }, 3000);\n  }\n\n  showWarningMessage() {\n    this.map.show_loo = 0;\n    this.map.show_bomb = 0;\n    this.map.show_tip = 0;\n    this.map.show_warning = 1;\n    setTimeout(() => {\n      this.map.show_warning = 0;\n    }, 3000);\n  }\n\n  showDieMessage() {\n    this.map.show_die = 1;\n    setTimeout(() => {\n      this.map.show_die = 0;\n    }, 3000);\n  }\n}\n\nexport default Player;\n","const getRandomInt = (min, max) => {\n  const minInt = Math.ceil(min);\n  const maxInt = Math.floor(max);\n  return Math.floor(Math.random() * (maxInt - minInt)) + minInt;\n};\n\nconst getRandomFloat = (min, max) => {\n  return min + Math.random() * (max + 1 - min);\n};\n\nexport { getRandomInt, getRandomFloat };\n","import { soundManager } from 'soundmanager2';\n\nimport SOUNDS from '../../data/sounds';\n\nconst SM_URL = 'node_modules/soundmanager2/swf';\n\nconst prepareFunc = (func, group) =>\n  Object.entries(group).forEach(([_, val]) => func(val));\n\nconst precreateGroup = (group) => prepareFunc(soundManager.createSound, group);\nconst preloadGroup = (group) => prepareFunc(soundManager.load, group);\n\nconst precreateSounds = () => prepareFunc(precreateGroup, SOUNDS);\nconst preloadSounds = () => prepareFunc(preloadGroup, SOUNDS);\n\nconst playSM = (id, config) => soundManager.play(id, config);\nconst stopSM = (id) => soundManager.stop(id);\n\nexport {\n  precreateGroup,\n  precreateSounds,\n  preloadGroup,\n  preloadSounds,\n  playSM,\n  stopSM,\n  SM_URL,\n  SOUNDS,\n};\n","export default __webpack_public_path__ + \"assets/images/bush_0.png\";","export default __webpack_public_path__ + \"assets/images/bush_1.png\";","export default __webpack_public_path__ + \"assets/images/bush_2.png\";","export default __webpack_public_path__ + \"assets/images/bush_3.png\";","export default __webpack_public_path__ + \"assets/images/bush_4.png\";","export default __webpack_public_path__ + \"assets/images/rain_bush_0.png\";","export default __webpack_public_path__ + \"assets/images/rain_bush_1.png\";","export default __webpack_public_path__ + \"assets/images/rain_bush_2.png\";","export default __webpack_public_path__ + \"assets/images/rain_bush_3.png\";","export default __webpack_public_path__ + \"assets/images/rain_bush_4.png\";","export default __webpack_public_path__ + \"assets/images/fence_door_0.jpg\";","export default __webpack_public_path__ + \"assets/images/npc-1.png\";","export default __webpack_public_path__ + \"assets/images/npc-2.png\";","export default __webpack_public_path__ + \"assets/images/npc-3.png\";","export default __webpack_public_path__ + \"assets/images/npc-4.png\";","export default __webpack_public_path__ + \"assets/images/npc2-1.png\";","export default __webpack_public_path__ + \"assets/images/npc2-2.png\";","export default __webpack_public_path__ + \"assets/images/npc2-3.png\";","export default __webpack_public_path__ + \"assets/images/npc2-4.png\";","export default __webpack_public_path__ + \"assets/images/npc3-1.png\";","export default __webpack_public_path__ + \"assets/images/npc3-2.png\";","export default __webpack_public_path__ + \"assets/images/npc3-3.png\";","export default __webpack_public_path__ + \"assets/images/npc3-4.png\";","export default __webpack_public_path__ + \"assets/images/npc_die.gif\";","export default __webpack_public_path__ + \"assets/images/paper_0.png\";","export default __webpack_public_path__ + \"assets/images/paper_1.png\";","export default __webpack_public_path__ + \"assets/images/paper_2.png\";","export default __webpack_public_path__ + \"assets/images/paper_3.png\";","export default __webpack_public_path__ + \"assets/images/paper_4.png\";","export default __webpack_public_path__ + \"assets/images/paper_5.png\";","export default __webpack_public_path__ + \"assets/images/paper_6.png\";","export default __webpack_public_path__ + \"assets/images/paper_7.png\";","export default __webpack_public_path__ + \"assets/images/rain_fence.jpg\";","export default __webpack_public_path__ + \"assets/images/rain_sky_panorama.jpg\";","export default __webpack_public_path__ + \"assets/images/rain_wall_texture.jpg\";","export default __webpack_public_path__ + \"assets/images/left_hand.png\";","export default __webpack_public_path__ + \"assets/images/right_hand.png\";","export default __webpack_public_path__ + \"assets/images/fence_snow.png\";","export default __webpack_public_path__ + \"assets/images/sky_panorama_snow.jpg\";","export default __webpack_public_path__ + \"assets/images/wall_texture_snow.jpg\";","export default __webpack_public_path__ + \"assets/images/rain_tree_0.png\";","export default __webpack_public_path__ + \"assets/images/rain_tree_1.png\";","export default __webpack_public_path__ + \"assets/images/rain_tree_2.png\";","export default __webpack_public_path__ + \"assets/images/rain_tree_3.png\";","export default __webpack_public_path__ + \"assets/images/tree_0.png\";","export default __webpack_public_path__ + \"assets/images/tree_1.png\";","export default __webpack_public_path__ + \"assets/images/tree_2.png\";","export default __webpack_public_path__ + \"assets/images/tree_3.png\";","export default __webpack_public_path__ + \"assets/music/ghost_in_the_house.mp3\";","export default __webpack_public_path__ + \"assets/music/just_horror_ambient.mp3\";","export default __webpack_public_path__ + \"assets/music/piano_menu_ambient.mp3\";","export default __webpack_public_path__ + \"assets/music/rain_ambient.mp3\";","export default __webpack_public_path__ + \"assets/music/scary_piano.mp3\";","export default __webpack_public_path__ + \"assets/music/static_menu_ambient.mp3\";","export default __webpack_public_path__ + \"assets/music/weird_noises.mp3\";","export default __webpack_public_path__ + \"assets/music/wind_ambient.mp3\";","export default __webpack_public_path__ + \"assets/music/come_out.mp3\";","export default __webpack_public_path__ + \"assets/music/ghost_scream.mp3\";","export default __webpack_public_path__ + \"assets/music/lululala.mp3\";","export default __webpack_public_path__ + \"assets/music/about_game.mp3\";","export default __webpack_public_path__ + \"assets/music/about_us.mp3\";","export default __webpack_public_path__ + \"assets/music/ho_ho_ho.mp3\";","export default __webpack_public_path__ + \"assets/music/play_button_hover.mp3\";","export default __webpack_public_path__ + \"assets/music/slender_logo_hover.mp3\";","export default __webpack_public_path__ + \"assets/music/entering_area.mp3\";","export default __webpack_public_path__ + \"assets/music/hitting_the_fence.mp3\";","export default __webpack_public_path__ + \"assets/music/hitting_the_rain_fence.mp3\";","export default __webpack_public_path__ + \"assets/music/hitting_the_wall.mp3\";","export default __webpack_public_path__ + \"assets/music/killing.mp3\";","export default __webpack_public_path__ + \"assets/music/placing_bomb.mp3\";","export default __webpack_public_path__ + \"assets/music/placing_loo_paper.mp3\";","export default __webpack_public_path__ + \"assets/music/placing_paper.mp3\";","export default __webpack_public_path__ + \"assets/music/slashing.mp3\";","export default __webpack_public_path__ + \"assets/music/backward_step.mp3\";","export default __webpack_public_path__ + \"assets/music/dodge_step_0.mp3\";","export default __webpack_public_path__ + \"assets/music/dodge_step_1.mp3\";","export default __webpack_public_path__ + \"assets/music/forward_step.mp3\";","export default __webpack_public_path__ + \"assets/music/rain_backward_step.mp3\";","export default __webpack_public_path__ + \"assets/music/rain_dodge_step_0.mp3\";","export default __webpack_public_path__ + \"assets/music/rain_dodge_step_1.mp3\";","export default __webpack_public_path__ + \"assets/music/rain_forward_step.mp3\";","export default __webpack_public_path__ + \"assets/music/rain_running.mp3\";","export default __webpack_public_path__ + \"assets/music/rain_step.mp3\";","export default __webpack_public_path__ + \"assets/music/running.mp3\";","export default __webpack_public_path__ + \"assets/video/intro.mp4\";","/** @license\r\n *\r\n * SoundManager 2: JavaScript Sound for the Web\r\n * ----------------------------------------------\r\n * http://schillmania.com/projects/soundmanager2/\r\n *\r\n * Copyright (c) 2007, Scott Schiller. All rights reserved.\r\n * Code provided under the BSD License:\r\n * http://schillmania.com/projects/soundmanager2/license.txt\r\n *\r\n * V2.97a.20170601\r\n */\r\n\r\n/**\r\n * About this file\r\n * -------------------------------------------------------------------------------------\r\n * This is the fully-commented source version of the SoundManager 2 API,\r\n * recommended for use during development and testing.\r\n *\r\n * See soundmanager2-nodebug-jsmin.js for an optimized build (~11KB with gzip.)\r\n * http://schillmania.com/projects/soundmanager2/doc/getstarted/#basic-inclusion\r\n * Alternately, serve this file with gzip for 75% compression savings (~30KB over HTTP.)\r\n *\r\n * You may notice <d> and </d> comments in this source; these are delimiters for\r\n * debug blocks which are removed in the -nodebug builds, further optimizing code size.\r\n *\r\n * Also, as you may note: Whoa, reliable cross-platform/device audio support is hard! ;)\r\n */\r\n\r\n(function SM2(window, _undefined) {\r\n\r\n/* global Audio, document, window, navigator, define, module, SM2_DEFER, opera, setTimeout, setInterval, clearTimeout, sm2Debugger */\r\n\r\n'use strict';\r\n\r\nif (!window || !window.document) {\r\n\r\n  // Don't cross the [environment] streams. SM2 expects to be running in a browser, not under node.js etc.\r\n  // Additionally, if a browser somehow manages to fail this test, as Egon said: \"It would be bad.\"\r\n\r\n  throw new Error('SoundManager requires a browser with window and document objects.');\r\n\r\n}\r\n\r\nvar soundManager = null;\r\n\r\n/**\r\n * The SoundManager constructor.\r\n *\r\n * @constructor\r\n * @param {string} smURL Optional: Path to SWF files\r\n * @param {string} smID Optional: The ID to use for the SWF container element\r\n * @this {SoundManager}\r\n * @return {SoundManager} The new SoundManager instance\r\n */\r\n\r\nfunction SoundManager(smURL, smID) {\r\n\r\n  /**\r\n   * soundManager configuration options list\r\n   * defines top-level configuration properties to be applied to the soundManager instance (eg. soundManager.flashVersion)\r\n   * to set these properties, use the setup() method - eg., soundManager.setup({url: '/swf/', flashVersion: 9})\r\n   */\r\n\r\n  this.setupOptions = {\r\n\r\n    url: (smURL || null),             // path (directory) where SoundManager 2 SWFs exist, eg., /path/to/swfs/\r\n    flashVersion: 8,                  // flash build to use (8 or 9.) Some API features require 9.\r\n    debugMode: true,                  // enable debugging output (console.log() with HTML fallback)\r\n    debugFlash: false,                // enable debugging output inside SWF, troubleshoot Flash/browser issues\r\n    useConsole: true,                 // use console.log() if available (otherwise, writes to #soundmanager-debug element)\r\n    consoleOnly: true,                // if console is being used, do not create/write to #soundmanager-debug\r\n    waitForWindowLoad: false,         // force SM2 to wait for window.onload() before trying to call soundManager.onload()\r\n    bgColor: '#ffffff',               // SWF background color. N/A when wmode = 'transparent'\r\n    useHighPerformance: false,        // position:fixed flash movie can help increase js/flash speed, minimize lag\r\n    flashPollingInterval: null,       // msec affecting whileplaying/loading callback frequency. If null, default of 50 msec is used.\r\n    html5PollingInterval: null,       // msec affecting whileplaying() for HTML5 audio, excluding mobile devices. If null, native HTML5 update events are used.\r\n    flashLoadTimeout: 1000,           // msec to wait for flash movie to load before failing (0 = infinity)\r\n    wmode: null,                      // flash rendering mode - null, 'transparent', or 'opaque' (last two allow z-index to work)\r\n    allowScriptAccess: 'always',      // for scripting the SWF (object/embed property), 'always' or 'sameDomain'\r\n    useFlashBlock: false,             // *requires flashblock.css, see demos* - allow recovery from flash blockers. Wait indefinitely and apply timeout CSS to SWF, if applicable.\r\n    useHTML5Audio: true,              // use HTML5 Audio() where API is supported (most Safari, Chrome versions), Firefox (MP3/MP4 support varies.) Ideally, transparent vs. Flash API where possible.\r\n    forceUseGlobalHTML5Audio: false,  // if true, a single Audio() object is used for all sounds - and only one can play at a time.\r\n    ignoreMobileRestrictions: false,  // if true, SM2 will not apply global HTML5 audio rules to mobile UAs. iOS > 7 and WebViews may allow multiple Audio() instances.\r\n    html5Test: /^(probably|maybe)$/i, // HTML5 Audio() format support test. Use /^probably$/i; if you want to be more conservative.\r\n    preferFlash: false,               // overrides useHTML5audio, will use Flash for MP3/MP4/AAC if present. Potential option if HTML5 playback with these formats is quirky.\r\n    noSWFCache: false,                // if true, appends ?ts={date} to break aggressive SWF caching.\r\n    idPrefix: 'sound'                 // if an id is not provided to createSound(), this prefix is used for generated IDs - 'sound0', 'sound1' etc.\r\n\r\n  };\r\n\r\n  this.defaultOptions = {\r\n\r\n    /**\r\n     * the default configuration for sound objects made with createSound() and related methods\r\n     * eg., volume, auto-load behaviour and so forth\r\n     */\r\n\r\n    autoLoad: false,        // enable automatic loading (otherwise .load() will be called on demand with .play(), the latter being nicer on bandwidth - if you want to .load yourself, you also can)\r\n    autoPlay: false,        // enable playing of file as soon as possible (much faster if \"stream\" is true)\r\n    from: null,             // position to start playback within a sound (msec), default = beginning\r\n    loops: 1,               // how many times to repeat the sound (position will wrap around to 0, setPosition() will break out of loop when >0)\r\n    onid3: null,            // callback function for \"ID3 data is added/available\"\r\n    onerror: null,          // callback function for \"load failed\" (or, playback/network/decode error under HTML5.)\r\n    onload: null,           // callback function for \"load finished\"\r\n    whileloading: null,     // callback function for \"download progress update\" (X of Y bytes received)\r\n    onplay: null,           // callback for \"play\" start\r\n    onpause: null,          // callback for \"pause\"\r\n    onresume: null,         // callback for \"resume\" (pause toggle)\r\n    whileplaying: null,     // callback during play (position update)\r\n    onposition: null,       // object containing times and function callbacks for positions of interest\r\n    onstop: null,           // callback for \"user stop\"\r\n    onfinish: null,         // callback function for \"sound finished playing\"\r\n    multiShot: true,        // let sounds \"restart\" or layer on top of each other when played multiple times, rather than one-shot/one at a time\r\n    multiShotEvents: false, // fire multiple sound events (currently onfinish() only) when multiShot is enabled\r\n    position: null,         // offset (milliseconds) to seek to within loaded sound data.\r\n    pan: 0,                 // \"pan\" settings, left-to-right, -100 to 100\r\n    playbackRate: 1,        // rate at which to play the sound (HTML5-only)\r\n    stream: true,           // allows playing before entire file has loaded (recommended)\r\n    to: null,               // position to end playback within a sound (msec), default = end\r\n    type: null,             // MIME-like hint for file pattern / canPlay() tests, eg. audio/mp3\r\n    usePolicyFile: false,   // enable crossdomain.xml request for audio on remote domains (for ID3/waveform access)\r\n    volume: 100             // self-explanatory. 0-100, the latter being the max.\r\n\r\n  };\r\n\r\n  this.flash9Options = {\r\n\r\n    /**\r\n     * flash 9-only options,\r\n     * merged into defaultOptions if flash 9 is being used\r\n     */\r\n\r\n    onfailure: null,        // callback function for when playing fails (Flash 9, MovieStar + RTMP-only)\r\n    isMovieStar: null,      // \"MovieStar\" MPEG4 audio mode. Null (default) = auto detect MP4, AAC etc. based on URL. true = force on, ignore URL\r\n    usePeakData: false,     // enable left/right channel peak (level) data\r\n    useWaveformData: false, // enable sound spectrum (raw waveform data) - NOTE: May increase CPU load.\r\n    useEQData: false,       // enable sound EQ (frequency spectrum data) - NOTE: May increase CPU load.\r\n    onbufferchange: null,   // callback for \"isBuffering\" property change\r\n    ondataerror: null       // callback for waveform/eq data access error (flash playing audio in other tabs/domains)\r\n\r\n  };\r\n\r\n  this.movieStarOptions = {\r\n\r\n    /**\r\n     * flash 9.0r115+ MPEG4 audio options,\r\n     * merged into defaultOptions if flash 9+movieStar mode is enabled\r\n     */\r\n\r\n    bufferTime: 3,          // seconds of data to buffer before playback begins (null = flash default of 0.1 seconds - if AAC playback is gappy, try increasing.)\r\n    serverURL: null,        // rtmp: FMS or FMIS server to connect to, required when requesting media via RTMP or one of its variants\r\n    onconnect: null,        // rtmp: callback for connection to flash media server\r\n    duration: null          // rtmp: song duration (msec)\r\n\r\n  };\r\n\r\n  this.audioFormats = {\r\n\r\n    /**\r\n     * determines HTML5 support + flash requirements.\r\n     * if no support (via flash and/or HTML5) for a \"required\" format, SM2 will fail to start.\r\n     * flash fallback is used for MP3 or MP4 if HTML5 can't play it (or if preferFlash = true)\r\n     */\r\n\r\n    mp3: {\r\n      type: ['audio/mpeg; codecs=\"mp3\"', 'audio/mpeg', 'audio/mp3', 'audio/MPA', 'audio/mpa-robust'],\r\n      required: true\r\n    },\r\n\r\n    mp4: {\r\n      related: ['aac', 'm4a', 'm4b'], // additional formats under the MP4 container\r\n      type: ['audio/mp4; codecs=\"mp4a.40.2\"', 'audio/aac', 'audio/x-m4a', 'audio/MP4A-LATM', 'audio/mpeg4-generic'],\r\n      required: false\r\n    },\r\n\r\n    ogg: {\r\n      type: ['audio/ogg; codecs=vorbis'],\r\n      required: false\r\n    },\r\n\r\n    opus: {\r\n      type: ['audio/ogg; codecs=opus', 'audio/opus'],\r\n      required: false\r\n    },\r\n\r\n    wav: {\r\n      type: ['audio/wav; codecs=\"1\"', 'audio/wav', 'audio/wave', 'audio/x-wav'],\r\n      required: false\r\n    },\r\n\r\n    flac: {\r\n      type: ['audio/flac'],\r\n      required: false\r\n    }\r\n\r\n  };\r\n\r\n  // HTML attributes (id + class names) for the SWF container\r\n\r\n  this.movieID = 'sm2-container';\r\n  this.id = (smID || 'sm2movie');\r\n\r\n  this.debugID = 'soundmanager-debug';\r\n  this.debugURLParam = /([#?&])debug=1/i;\r\n\r\n  // dynamic attributes\r\n\r\n  this.versionNumber = 'V2.97a.20170601';\r\n  this.version = null;\r\n  this.movieURL = null;\r\n  this.altURL = null;\r\n  this.swfLoaded = false;\r\n  this.enabled = false;\r\n  this.oMC = null;\r\n  this.sounds = {};\r\n  this.soundIDs = [];\r\n  this.muted = false;\r\n  this.didFlashBlock = false;\r\n  this.filePattern = null;\r\n\r\n  this.filePatterns = {\r\n    flash8: /\\.mp3(\\?.*)?$/i,\r\n    flash9: /\\.mp3(\\?.*)?$/i\r\n  };\r\n\r\n  // support indicators, set at init\r\n\r\n  this.features = {\r\n    buffering: false,\r\n    peakData: false,\r\n    waveformData: false,\r\n    eqData: false,\r\n    movieStar: false\r\n  };\r\n\r\n  // flash sandbox info, used primarily in troubleshooting\r\n\r\n  this.sandbox = {\r\n    // <d>\r\n    type: null,\r\n    types: {\r\n      remote: 'remote (domain-based) rules',\r\n      localWithFile: 'local with file access (no internet access)',\r\n      localWithNetwork: 'local with network (internet access only, no local access)',\r\n      localTrusted: 'local, trusted (local+internet access)'\r\n    },\r\n    description: null,\r\n    noRemote: null,\r\n    noLocal: null\r\n    // </d>\r\n  };\r\n\r\n  /**\r\n   * format support (html5/flash)\r\n   * stores canPlayType() results based on audioFormats.\r\n   * eg. { mp3: boolean, mp4: boolean }\r\n   * treat as read-only.\r\n   */\r\n\r\n  this.html5 = {\r\n    usingFlash: null // set if/when flash fallback is needed\r\n  };\r\n\r\n  // file type support hash\r\n  this.flash = {};\r\n\r\n  // determined at init time\r\n  this.html5Only = false;\r\n\r\n  // used for special cases (eg. iPad/iPhone/palm OS?)\r\n  this.ignoreFlash = false;\r\n\r\n  /**\r\n   * a few private internals (OK, a lot. :D)\r\n   */\r\n\r\n  var SMSound,\r\n  sm2 = this, globalHTML5Audio = null, flash = null, sm = 'soundManager', smc = sm + ': ', h5 = 'HTML5::', id, ua = navigator.userAgent, wl = window.location.href.toString(), doc = document, doNothing, setProperties, init, fV, on_queue = [], debugOpen = true, debugTS, didAppend = false, appendSuccess = false, didInit = false, disabled = false, windowLoaded = false, _wDS, wdCount = 0, initComplete, mixin, assign, extraOptions, addOnEvent, processOnEvents, initUserOnload, delayWaitForEI, waitForEI, rebootIntoHTML5, setVersionInfo, handleFocus, strings, initMovie, domContentLoaded, winOnLoad, didDCLoaded, getDocument, createMovie, catchError, setPolling, initDebug, debugLevels = ['log', 'info', 'warn', 'error'], defaultFlashVersion = 8, disableObject, failSafely, normalizeMovieURL, oRemoved = null, oRemovedHTML = null, str, flashBlockHandler, getSWFCSS, swfCSS, toggleDebug, loopFix, policyFix, complain, idCheck, waitingForEI = false, initPending = false, startTimer, stopTimer, timerExecute, h5TimerCount = 0, h5IntervalTimer = null, parseURL, messages = [],\r\n  canIgnoreFlash, needsFlash = null, featureCheck, html5OK, html5CanPlay, html5ErrorCodes, html5Ext, html5Unload, domContentLoadedIE, testHTML5, event, slice = Array.prototype.slice, useGlobalHTML5Audio = false, lastGlobalHTML5URL, hasFlash, detectFlash, badSafariFix, html5_events, showSupport, flushMessages, wrapCallback, idCounter = 0, didSetup, msecScale = 1000,\r\n  is_iDevice = ua.match(/(ipad|iphone|ipod)/i), isAndroid = ua.match(/android/i), isIE = ua.match(/msie|trident/i),\r\n  isWebkit = ua.match(/webkit/i),\r\n  isSafari = (ua.match(/safari/i) && !ua.match(/chrome/i)),\r\n  isOpera = (ua.match(/opera/i)),\r\n  mobileHTML5 = (ua.match(/(mobile|pre\\/|xoom)/i) || is_iDevice || isAndroid),\r\n  isBadSafari = (!wl.match(/usehtml5audio/i) && !wl.match(/sm2-ignorebadua/i) && isSafari && !ua.match(/silk/i) && ua.match(/OS\\sX\\s10_6_([3-7])/i)), // Safari 4 and 5 (excluding Kindle Fire, \"Silk\") occasionally fail to load/play HTML5 audio on Snow Leopard 10.6.3 through 10.6.7 due to bug(s) in QuickTime X and/or other underlying frameworks. :/ Confirmed bug. https://bugs.webkit.org/show_bug.cgi?id=32159\r\n  hasConsole = (window.console !== _undefined && console.log !== _undefined),\r\n  isFocused = (doc.hasFocus !== _undefined ? doc.hasFocus() : null),\r\n  tryInitOnFocus = (isSafari && (doc.hasFocus === _undefined || !doc.hasFocus())),\r\n  okToDisable = !tryInitOnFocus,\r\n  flashMIME = /(mp3|mp4|mpa|m4a|m4b)/i,\r\n  emptyURL = 'about:blank', // safe URL to unload, or load nothing from (flash 8 + most HTML5 UAs)\r\n  emptyWAV = 'data:audio/wave;base64,/UklGRiYAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQIAAAD//w==', // tiny WAV for HTML5 unloading\r\n  overHTTP = (doc.location ? doc.location.protocol.match(/http/i) : null),\r\n  http = (!overHTTP ? '//' : ''),\r\n  // mp3, mp4, aac etc.\r\n  netStreamMimeTypes = /^\\s*audio\\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4|m4v|m4a|m4b|mp4v|3gp|3g2)\\s*(?:$|;)/i,\r\n  // Flash v9.0r115+ \"moviestar\" formats\r\n  netStreamTypes = ['mpeg4', 'aac', 'flv', 'mov', 'mp4', 'm4v', 'f4v', 'm4a', 'm4b', 'mp4v', '3gp', '3g2'],\r\n  netStreamPattern = new RegExp('\\\\.(' + netStreamTypes.join('|') + ')(\\\\?.*)?$', 'i');\r\n\r\n  this.mimePattern = /^\\s*audio\\/(?:x-)?(?:mp(?:eg|3))\\s*(?:$|;)/i; // default mp3 set\r\n\r\n  // use altURL if not \"online\"\r\n  this.useAltURL = !overHTTP;\r\n\r\n  swfCSS = {\r\n    swfBox: 'sm2-object-box',\r\n    swfDefault: 'movieContainer',\r\n    swfError: 'swf_error', // SWF loaded, but SM2 couldn't start (other error)\r\n    swfTimedout: 'swf_timedout',\r\n    swfLoaded: 'swf_loaded',\r\n    swfUnblocked: 'swf_unblocked', // or loaded OK\r\n    sm2Debug: 'sm2_debug',\r\n    highPerf: 'high_performance',\r\n    flashDebug: 'flash_debug'\r\n  };\r\n\r\n  /**\r\n   * HTML5 error codes, per W3C\r\n   * Error code 1, MEDIA_ERR_ABORTED: Client aborted download at user's request.\r\n   * Error code 2, MEDIA_ERR_NETWORK: A network error of some description caused the user agent to stop fetching the media resource, after the resource was established to be usable.\r\n   * Error code 3, MEDIA_ERR_DECODE: An error of some description occurred while decoding the media resource, after the resource was established to be usable.\r\n   * Error code 4, MEDIA_ERR_SRC_NOT_SUPPORTED: Media (audio file) not supported (\"not usable.\")\r\n   * Reference: https://html.spec.whatwg.org/multipage/embedded-content.html#error-codes\r\n   */\r\n  html5ErrorCodes = [\r\n    null,\r\n    'MEDIA_ERR_ABORTED',\r\n    'MEDIA_ERR_NETWORK',\r\n    'MEDIA_ERR_DECODE',\r\n    'MEDIA_ERR_SRC_NOT_SUPPORTED'\r\n  ];\r\n\r\n  /**\r\n   * basic HTML5 Audio() support test\r\n   * try...catch because of IE 9 \"not implemented\" nonsense\r\n   * https://github.com/Modernizr/Modernizr/issues/224\r\n   */\r\n\r\n  this.hasHTML5 = (function() {\r\n    try {\r\n      // new Audio(null) for stupid Opera 9.64 case, which throws not_enough_arguments exception otherwise.\r\n      return (Audio !== _undefined && (isOpera && opera !== _undefined && opera.version() < 10 ? new Audio(null) : new Audio()).canPlayType !== _undefined);\r\n    } catch(e) {\r\n      return false;\r\n    }\r\n  }());\r\n\r\n  /**\r\n   * Public SoundManager API\r\n   * -----------------------\r\n   */\r\n\r\n  /**\r\n   * Configures top-level soundManager properties.\r\n   *\r\n   * @param {object} options Option parameters, eg. { flashVersion: 9, url: '/path/to/swfs/' }\r\n   * onready and ontimeout are also accepted parameters. call soundManager.setup() to see the full list.\r\n   */\r\n\r\n  this.setup = function(options) {\r\n\r\n    var noURL = (!sm2.url);\r\n\r\n    // warn if flash options have already been applied\r\n\r\n    if (options !== _undefined && didInit && needsFlash && sm2.ok() && (options.flashVersion !== _undefined || options.url !== _undefined || options.html5Test !== _undefined)) {\r\n      complain(str('setupLate'));\r\n    }\r\n\r\n    // TODO: defer: true?\r\n\r\n    assign(options);\r\n\r\n    if (!useGlobalHTML5Audio) {\r\n\r\n      if (mobileHTML5) {\r\n\r\n        // force the singleton HTML5 pattern on mobile, by default.\r\n        if (!sm2.setupOptions.ignoreMobileRestrictions || sm2.setupOptions.forceUseGlobalHTML5Audio) {\r\n          messages.push(strings.globalHTML5);\r\n          useGlobalHTML5Audio = true;\r\n        }\r\n\r\n      } else if (sm2.setupOptions.forceUseGlobalHTML5Audio) {\r\n\r\n        // only apply singleton HTML5 on desktop if forced.\r\n        messages.push(strings.globalHTML5);\r\n        useGlobalHTML5Audio = true;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (!didSetup && mobileHTML5) {\r\n\r\n      if (sm2.setupOptions.ignoreMobileRestrictions) {\r\n\r\n        messages.push(strings.ignoreMobile);\r\n\r\n      } else {\r\n\r\n        // prefer HTML5 for mobile + tablet-like devices, probably more reliable vs. flash at this point.\r\n\r\n        // <d>\r\n        if (!sm2.setupOptions.useHTML5Audio || sm2.setupOptions.preferFlash) {\r\n          // notify that defaults are being changed.\r\n          sm2._wD(strings.mobileUA);\r\n        }\r\n        // </d>\r\n\r\n        sm2.setupOptions.useHTML5Audio = true;\r\n        sm2.setupOptions.preferFlash = false;\r\n\r\n        if (is_iDevice) {\r\n\r\n          // no flash here.\r\n          sm2.ignoreFlash = true;\r\n\r\n        } else if ((isAndroid && !ua.match(/android\\s2\\.3/i)) || !isAndroid) {\r\n\r\n          /**\r\n           * Android devices tend to work better with a single audio instance, specifically for chained playback of sounds in sequence.\r\n           * Common use case: exiting sound onfinish() -> createSound() -> play()\r\n           * Presuming similar restrictions for other mobile, non-Android, non-iOS devices.\r\n           */\r\n\r\n          // <d>\r\n          sm2._wD(strings.globalHTML5);\r\n          // </d>\r\n\r\n          useGlobalHTML5Audio = true;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // special case 1: \"Late setup\". SM2 loaded normally, but user didn't assign flash URL eg., setup({url:...}) before SM2 init. Treat as delayed init.\r\n\r\n    if (options) {\r\n\r\n      if (noURL && didDCLoaded && options.url !== _undefined) {\r\n        sm2.beginDelayedInit();\r\n      }\r\n\r\n      // special case 2: If lazy-loading SM2 (DOMContentLoaded has already happened) and user calls setup() with url: parameter, try to init ASAP.\r\n\r\n      if (!didDCLoaded && options.url !== _undefined && doc.readyState === 'complete') {\r\n        setTimeout(domContentLoaded, 1);\r\n      }\r\n\r\n    }\r\n\r\n    didSetup = true;\r\n\r\n    return sm2;\r\n\r\n  };\r\n\r\n  this.ok = function() {\r\n\r\n    return (needsFlash ? (didInit && !disabled) : (sm2.useHTML5Audio && sm2.hasHTML5));\r\n\r\n  };\r\n\r\n  this.supported = this.ok; // legacy\r\n\r\n  this.getMovie = function(movie_id) {\r\n\r\n    // safety net: some old browsers differ on SWF references, possibly related to ExternalInterface / flash version\r\n    return id(movie_id) || doc[movie_id] || window[movie_id];\r\n\r\n  };\r\n\r\n  /**\r\n   * Creates a SMSound sound object instance. Can also be overloaded, e.g., createSound('mySound', '/some.mp3');\r\n   *\r\n   * @param {object} oOptions Sound options (at minimum, url parameter is required.)\r\n   * @return {object} SMSound The new SMSound object.\r\n   */\r\n\r\n  this.createSound = function(oOptions, _url) {\r\n\r\n    var cs, cs_string, options, oSound = null;\r\n\r\n    // <d>\r\n    cs = sm + '.createSound(): ';\r\n    cs_string = cs + str(!didInit ? 'notReady' : 'notOK');\r\n    // </d>\r\n\r\n    if (!didInit || !sm2.ok()) {\r\n      complain(cs_string);\r\n      return false;\r\n    }\r\n\r\n    if (_url !== _undefined) {\r\n      // function overloading in JS! :) ... assume simple createSound(id, url) use case.\r\n      oOptions = {\r\n        id: oOptions,\r\n        url: _url\r\n      };\r\n    }\r\n\r\n    // inherit from defaultOptions\r\n    options = mixin(oOptions);\r\n\r\n    options.url = parseURL(options.url);\r\n\r\n    // generate an id, if needed.\r\n    if (options.id === _undefined) {\r\n      options.id = sm2.setupOptions.idPrefix + (idCounter++);\r\n    }\r\n\r\n    // <d>\r\n    if (options.id.toString().charAt(0).match(/^[0-9]$/)) {\r\n      sm2._wD(cs + str('badID', options.id), 2);\r\n    }\r\n\r\n    sm2._wD(cs + options.id + (options.url ? ' (' + options.url + ')' : ''), 1);\r\n    // </d>\r\n\r\n    if (idCheck(options.id, true)) {\r\n      sm2._wD(cs + options.id + ' exists', 1);\r\n      return sm2.sounds[options.id];\r\n    }\r\n\r\n    function make() {\r\n\r\n      options = loopFix(options);\r\n      sm2.sounds[options.id] = new SMSound(options);\r\n      sm2.soundIDs.push(options.id);\r\n      return sm2.sounds[options.id];\r\n\r\n    }\r\n\r\n    if (html5OK(options)) {\r\n\r\n      oSound = make();\r\n      // <d>\r\n      if (!sm2.html5Only) {\r\n        sm2._wD(options.id + ': Using HTML5');\r\n      }\r\n      // </d>\r\n      oSound._setup_html5(options);\r\n\r\n    } else {\r\n\r\n      if (sm2.html5Only) {\r\n        sm2._wD(options.id + ': No HTML5 support for this sound, and no Flash. Exiting.');\r\n        return make();\r\n      }\r\n\r\n      // TODO: Move HTML5/flash checks into generic URL parsing/handling function.\r\n\r\n      if (sm2.html5.usingFlash && options.url && options.url.match(/data:/i)) {\r\n        // data: URIs not supported by Flash, either.\r\n        sm2._wD(options.id + ': data: URIs not supported via Flash. Exiting.');\r\n        return make();\r\n      }\r\n\r\n      if (fV > 8) {\r\n        if (options.isMovieStar === null) {\r\n          // attempt to detect MPEG-4 formats\r\n          options.isMovieStar = !!(options.serverURL || (options.type ? options.type.match(netStreamMimeTypes) : false) || (options.url && options.url.match(netStreamPattern)));\r\n        }\r\n        // <d>\r\n        if (options.isMovieStar) {\r\n          sm2._wD(cs + 'using MovieStar handling');\r\n          if (options.loops > 1) {\r\n            _wDS('noNSLoop');\r\n          }\r\n        }\r\n        // </d>\r\n      }\r\n\r\n      options = policyFix(options, cs);\r\n      oSound = make();\r\n\r\n      if (fV === 8) {\r\n        flash._createSound(options.id, options.loops || 1, options.usePolicyFile);\r\n      } else {\r\n        flash._createSound(options.id, options.url, options.usePeakData, options.useWaveformData, options.useEQData, options.isMovieStar, (options.isMovieStar ? options.bufferTime : false), options.loops || 1, options.serverURL, options.duration || null, options.autoPlay, true, options.autoLoad, options.usePolicyFile);\r\n        if (!options.serverURL) {\r\n          // We are connected immediately\r\n          oSound.connected = true;\r\n          if (options.onconnect) {\r\n            options.onconnect.apply(oSound);\r\n          }\r\n        }\r\n      }\r\n\r\n      if (!options.serverURL && (options.autoLoad || options.autoPlay)) {\r\n        // call load for non-rtmp streams\r\n        oSound.load(options);\r\n      }\r\n\r\n    }\r\n\r\n    // rtmp will play in onconnect\r\n    if (!options.serverURL && options.autoPlay) {\r\n      oSound.play();\r\n    }\r\n\r\n    return oSound;\r\n\r\n  };\r\n\r\n  /**\r\n   * Destroys a SMSound sound object instance.\r\n   *\r\n   * @param {string} sID The ID of the sound to destroy\r\n   */\r\n\r\n  this.destroySound = function(sID, _bFromSound) {\r\n\r\n    // explicitly destroy a sound before normal page unload, etc.\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    var oS = sm2.sounds[sID], i;\r\n\r\n    oS.stop();\r\n\r\n    // Disable all callbacks after stop(), when the sound is being destroyed\r\n    oS._iO = {};\r\n\r\n    oS.unload();\r\n\r\n    for (i = 0; i < sm2.soundIDs.length; i++) {\r\n      if (sm2.soundIDs[i] === sID) {\r\n        sm2.soundIDs.splice(i, 1);\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (!_bFromSound) {\r\n      // ignore if being called from SMSound instance\r\n      oS.destruct(true);\r\n    }\r\n\r\n    oS = null;\r\n    delete sm2.sounds[sID];\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the load() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @param {object} oOptions Optional: Sound options\r\n   */\r\n\r\n  this.load = function(sID, oOptions) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].load(oOptions);\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the unload() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   */\r\n\r\n  this.unload = function(sID) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].unload();\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the onPosition() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @param {number} nPosition The position to watch for\r\n   * @param {function} oMethod The relevant callback to fire\r\n   * @param {object} oScope Optional: The scope to apply the callback to\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.onPosition = function(sID, nPosition, oMethod, oScope) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].onposition(nPosition, oMethod, oScope);\r\n\r\n  };\r\n\r\n  // legacy/backwards-compability: lower-case method name\r\n  this.onposition = this.onPosition;\r\n\r\n  /**\r\n   * Calls the clearOnPosition() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @param {number} nPosition The position to watch for\r\n   * @param {function} oMethod Optional: The relevant callback to fire\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.clearOnPosition = function(sID, nPosition, oMethod) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].clearOnPosition(nPosition, oMethod);\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the play() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @param {object} oOptions Optional: Sound options\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.play = function(sID, oOptions) {\r\n\r\n    var result = null,\r\n        // legacy function-overloading use case: play('mySound', '/path/to/some.mp3');\r\n        overloaded = (oOptions && !(oOptions instanceof Object));\r\n\r\n    if (!didInit || !sm2.ok()) {\r\n      complain(sm + '.play(): ' + str(!didInit ? 'notReady' : 'notOK'));\r\n      return false;\r\n    }\r\n\r\n    if (!idCheck(sID, overloaded)) {\r\n\r\n      // no sound found for the given ID. Bail.\r\n      if (!overloaded) return false;\r\n\r\n      if (overloaded) {\r\n        oOptions = {\r\n          url: oOptions\r\n        };\r\n      }\r\n\r\n      if (oOptions && oOptions.url) {\r\n        // overloading use case, create+play: .play('someID', {url:'/path/to.mp3'});\r\n        sm2._wD(sm + '.play(): Attempting to create \"' + sID + '\"', 1);\r\n        oOptions.id = sID;\r\n        result = sm2.createSound(oOptions).play();\r\n      }\r\n\r\n    } else if (overloaded) {\r\n\r\n      // existing sound object case\r\n      oOptions = {\r\n        url: oOptions\r\n      };\r\n\r\n    }\r\n\r\n    if (result === null) {\r\n      // default case\r\n      result = sm2.sounds[sID].play(oOptions);\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  // just for convenience\r\n  this.start = this.play;\r\n\r\n  /**\r\n   * Calls the setPlaybackRate() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.setPlaybackRate = function(sID, rate, allowOverride) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].setPlaybackRate(rate, allowOverride);\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the setPosition() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @param {number} nMsecOffset Position (milliseconds)\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.setPosition = function(sID, nMsecOffset) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].setPosition(nMsecOffset);\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the stop() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.stop = function(sID) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    sm2._wD(sm + '.stop(' + sID + ')', 1);\r\n\r\n    return sm2.sounds[sID].stop();\r\n\r\n  };\r\n\r\n  /**\r\n   * Stops all currently-playing sounds.\r\n   */\r\n\r\n  this.stopAll = function() {\r\n\r\n    var oSound;\r\n    sm2._wD(sm + '.stopAll()', 1);\r\n\r\n    for (oSound in sm2.sounds) {\r\n      if (sm2.sounds.hasOwnProperty(oSound)) {\r\n        // apply only to sound objects\r\n        sm2.sounds[oSound].stop();\r\n      }\r\n    }\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the pause() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.pause = function(sID) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].pause();\r\n\r\n  };\r\n\r\n  /**\r\n   * Pauses all currently-playing sounds.\r\n   */\r\n\r\n  this.pauseAll = function() {\r\n\r\n    var i;\r\n    for (i = sm2.soundIDs.length - 1; i >= 0; i--) {\r\n      sm2.sounds[sm2.soundIDs[i]].pause();\r\n    }\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the resume() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.resume = function(sID) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].resume();\r\n\r\n  };\r\n\r\n  /**\r\n   * Resumes all currently-paused sounds.\r\n   */\r\n\r\n  this.resumeAll = function() {\r\n\r\n    var i;\r\n    for (i = sm2.soundIDs.length - 1; i >= 0; i--) {\r\n      sm2.sounds[sm2.soundIDs[i]].resume();\r\n    }\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the togglePause() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.togglePause = function(sID) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].togglePause();\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the setPan() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @param {number} nPan The pan value (-100 to 100)\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.setPan = function(sID, nPan) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].setPan(nPan);\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the setVolume() method of a SMSound object by ID\r\n   * Overloaded case: pass only volume argument eg., setVolume(50) to apply to all sounds.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @param {number} nVol The volume value (0 to 100)\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.setVolume = function(sID, nVol) {\r\n\r\n    // setVolume(50) function overloading case - apply to all sounds\r\n\r\n    var i, j;\r\n\r\n    if (sID !== _undefined && !isNaN(sID) && nVol === _undefined) {\r\n      for (i = 0, j = sm2.soundIDs.length; i < j; i++) {\r\n        sm2.sounds[sm2.soundIDs[i]].setVolume(sID);\r\n      }\r\n      return false;\r\n    }\r\n\r\n    // setVolume('mySound', 50) case\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].setVolume(nVol);\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the mute() method of either a single SMSound object by ID, or all sound objects.\r\n   *\r\n   * @param {string} sID Optional: The ID of the sound (if omitted, all sounds will be used.)\r\n   */\r\n\r\n  this.mute = function(sID) {\r\n\r\n    var i = 0;\r\n\r\n    if (sID instanceof String) {\r\n      sID = null;\r\n    }\r\n\r\n    if (!sID) {\r\n\r\n      sm2._wD(sm + '.mute(): Muting all sounds');\r\n      for (i = sm2.soundIDs.length - 1; i >= 0; i--) {\r\n        sm2.sounds[sm2.soundIDs[i]].mute();\r\n      }\r\n      sm2.muted = true;\r\n\r\n    } else {\r\n\r\n      if (!idCheck(sID)) return false;\r\n\r\n      sm2._wD(sm + '.mute(): Muting \"' + sID + '\"');\r\n      return sm2.sounds[sID].mute();\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  /**\r\n   * Mutes all sounds.\r\n   */\r\n\r\n  this.muteAll = function() {\r\n\r\n    sm2.mute();\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the unmute() method of either a single SMSound object by ID, or all sound objects.\r\n   *\r\n   * @param {string} sID Optional: The ID of the sound (if omitted, all sounds will be used.)\r\n   */\r\n\r\n  this.unmute = function(sID) {\r\n\r\n    var i;\r\n\r\n    if (sID instanceof String) {\r\n      sID = null;\r\n    }\r\n\r\n    if (!sID) {\r\n\r\n      sm2._wD(sm + '.unmute(): Unmuting all sounds');\r\n      for (i = sm2.soundIDs.length - 1; i >= 0; i--) {\r\n        sm2.sounds[sm2.soundIDs[i]].unmute();\r\n      }\r\n      sm2.muted = false;\r\n\r\n    } else {\r\n\r\n      if (!idCheck(sID)) return false;\r\n\r\n      sm2._wD(sm + '.unmute(): Unmuting \"' + sID + '\"');\r\n\r\n      return sm2.sounds[sID].unmute();\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  /**\r\n   * Unmutes all sounds.\r\n   */\r\n\r\n  this.unmuteAll = function() {\r\n\r\n    sm2.unmute();\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the toggleMute() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.toggleMute = function(sID) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].toggleMute();\r\n\r\n  };\r\n\r\n  /**\r\n   * Retrieves the memory used by the flash plugin.\r\n   *\r\n   * @return {number} The amount of memory in use\r\n   */\r\n\r\n  this.getMemoryUse = function() {\r\n\r\n    // flash-only\r\n    var ram = 0;\r\n\r\n    if (flash && fV !== 8) {\r\n      ram = parseInt(flash._getMemoryUse(), 10);\r\n    }\r\n\r\n    return ram;\r\n\r\n  };\r\n\r\n  /**\r\n   * Undocumented: NOPs soundManager and all SMSound objects.\r\n   */\r\n\r\n  this.disable = function(bNoDisable) {\r\n\r\n    // destroy all functions\r\n    var i;\r\n\r\n    if (bNoDisable === _undefined) {\r\n      bNoDisable = false;\r\n    }\r\n\r\n    // already disabled?\r\n    if (disabled) return false;\r\n\r\n    disabled = true;\r\n\r\n    _wDS('shutdown', 1);\r\n\r\n    for (i = sm2.soundIDs.length - 1; i >= 0; i--) {\r\n      disableObject(sm2.sounds[sm2.soundIDs[i]]);\r\n    }\r\n\r\n    disableObject(sm2);\r\n\r\n    // fire \"complete\", despite fail\r\n    initComplete(bNoDisable);\r\n\r\n    event.remove(window, 'load', initUserOnload);\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  /**\r\n   * Determines playability of a MIME type, eg. 'audio/mp3'.\r\n   */\r\n\r\n  this.canPlayMIME = function(sMIME) {\r\n\r\n    var result;\r\n\r\n    if (sm2.hasHTML5) {\r\n      result = html5CanPlay({\r\n        type: sMIME\r\n      });\r\n    }\r\n\r\n    if (!result && needsFlash) {\r\n      // if flash 9, test netStream (movieStar) types as well.\r\n      result = (sMIME && sm2.ok() ? !!((fV > 8 ? sMIME.match(netStreamMimeTypes) : null) || sMIME.match(sm2.mimePattern)) : null); // TODO: make less \"weird\" (per JSLint)\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  /**\r\n   * Determines playability of a URL based on audio support.\r\n   *\r\n   * @param {string} sURL The URL to test\r\n   * @return {boolean} URL playability\r\n   */\r\n\r\n  this.canPlayURL = function(sURL) {\r\n\r\n    var result;\r\n\r\n    if (sm2.hasHTML5) {\r\n      result = html5CanPlay({\r\n        url: sURL\r\n      });\r\n    }\r\n\r\n    if (!result && needsFlash) {\r\n      result = (sURL && sm2.ok() ? !!(sURL.match(sm2.filePattern)) : null);\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  /**\r\n   * Determines playability of an HTML DOM &lt;a&gt; object (or similar object literal) based on audio support.\r\n   *\r\n   * @param {object} oLink an HTML DOM &lt;a&gt; object or object literal including href and/or type attributes\r\n   * @return {boolean} URL playability\r\n   */\r\n\r\n  this.canPlayLink = function(oLink) {\r\n\r\n    if (oLink.type !== _undefined && oLink.type && sm2.canPlayMIME(oLink.type)) return true;\r\n\r\n    return sm2.canPlayURL(oLink.href);\r\n\r\n  };\r\n\r\n  /**\r\n   * Retrieves a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.getSoundById = function(sID, _suppressDebug) {\r\n\r\n    if (!sID) return null;\r\n\r\n    var result = sm2.sounds[sID];\r\n\r\n    // <d>\r\n    if (!result && !_suppressDebug) {\r\n      sm2._wD(sm + '.getSoundById(): Sound \"' + sID + '\" not found.', 2);\r\n    }\r\n    // </d>\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  /**\r\n   * Queues a callback for execution when SoundManager has successfully initialized.\r\n   *\r\n   * @param {function} oMethod The callback method to fire\r\n   * @param {object} oScope Optional: The scope to apply to the callback\r\n   */\r\n\r\n  this.onready = function(oMethod, oScope) {\r\n\r\n    var sType = 'onready',\r\n        result = false;\r\n\r\n    if (typeof oMethod === 'function') {\r\n\r\n      // <d>\r\n      if (didInit) {\r\n        sm2._wD(str('queue', sType));\r\n      }\r\n      // </d>\r\n\r\n      if (!oScope) {\r\n        oScope = window;\r\n      }\r\n\r\n      addOnEvent(sType, oMethod, oScope);\r\n      processOnEvents();\r\n\r\n      result = true;\r\n\r\n    } else {\r\n\r\n      throw str('needFunction', sType);\r\n\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  /**\r\n   * Queues a callback for execution when SoundManager has failed to initialize.\r\n   *\r\n   * @param {function} oMethod The callback method to fire\r\n   * @param {object} oScope Optional: The scope to apply to the callback\r\n   */\r\n\r\n  this.ontimeout = function(oMethod, oScope) {\r\n\r\n    var sType = 'ontimeout',\r\n        result = false;\r\n\r\n    if (typeof oMethod === 'function') {\r\n\r\n      // <d>\r\n      if (didInit) {\r\n        sm2._wD(str('queue', sType));\r\n      }\r\n      // </d>\r\n\r\n      if (!oScope) {\r\n        oScope = window;\r\n      }\r\n\r\n      addOnEvent(sType, oMethod, oScope);\r\n      processOnEvents({ type: sType });\r\n\r\n      result = true;\r\n\r\n    } else {\r\n\r\n      throw str('needFunction', sType);\r\n\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  /**\r\n   * Writes console.log()-style debug output to a console or in-browser element.\r\n   * Applies when debugMode = true\r\n   *\r\n   * @param {string} sText The console message\r\n   * @param {object} nType Optional log level (number), or object. Number case: Log type/style where 0 = 'info', 1 = 'warn', 2 = 'error'. Object case: Object to be dumped.\r\n   */\r\n\r\n  this._writeDebug = function(sText, sTypeOrObject) {\r\n\r\n    // pseudo-private console.log()-style output\r\n    // <d>\r\n\r\n    var sDID = 'soundmanager-debug', o, oItem;\r\n\r\n    if (!sm2.setupOptions.debugMode) return false;\r\n\r\n    if (hasConsole && sm2.useConsole) {\r\n      if (sTypeOrObject && typeof sTypeOrObject === 'object') {\r\n        // object passed; dump to console.\r\n        console.log(sText, sTypeOrObject);\r\n      } else if (debugLevels[sTypeOrObject] !== _undefined) {\r\n        console[debugLevels[sTypeOrObject]](sText);\r\n      } else {\r\n        console.log(sText);\r\n      }\r\n      if (sm2.consoleOnly) return true;\r\n    }\r\n\r\n    o = id(sDID);\r\n\r\n    if (!o) return false;\r\n\r\n    oItem = doc.createElement('div');\r\n\r\n    if (++wdCount % 2 === 0) {\r\n      oItem.className = 'sm2-alt';\r\n    }\r\n\r\n    if (sTypeOrObject === _undefined) {\r\n      sTypeOrObject = 0;\r\n    } else {\r\n      sTypeOrObject = parseInt(sTypeOrObject, 10);\r\n    }\r\n\r\n    oItem.appendChild(doc.createTextNode(sText));\r\n\r\n    if (sTypeOrObject) {\r\n      if (sTypeOrObject >= 2) {\r\n        oItem.style.fontWeight = 'bold';\r\n      }\r\n      if (sTypeOrObject === 3) {\r\n        oItem.style.color = '#ff3333';\r\n      }\r\n    }\r\n\r\n    // top-to-bottom\r\n    // o.appendChild(oItem);\r\n\r\n    // bottom-to-top\r\n    o.insertBefore(oItem, o.firstChild);\r\n\r\n    o = null;\r\n    // </d>\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  // <d>\r\n  // last-resort debugging option\r\n  if (wl.indexOf('sm2-debug=alert') !== -1) {\r\n    this._writeDebug = function(sText) {\r\n      window.alert(sText);\r\n    };\r\n  }\r\n  // </d>\r\n\r\n  // alias\r\n  this._wD = this._writeDebug;\r\n\r\n  /**\r\n   * Provides debug / state information on all SMSound objects.\r\n   */\r\n\r\n  this._debug = function() {\r\n\r\n    // <d>\r\n    var i, j;\r\n    _wDS('currentObj', 1);\r\n\r\n    for (i = 0, j = sm2.soundIDs.length; i < j; i++) {\r\n      sm2.sounds[sm2.soundIDs[i]]._debug();\r\n    }\r\n    // </d>\r\n\r\n  };\r\n\r\n  /**\r\n   * Restarts and re-initializes the SoundManager instance.\r\n   *\r\n   * @param {boolean} resetEvents Optional: When true, removes all registered onready and ontimeout event callbacks.\r\n   * @param {boolean} excludeInit Options: When true, does not call beginDelayedInit() (which would restart SM2).\r\n   * @return {object} soundManager The soundManager instance.\r\n   */\r\n\r\n  this.reboot = function(resetEvents, excludeInit) {\r\n\r\n    // reset some (or all) state, and re-init unless otherwise specified.\r\n\r\n    // <d>\r\n    if (sm2.soundIDs.length) {\r\n      sm2._wD('Destroying ' + sm2.soundIDs.length + ' SMSound object' + (sm2.soundIDs.length !== 1 ? 's' : '') + '...');\r\n    }\r\n    // </d>\r\n\r\n    var i, j, k;\r\n\r\n    for (i = sm2.soundIDs.length - 1; i >= 0; i--) {\r\n      sm2.sounds[sm2.soundIDs[i]].destruct();\r\n    }\r\n\r\n    // trash ze flash (remove from the DOM)\r\n\r\n    if (flash) {\r\n\r\n      try {\r\n\r\n        if (isIE) {\r\n          oRemovedHTML = flash.innerHTML;\r\n        }\r\n\r\n        oRemoved = flash.parentNode.removeChild(flash);\r\n\r\n      } catch(e) {\r\n\r\n        // Remove failed? May be due to flash blockers silently removing the SWF object/embed node from the DOM. Warn and continue.\r\n\r\n        _wDS('badRemove', 2);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // actually, force recreate of movie.\r\n\r\n    oRemovedHTML = oRemoved = needsFlash = flash = null;\r\n\r\n    sm2.enabled = didDCLoaded = didInit = waitingForEI = initPending = didAppend = appendSuccess = disabled = useGlobalHTML5Audio = sm2.swfLoaded = false;\r\n\r\n    sm2.soundIDs = [];\r\n    sm2.sounds = {};\r\n\r\n    idCounter = 0;\r\n    didSetup = false;\r\n\r\n    if (!resetEvents) {\r\n      // reset callbacks for onready, ontimeout etc. so that they will fire again on re-init\r\n      for (i in on_queue) {\r\n        if (on_queue.hasOwnProperty(i)) {\r\n          for (j = 0, k = on_queue[i].length; j < k; j++) {\r\n            on_queue[i][j].fired = false;\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      // remove all callbacks entirely\r\n      on_queue = [];\r\n    }\r\n\r\n    // <d>\r\n    if (!excludeInit) {\r\n      sm2._wD(sm + ': Rebooting...');\r\n    }\r\n    // </d>\r\n\r\n    // reset HTML5 and flash canPlay test results\r\n\r\n    sm2.html5 = {\r\n      usingFlash: null\r\n    };\r\n\r\n    sm2.flash = {};\r\n\r\n    // reset device-specific HTML/flash mode switches\r\n\r\n    sm2.html5Only = false;\r\n    sm2.ignoreFlash = false;\r\n\r\n    window.setTimeout(function() {\r\n\r\n      // by default, re-init\r\n\r\n      if (!excludeInit) {\r\n        sm2.beginDelayedInit();\r\n      }\r\n\r\n    }, 20);\r\n\r\n    return sm2;\r\n\r\n  };\r\n\r\n  this.reset = function() {\r\n\r\n    /**\r\n     * Shuts down and restores the SoundManager instance to its original loaded state, without an explicit reboot. All onready/ontimeout handlers are removed.\r\n     * After this call, SM2 may be re-initialized via soundManager.beginDelayedInit().\r\n     * @return {object} soundManager The soundManager instance.\r\n     */\r\n\r\n    _wDS('reset');\r\n\r\n    return sm2.reboot(true, true);\r\n\r\n  };\r\n\r\n  /**\r\n   * Undocumented: Determines the SM2 flash movie's load progress.\r\n   *\r\n   * @return {number or null} Percent loaded, or if invalid/unsupported, null.\r\n   */\r\n\r\n  this.getMoviePercent = function() {\r\n\r\n    /**\r\n     * Interesting syntax notes...\r\n     * Flash/ExternalInterface (ActiveX/NPAPI) bridge methods are not typeof \"function\" nor instanceof Function, but are still valid.\r\n     * Furthermore, using (flash && flash.PercentLoaded) causes IE to throw \"object doesn't support this property or method\".\r\n     * Thus, 'in' syntax must be used.\r\n     */\r\n\r\n    return (flash && 'PercentLoaded' in flash ? flash.PercentLoaded() : null);\r\n\r\n  };\r\n\r\n  /**\r\n   * Additional helper for manually invoking SM2's init process after DOM Ready / window.onload().\r\n   */\r\n\r\n  this.beginDelayedInit = function() {\r\n\r\n    windowLoaded = true;\r\n    domContentLoaded();\r\n\r\n    setTimeout(function() {\r\n\r\n      if (initPending) return false;\r\n\r\n      createMovie();\r\n      initMovie();\r\n      initPending = true;\r\n\r\n      return true;\r\n\r\n    }, 20);\r\n\r\n    delayWaitForEI();\r\n\r\n  };\r\n\r\n  /**\r\n   * Destroys the SoundManager instance and all SMSound instances.\r\n   */\r\n\r\n  this.destruct = function() {\r\n\r\n    sm2._wD(sm + '.destruct()');\r\n    sm2.disable(true);\r\n\r\n  };\r\n\r\n  /**\r\n   * SMSound() (sound object) constructor\r\n   * ------------------------------------\r\n   *\r\n   * @param {object} oOptions Sound options (id and url are required attributes)\r\n   * @return {SMSound} The new SMSound object\r\n   */\r\n\r\n  SMSound = function(oOptions) {\r\n\r\n    var s = this, resetProperties, add_html5_events, remove_html5_events, stop_html5_timer, start_html5_timer, attachOnPosition, onplay_called = false, onPositionItems = [], onPositionFired = 0, detachOnPosition, applyFromTo, lastURL = null, lastHTML5State, urlOmitted;\r\n\r\n    lastHTML5State = {\r\n      // tracks duration + position (time)\r\n      duration: null,\r\n      time: null\r\n    };\r\n\r\n    this.id = oOptions.id;\r\n\r\n    // legacy\r\n    this.sID = this.id;\r\n\r\n    this.url = oOptions.url;\r\n    this.options = mixin(oOptions);\r\n\r\n    // per-play-instance-specific options\r\n    this.instanceOptions = this.options;\r\n\r\n    // short alias\r\n    this._iO = this.instanceOptions;\r\n\r\n    // assign property defaults\r\n    this.pan = this.options.pan;\r\n    this.volume = this.options.volume;\r\n\r\n    // whether or not this object is using HTML5\r\n    this.isHTML5 = false;\r\n\r\n    // internal HTML5 Audio() object reference\r\n    this._a = null;\r\n\r\n    // for flash 8 special-case createSound() without url, followed by load/play with url case\r\n    urlOmitted = (!this.url);\r\n\r\n    /**\r\n     * SMSound() public methods\r\n     * ------------------------\r\n     */\r\n\r\n    this.id3 = {};\r\n\r\n    /**\r\n     * Writes SMSound object parameters to debug console\r\n     */\r\n\r\n    this._debug = function() {\r\n\r\n      // <d>\r\n      sm2._wD(s.id + ': Merged options:', s.options);\r\n      // </d>\r\n\r\n    };\r\n\r\n    /**\r\n     * Begins loading a sound per its *url*.\r\n     *\r\n     * @param {object} options Optional: Sound options\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.load = function(options) {\r\n\r\n      var oSound = null, instanceOptions;\r\n\r\n      if (options !== _undefined) {\r\n        s._iO = mixin(options, s.options);\r\n      } else {\r\n        options = s.options;\r\n        s._iO = options;\r\n        if (lastURL && lastURL !== s.url) {\r\n          _wDS('manURL');\r\n          s._iO.url = s.url;\r\n          s.url = null;\r\n        }\r\n      }\r\n\r\n      if (!s._iO.url) {\r\n        s._iO.url = s.url;\r\n      }\r\n\r\n      s._iO.url = parseURL(s._iO.url);\r\n\r\n      // ensure we're in sync\r\n      s.instanceOptions = s._iO;\r\n\r\n      // local shortcut\r\n      instanceOptions = s._iO;\r\n\r\n      sm2._wD(s.id + ': load (' + instanceOptions.url + ')');\r\n\r\n      if (!instanceOptions.url && !s.url) {\r\n        sm2._wD(s.id + ': load(): url is unassigned. Exiting.', 2);\r\n        return s;\r\n      }\r\n\r\n      // <d>\r\n      if (!s.isHTML5 && fV === 8 && !s.url && !instanceOptions.autoPlay) {\r\n        // flash 8 load() -> play() won't work before onload has fired.\r\n        sm2._wD(s.id + ': Flash 8 load() limitation: Wait for onload() before calling play().', 1);\r\n      }\r\n      // </d>\r\n\r\n      if (instanceOptions.url === s.url && s.readyState !== 0 && s.readyState !== 2) {\r\n        _wDS('onURL', 1);\r\n        // if loaded and an onload() exists, fire immediately.\r\n        if (s.readyState === 3 && instanceOptions.onload) {\r\n          // assume success based on truthy duration.\r\n          wrapCallback(s, function() {\r\n            instanceOptions.onload.apply(s, [(!!s.duration)]);\r\n          });\r\n        }\r\n        return s;\r\n      }\r\n\r\n      // reset a few state properties\r\n\r\n      s.loaded = false;\r\n      s.readyState = 1;\r\n      s.playState = 0;\r\n      s.id3 = {};\r\n\r\n      // TODO: If switching from HTML5 -> flash (or vice versa), stop currently-playing audio.\r\n\r\n      if (html5OK(instanceOptions)) {\r\n\r\n        oSound = s._setup_html5(instanceOptions);\r\n\r\n        if (!oSound._called_load) {\r\n\r\n          s._html5_canplay = false;\r\n\r\n          // TODO: review called_load / html5_canplay logic\r\n\r\n          // if url provided directly to load(), assign it here.\r\n\r\n          if (s.url !== instanceOptions.url) {\r\n\r\n            sm2._wD(_wDS('manURL') + ': ' + instanceOptions.url);\r\n\r\n            s._a.src = instanceOptions.url;\r\n\r\n            // TODO: review / re-apply all relevant options (volume, loop, onposition etc.)\r\n\r\n            // reset position for new URL\r\n            s.setPosition(0);\r\n\r\n          }\r\n\r\n          // given explicit load call, try to preload.\r\n\r\n          // early HTML5 implementation (non-standard)\r\n          s._a.autobuffer = 'auto';\r\n\r\n          // standard property, values: none / metadata / auto\r\n          // reference: http://msdn.microsoft.com/en-us/library/ie/ff974759%28v=vs.85%29.aspx\r\n          s._a.preload = 'auto';\r\n\r\n          s._a._called_load = true;\r\n\r\n        } else {\r\n\r\n          sm2._wD(s.id + ': Ignoring request to load again');\r\n\r\n        }\r\n\r\n      } else {\r\n\r\n        if (sm2.html5Only) {\r\n          sm2._wD(s.id + ': No flash support. Exiting.');\r\n          return s;\r\n        }\r\n\r\n        if (s._iO.url && s._iO.url.match(/data:/i)) {\r\n          // data: URIs not supported by Flash, either.\r\n          sm2._wD(s.id + ': data: URIs not supported via Flash. Exiting.');\r\n          return s;\r\n        }\r\n\r\n        try {\r\n          s.isHTML5 = false;\r\n          s._iO = policyFix(loopFix(instanceOptions));\r\n          // if we have \"position\", disable auto-play as we'll be seeking to that position at onload().\r\n          if (s._iO.autoPlay && (s._iO.position || s._iO.from)) {\r\n            sm2._wD(s.id + ': Disabling autoPlay because of non-zero offset case');\r\n            s._iO.autoPlay = false;\r\n          }\r\n          // re-assign local shortcut\r\n          instanceOptions = s._iO;\r\n          if (fV === 8) {\r\n            flash._load(s.id, instanceOptions.url, instanceOptions.stream, instanceOptions.autoPlay, instanceOptions.usePolicyFile);\r\n          } else {\r\n            flash._load(s.id, instanceOptions.url, !!(instanceOptions.stream), !!(instanceOptions.autoPlay), instanceOptions.loops || 1, !!(instanceOptions.autoLoad), instanceOptions.usePolicyFile);\r\n          }\r\n        } catch(e) {\r\n          _wDS('smError', 2);\r\n          debugTS('onload', false);\r\n          catchError({\r\n            type: 'SMSOUND_LOAD_JS_EXCEPTION',\r\n            fatal: true\r\n          });\r\n        }\r\n\r\n      }\r\n\r\n      // after all of this, ensure sound url is up to date.\r\n      s.url = instanceOptions.url;\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Unloads a sound, canceling any open HTTP requests.\r\n     *\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.unload = function() {\r\n\r\n      // Flash 8/AS2 can't \"close\" a stream - fake it by loading an empty URL\r\n      // Flash 9/AS3: Close stream, preventing further load\r\n      // HTML5: Most UAs will use empty URL\r\n\r\n      if (s.readyState !== 0) {\r\n\r\n        sm2._wD(s.id + ': unload()');\r\n\r\n        if (!s.isHTML5) {\r\n\r\n          if (fV === 8) {\r\n            flash._unload(s.id, emptyURL);\r\n          } else {\r\n            flash._unload(s.id);\r\n          }\r\n\r\n        } else {\r\n\r\n          stop_html5_timer();\r\n\r\n          if (s._a) {\r\n\r\n            s._a.pause();\r\n\r\n            // update empty URL, too\r\n            lastURL = html5Unload(s._a);\r\n\r\n          }\r\n\r\n        }\r\n\r\n        // reset load/status flags\r\n        resetProperties();\r\n\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Unloads and destroys a sound.\r\n     */\r\n\r\n    this.destruct = function(_bFromSM) {\r\n\r\n      sm2._wD(s.id + ': Destruct');\r\n\r\n      if (!s.isHTML5) {\r\n\r\n        // kill sound within Flash\r\n        // Disable the onfailure handler\r\n        s._iO.onfailure = null;\r\n        flash._destroySound(s.id);\r\n\r\n      } else {\r\n\r\n        stop_html5_timer();\r\n\r\n        if (s._a) {\r\n          s._a.pause();\r\n          html5Unload(s._a);\r\n          if (!useGlobalHTML5Audio) {\r\n            remove_html5_events();\r\n          }\r\n          // break obvious circular reference\r\n          s._a._s = null;\r\n          s._a = null;\r\n        }\r\n\r\n      }\r\n\r\n      if (!_bFromSM) {\r\n        // ensure deletion from controller\r\n        sm2.destroySound(s.id, true);\r\n      }\r\n\r\n    };\r\n\r\n    /**\r\n     * Begins playing a sound.\r\n     *\r\n     * @param {object} options Optional: Sound options\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.play = function(options, _updatePlayState) {\r\n\r\n      var fN, allowMulti, a, onready,\r\n          audioClone, onended, oncanplay,\r\n          startOK = true;\r\n\r\n      // <d>\r\n      fN = s.id + ': play(): ';\r\n      // </d>\r\n\r\n      // default to true\r\n      _updatePlayState = (_updatePlayState === _undefined ? true : _updatePlayState);\r\n\r\n      if (!options) {\r\n        options = {};\r\n      }\r\n\r\n      // first, use local URL (if specified)\r\n      if (s.url) {\r\n        s._iO.url = s.url;\r\n      }\r\n\r\n      // mix in any options defined at createSound()\r\n      s._iO = mixin(s._iO, s.options);\r\n\r\n      // mix in any options specific to this method\r\n      s._iO = mixin(options, s._iO);\r\n\r\n      s._iO.url = parseURL(s._iO.url);\r\n\r\n      s.instanceOptions = s._iO;\r\n\r\n      // RTMP-only\r\n      if (!s.isHTML5 && s._iO.serverURL && !s.connected) {\r\n        if (!s.getAutoPlay()) {\r\n          sm2._wD(fN + ' Netstream not connected yet - setting autoPlay');\r\n          s.setAutoPlay(true);\r\n        }\r\n        // play will be called in onconnect()\r\n        return s;\r\n      }\r\n\r\n      if (html5OK(s._iO)) {\r\n        s._setup_html5(s._iO);\r\n        start_html5_timer();\r\n      }\r\n\r\n      if (s.playState === 1 && !s.paused) {\r\n\r\n        allowMulti = s._iO.multiShot;\r\n\r\n        if (!allowMulti) {\r\n\r\n          sm2._wD(fN + 'Already playing (one-shot)', 1);\r\n\r\n          if (s.isHTML5) {\r\n            // go back to original position.\r\n            s.setPosition(s._iO.position);\r\n          }\r\n\r\n          return s;\r\n\r\n        }\r\n\r\n        sm2._wD(fN + 'Already playing (multi-shot)', 1);\r\n\r\n      }\r\n\r\n      // edge case: play() with explicit URL parameter\r\n      if (options.url && options.url !== s.url) {\r\n\r\n        // special case for createSound() followed by load() / play() with url; avoid double-load case.\r\n        if (!s.readyState && !s.isHTML5 && fV === 8 && urlOmitted) {\r\n\r\n          urlOmitted = false;\r\n\r\n        } else {\r\n\r\n          // load using merged options\r\n          s.load(s._iO);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (!s.loaded) {\r\n\r\n        if (s.readyState === 0) {\r\n\r\n          sm2._wD(fN + 'Attempting to load');\r\n\r\n          // try to get this sound playing ASAP\r\n          if (!s.isHTML5 && !sm2.html5Only) {\r\n\r\n            // flash: assign directly because setAutoPlay() increments the instanceCount\r\n            s._iO.autoPlay = true;\r\n            s.load(s._iO);\r\n\r\n          } else if (s.isHTML5) {\r\n\r\n            // iOS needs this when recycling sounds, loading a new URL on an existing object.\r\n            s.load(s._iO);\r\n\r\n          } else {\r\n\r\n            sm2._wD(fN + 'Unsupported type. Exiting.');\r\n\r\n            return s;\r\n\r\n          }\r\n\r\n          // HTML5 hack - re-set instanceOptions?\r\n          s.instanceOptions = s._iO;\r\n\r\n        } else if (s.readyState === 2) {\r\n\r\n          sm2._wD(fN + 'Could not load - exiting', 2);\r\n\r\n          return s;\r\n\r\n        } else {\r\n\r\n          sm2._wD(fN + 'Loading - attempting to play...');\r\n\r\n        }\r\n\r\n      } else {\r\n\r\n        // \"play()\"\r\n        sm2._wD(fN.substr(0, fN.lastIndexOf(':')));\r\n\r\n      }\r\n\r\n      if (!s.isHTML5 && fV === 9 && s.position > 0 && s.position === s.duration) {\r\n        // flash 9 needs a position reset if play() is called while at the end of a sound.\r\n        sm2._wD(fN + 'Sound at end, resetting to position: 0');\r\n        options.position = 0;\r\n      }\r\n\r\n      /**\r\n       * Streams will pause when their buffer is full if they are being loaded.\r\n       * In this case paused is true, but the song hasn't started playing yet.\r\n       * If we just call resume() the onplay() callback will never be called.\r\n       * So only call resume() if the position is > 0.\r\n       * Another reason is because options like volume won't have been applied yet.\r\n       * For normal sounds, just resume.\r\n       */\r\n\r\n      if (s.paused && s.position >= 0 && (!s._iO.serverURL || s.position > 0)) {\r\n\r\n        // https://gist.github.com/37b17df75cc4d7a90bf6\r\n        sm2._wD(fN + 'Resuming from paused state', 1);\r\n        s.resume();\r\n\r\n      } else {\r\n\r\n        s._iO = mixin(options, s._iO);\r\n\r\n        /**\r\n         * Preload in the event of play() with position under Flash,\r\n         * or from/to parameters and non-RTMP case\r\n         */\r\n        if (((!s.isHTML5 && s._iO.position !== null && s._iO.position > 0) || (s._iO.from !== null && s._iO.from > 0) || s._iO.to !== null) && s.instanceCount === 0 && s.playState === 0 && !s._iO.serverURL) {\r\n\r\n          onready = function() {\r\n            // sound \"canplay\" or onload()\r\n            // re-apply position/from/to to instance options, and start playback\r\n            s._iO = mixin(options, s._iO);\r\n            s.play(s._iO);\r\n          };\r\n\r\n          // HTML5 needs to at least have \"canplay\" fired before seeking.\r\n          if (s.isHTML5 && !s._html5_canplay) {\r\n\r\n            // this hasn't been loaded yet. load it first, and then do this again.\r\n            sm2._wD(fN + 'Beginning load for non-zero offset case');\r\n\r\n            s.load({\r\n              // note: custom HTML5-only event added for from/to implementation.\r\n              _oncanplay: onready\r\n            });\r\n\r\n          } else if (!s.isHTML5 && !s.loaded && (!s.readyState || s.readyState !== 2)) {\r\n\r\n            // to be safe, preload the whole thing in Flash.\r\n\r\n            sm2._wD(fN + 'Preloading for non-zero offset case');\r\n\r\n            s.load({\r\n              onload: onready\r\n            });\r\n\r\n          }\r\n\r\n          // otherwise, we're ready to go. re-apply local options, and continue\r\n\r\n          s._iO = applyFromTo();\r\n\r\n        }\r\n\r\n        // sm2._wD(fN + 'Starting to play');\r\n\r\n        // increment instance counter, where enabled + supported\r\n        if (!s.instanceCount || s._iO.multiShotEvents || (s.isHTML5 && s._iO.multiShot && !useGlobalHTML5Audio) || (!s.isHTML5 && fV > 8 && !s.getAutoPlay())) {\r\n          s.instanceCount++;\r\n        }\r\n\r\n        // if first play and onposition parameters exist, apply them now\r\n        if (s._iO.onposition && s.playState === 0) {\r\n          attachOnPosition(s);\r\n        }\r\n\r\n        s.playState = 1;\r\n        s.paused = false;\r\n\r\n        s.position = (s._iO.position !== _undefined && !isNaN(s._iO.position) ? s._iO.position : 0);\r\n\r\n        if (!s.isHTML5) {\r\n          s._iO = policyFix(loopFix(s._iO));\r\n        }\r\n\r\n        if (s._iO.onplay && _updatePlayState) {\r\n          s._iO.onplay.apply(s);\r\n          onplay_called = true;\r\n        }\r\n\r\n        s.setVolume(s._iO.volume, true);\r\n        s.setPan(s._iO.pan, true);\r\n\r\n        if (s._iO.playbackRate !== 1) {\r\n          s.setPlaybackRate(s._iO.playbackRate);\r\n        }\r\n\r\n        if (!s.isHTML5) {\r\n\r\n          startOK = flash._start(s.id, s._iO.loops || 1, (fV === 9 ? s.position : s.position / msecScale), s._iO.multiShot || false);\r\n\r\n          if (fV === 9 && !startOK) {\r\n            // edge case: no sound hardware, or 32-channel flash ceiling hit.\r\n            // applies only to Flash 9, non-NetStream/MovieStar sounds.\r\n            // http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/media/Sound.html#play%28%29\r\n            sm2._wD(fN + 'No sound hardware, or 32-sound ceiling hit', 2);\r\n            if (s._iO.onplayerror) {\r\n              s._iO.onplayerror.apply(s);\r\n            }\r\n\r\n          }\r\n\r\n        } else if (s.instanceCount < 2) {\r\n\r\n            // HTML5 single-instance case\r\n\r\n            start_html5_timer();\r\n\r\n            a = s._setup_html5();\r\n\r\n            s.setPosition(s._iO.position);\r\n\r\n            a.play();\r\n\r\n          } else {\r\n\r\n            // HTML5 multi-shot case\r\n\r\n            sm2._wD(s.id + ': Cloning Audio() for instance #' + s.instanceCount + '...');\r\n\r\n            audioClone = new Audio(s._iO.url);\r\n\r\n            onended = function() {\r\n              event.remove(audioClone, 'ended', onended);\r\n              s._onfinish(s);\r\n              // cleanup\r\n              html5Unload(audioClone);\r\n              audioClone = null;\r\n            };\r\n\r\n            oncanplay = function() {\r\n              event.remove(audioClone, 'canplay', oncanplay);\r\n              try {\r\n                audioClone.currentTime = s._iO.position / msecScale;\r\n              } catch(err) {\r\n                complain(s.id + ': multiShot play() failed to apply position of ' + (s._iO.position / msecScale));\r\n              }\r\n              audioClone.play();\r\n            };\r\n\r\n            event.add(audioClone, 'ended', onended);\r\n\r\n            // apply volume to clones, too\r\n            if (s._iO.volume !== _undefined) {\r\n              audioClone.volume = Math.max(0, Math.min(1, s._iO.volume / 100));\r\n            }\r\n\r\n            // playing multiple muted sounds? if you do this, you're weird ;) - but let's cover it.\r\n            if (s.muted) {\r\n              audioClone.muted = true;\r\n            }\r\n\r\n            if (s._iO.position) {\r\n              // HTML5 audio can't seek before onplay() event has fired.\r\n              // wait for canplay, then seek to position and start playback.\r\n              event.add(audioClone, 'canplay', oncanplay);\r\n            } else {\r\n              // begin playback at currentTime: 0\r\n              audioClone.play();\r\n            }\r\n\r\n          }\r\n\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    // just for convenience\r\n    this.start = this.play;\r\n\r\n    /**\r\n     * Stops playing a sound (and optionally, all sounds)\r\n     *\r\n     * @param {boolean} bAll Optional: Whether to stop all sounds\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.stop = function(bAll) {\r\n\r\n      var instanceOptions = s._iO,\r\n          originalPosition;\r\n\r\n      if (s.playState === 1) {\r\n\r\n        sm2._wD(s.id + ': stop()');\r\n\r\n        s._onbufferchange(0);\r\n        s._resetOnPosition(0);\r\n        s.paused = false;\r\n\r\n        if (!s.isHTML5) {\r\n          s.playState = 0;\r\n        }\r\n\r\n        // remove onPosition listeners, if any\r\n        detachOnPosition();\r\n\r\n        // and \"to\" position, if set\r\n        if (instanceOptions.to) {\r\n          s.clearOnPosition(instanceOptions.to);\r\n        }\r\n\r\n        if (!s.isHTML5) {\r\n\r\n          flash._stop(s.id, bAll);\r\n\r\n          // hack for netStream: just unload\r\n          if (instanceOptions.serverURL) {\r\n            s.unload();\r\n          }\r\n\r\n        } else if (s._a) {\r\n\r\n            originalPosition = s.position;\r\n\r\n            // act like Flash, though\r\n            s.setPosition(0);\r\n\r\n            // hack: reflect old position for onstop() (also like Flash)\r\n            s.position = originalPosition;\r\n\r\n            // html5 has no stop()\r\n            // NOTE: pausing means iOS requires interaction to resume.\r\n            s._a.pause();\r\n\r\n            s.playState = 0;\r\n\r\n            // and update UI\r\n            s._onTimer();\r\n\r\n            stop_html5_timer();\r\n\r\n          }\r\n\r\n        s.instanceCount = 0;\r\n        s._iO = {};\r\n\r\n        if (instanceOptions.onstop) {\r\n          instanceOptions.onstop.apply(s);\r\n        }\r\n\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Undocumented/internal: Sets autoPlay for RTMP.\r\n     *\r\n     * @param {boolean} autoPlay state\r\n     */\r\n\r\n    this.setAutoPlay = function(autoPlay) {\r\n\r\n      sm2._wD(s.id + ': Autoplay turned ' + (autoPlay ? 'on' : 'off'));\r\n      s._iO.autoPlay = autoPlay;\r\n\r\n      if (!s.isHTML5) {\r\n        flash._setAutoPlay(s.id, autoPlay);\r\n        if (autoPlay) {\r\n          // only increment the instanceCount if the sound isn't loaded (TODO: verify RTMP)\r\n          if (!s.instanceCount && s.readyState === 1) {\r\n            s.instanceCount++;\r\n            sm2._wD(s.id + ': Incremented instance count to ' + s.instanceCount);\r\n          }\r\n        }\r\n      }\r\n\r\n    };\r\n\r\n    /**\r\n     * Undocumented/internal: Returns the autoPlay boolean.\r\n     *\r\n     * @return {boolean} The current autoPlay value\r\n     */\r\n\r\n    this.getAutoPlay = function() {\r\n\r\n      return s._iO.autoPlay;\r\n\r\n    };\r\n\r\n    /**\r\n     * Sets the playback rate of a sound (HTML5-only.)\r\n     *\r\n     * @param {number} playbackRate (+/-)\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.setPlaybackRate = function(playbackRate) {\r\n\r\n      // Per Mozilla, limit acceptable values to prevent playback from stopping (unless allowOverride is truthy.)\r\n      // https://developer.mozilla.org/en-US/Apps/Build/Audio_and_video_delivery/WebAudio_playbackRate_explained\r\n      var normalizedRate = Math.max(0.5, Math.min(4, playbackRate));\r\n\r\n      // <d>\r\n      if (normalizedRate !== playbackRate) {\r\n        sm2._wD(s.id + ': setPlaybackRate(' + playbackRate + '): limiting rate to ' + normalizedRate, 2);\r\n      }\r\n      // </d>\r\n\r\n      if (s.isHTML5) {\r\n        try {\r\n          s._iO.playbackRate = normalizedRate;\r\n          s._a.playbackRate = normalizedRate;\r\n        } catch(e) {\r\n          sm2._wD(s.id + ': setPlaybackRate(' + normalizedRate + ') failed: ' + e.message, 2);\r\n        }\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Sets the position of a sound.\r\n     *\r\n     * @param {number} nMsecOffset Position (milliseconds)\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.setPosition = function(nMsecOffset) {\r\n\r\n      if (nMsecOffset === _undefined) {\r\n        nMsecOffset = 0;\r\n      }\r\n\r\n      var position, position1K,\r\n          // Use the duration from the instance options, if we don't have a track duration yet.\r\n          // position >= 0 and <= current available (loaded) duration\r\n          offset = (s.isHTML5 ? Math.max(nMsecOffset, 0) : Math.min(s.duration || s._iO.duration, Math.max(nMsecOffset, 0)));\r\n\r\n      s.position = offset;\r\n      position1K = s.position / msecScale;\r\n      s._resetOnPosition(s.position);\r\n      s._iO.position = offset;\r\n\r\n      if (!s.isHTML5) {\r\n\r\n        position = (fV === 9 ? s.position : position1K);\r\n\r\n        if (s.readyState && s.readyState !== 2) {\r\n          // if paused or not playing, will not resume (by playing)\r\n          flash._setPosition(s.id, position, (s.paused || !s.playState), s._iO.multiShot);\r\n        }\r\n\r\n      } else if (s._a) {\r\n\r\n        // Set the position in the canplay handler if the sound is not ready yet\r\n        if (s._html5_canplay) {\r\n\r\n          if (s._a.currentTime.toFixed(3) !== position1K.toFixed(3)) {\r\n\r\n            /**\r\n             * DOM/JS errors/exceptions to watch out for:\r\n             * if seek is beyond (loaded?) position, \"DOM exception 11\"\r\n             * \"INDEX_SIZE_ERR\": DOM exception 1\r\n             */\r\n            sm2._wD(s.id + ': setPosition(' + position1K + ')');\r\n\r\n            try {\r\n              s._a.currentTime = position1K;\r\n              if (s.playState === 0 || s.paused) {\r\n                // allow seek without auto-play/resume\r\n                s._a.pause();\r\n              }\r\n            } catch(e) {\r\n              sm2._wD(s.id + ': setPosition(' + position1K + ') failed: ' + e.message, 2);\r\n            }\r\n\r\n          }\r\n\r\n        } else if (position1K) {\r\n\r\n          // warn on non-zero seek attempts\r\n          sm2._wD(s.id + ': setPosition(' + position1K + '): Cannot seek yet, sound not ready', 2);\r\n          return s;\r\n\r\n        }\r\n\r\n        if (s.paused) {\r\n\r\n          // if paused, refresh UI right away by forcing update\r\n          s._onTimer(true);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Pauses sound playback.\r\n     *\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.pause = function(_bCallFlash) {\r\n\r\n      if (s.paused || (s.playState === 0 && s.readyState !== 1)) return s;\r\n\r\n      sm2._wD(s.id + ': pause()');\r\n      s.paused = true;\r\n\r\n      if (!s.isHTML5) {\r\n        if (_bCallFlash || _bCallFlash === _undefined) {\r\n          flash._pause(s.id, s._iO.multiShot);\r\n        }\r\n      } else {\r\n        s._setup_html5().pause();\r\n        stop_html5_timer();\r\n      }\r\n\r\n      if (s._iO.onpause) {\r\n        s._iO.onpause.apply(s);\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Resumes sound playback.\r\n     *\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    /**\r\n     * When auto-loaded streams pause on buffer full they have a playState of 0.\r\n     * We need to make sure that the playState is set to 1 when these streams \"resume\".\r\n     * When a paused stream is resumed, we need to trigger the onplay() callback if it\r\n     * hasn't been called already. In this case since the sound is being played for the\r\n     * first time, I think it's more appropriate to call onplay() rather than onresume().\r\n     */\r\n\r\n    this.resume = function() {\r\n\r\n      var instanceOptions = s._iO;\r\n\r\n      if (!s.paused) return s;\r\n\r\n      sm2._wD(s.id + ': resume()');\r\n      s.paused = false;\r\n      s.playState = 1;\r\n\r\n      if (!s.isHTML5) {\r\n\r\n        if (instanceOptions.isMovieStar && !instanceOptions.serverURL) {\r\n          // Bizarre Webkit bug (Chrome reported via 8tracks.com dudes): AAC content paused for 30+ seconds(?) will not resume without a reposition.\r\n          s.setPosition(s.position);\r\n        }\r\n\r\n        // flash method is toggle-based (pause/resume)\r\n        flash._pause(s.id, instanceOptions.multiShot);\r\n\r\n      } else {\r\n\r\n        s._setup_html5().play();\r\n        start_html5_timer();\r\n\r\n      }\r\n\r\n      if (!onplay_called && instanceOptions.onplay) {\r\n\r\n        instanceOptions.onplay.apply(s);\r\n        onplay_called = true;\r\n\r\n      } else if (instanceOptions.onresume) {\r\n\r\n        instanceOptions.onresume.apply(s);\r\n\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Toggles sound playback.\r\n     *\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.togglePause = function() {\r\n\r\n      sm2._wD(s.id + ': togglePause()');\r\n\r\n      if (s.playState === 0) {\r\n        s.play({\r\n          position: (fV === 9 && !s.isHTML5 ? s.position : s.position / msecScale)\r\n        });\r\n        return s;\r\n      }\r\n\r\n      if (s.paused) {\r\n        s.resume();\r\n      } else {\r\n        s.pause();\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Sets the panning (L-R) effect.\r\n     *\r\n     * @param {number} nPan The pan value (-100 to 100)\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.setPan = function(nPan, bInstanceOnly) {\r\n\r\n      if (nPan === _undefined) {\r\n        nPan = 0;\r\n      }\r\n\r\n      if (bInstanceOnly === _undefined) {\r\n        bInstanceOnly = false;\r\n      }\r\n\r\n      if (!s.isHTML5) {\r\n        flash._setPan(s.id, nPan);\r\n      } // else { no HTML5 pan? }\r\n\r\n      s._iO.pan = nPan;\r\n\r\n      if (!bInstanceOnly) {\r\n        s.pan = nPan;\r\n        s.options.pan = nPan;\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Sets the volume.\r\n     *\r\n     * @param {number} nVol The volume value (0 to 100)\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.setVolume = function(nVol, _bInstanceOnly) {\r\n\r\n      /**\r\n       * Note: Setting volume has no effect on iOS \"special snowflake\" devices.\r\n       * Hardware volume control overrides software, and volume\r\n       * will always return 1 per Apple docs. (iOS 4 + 5.)\r\n       * http://developer.apple.com/library/safari/documentation/AudioVideo/Conceptual/HTML-canvas-guide/AddingSoundtoCanvasAnimations/AddingSoundtoCanvasAnimations.html\r\n       */\r\n\r\n      if (nVol === _undefined) {\r\n        nVol = 100;\r\n      }\r\n\r\n      if (_bInstanceOnly === _undefined) {\r\n        _bInstanceOnly = false;\r\n      }\r\n\r\n      if (!s.isHTML5) {\r\n\r\n        flash._setVolume(s.id, (sm2.muted && !s.muted) || s.muted ? 0 : nVol);\r\n\r\n      } else if (s._a) {\r\n\r\n        if (sm2.muted && !s.muted) {\r\n          s.muted = true;\r\n          s._a.muted = true;\r\n        }\r\n\r\n        // valid range for native HTML5 Audio(): 0-1\r\n        s._a.volume = Math.max(0, Math.min(1, nVol / 100));\r\n\r\n      }\r\n\r\n      s._iO.volume = nVol;\r\n\r\n      if (!_bInstanceOnly) {\r\n        s.volume = nVol;\r\n        s.options.volume = nVol;\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Mutes the sound.\r\n     *\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.mute = function() {\r\n\r\n      s.muted = true;\r\n\r\n      if (!s.isHTML5) {\r\n        flash._setVolume(s.id, 0);\r\n      } else if (s._a) {\r\n        s._a.muted = true;\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Unmutes the sound.\r\n     *\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.unmute = function() {\r\n\r\n      s.muted = false;\r\n      var hasIO = (s._iO.volume !== _undefined);\r\n\r\n      if (!s.isHTML5) {\r\n        flash._setVolume(s.id, hasIO ? s._iO.volume : s.options.volume);\r\n      } else if (s._a) {\r\n        s._a.muted = false;\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Toggles the muted state of a sound.\r\n     *\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.toggleMute = function() {\r\n\r\n      return (s.muted ? s.unmute() : s.mute());\r\n\r\n    };\r\n\r\n    /**\r\n     * Registers a callback to be fired when a sound reaches a given position during playback.\r\n     *\r\n     * @param {number} nPosition The position to watch for\r\n     * @param {function} oMethod The relevant callback to fire\r\n     * @param {object} oScope Optional: The scope to apply the callback to\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.onPosition = function(nPosition, oMethod, oScope) {\r\n\r\n      // TODO: basic dupe checking?\r\n\r\n      onPositionItems.push({\r\n        position: parseInt(nPosition, 10),\r\n        method: oMethod,\r\n        scope: (oScope !== _undefined ? oScope : s),\r\n        fired: false\r\n      });\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    // legacy/backwards-compability: lower-case method name\r\n    this.onposition = this.onPosition;\r\n\r\n    /**\r\n     * Removes registered callback(s) from a sound, by position and/or callback.\r\n     *\r\n     * @param {number} nPosition The position to clear callback(s) for\r\n     * @param {function} oMethod Optional: Identify one callback to be removed when multiple listeners exist for one position\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.clearOnPosition = function(nPosition, oMethod) {\r\n\r\n      var i;\r\n\r\n      nPosition = parseInt(nPosition, 10);\r\n\r\n      if (isNaN(nPosition)) {\r\n        // safety check\r\n        return;\r\n      }\r\n\r\n      for (i = 0; i < onPositionItems.length; i++) {\r\n\r\n        if (nPosition === onPositionItems[i].position) {\r\n          // remove this item if no method was specified, or, if the method matches\r\n\r\n          if (!oMethod || (oMethod === onPositionItems[i].method)) {\r\n\r\n            if (onPositionItems[i].fired) {\r\n              // decrement \"fired\" counter, too\r\n              onPositionFired--;\r\n            }\r\n\r\n            onPositionItems.splice(i, 1);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    };\r\n\r\n    this._processOnPosition = function() {\r\n\r\n      var i, item, j = onPositionItems.length;\r\n\r\n      if (!j || !s.playState || onPositionFired >= j) return false;\r\n\r\n      for (i = j - 1; i >= 0; i--) {\r\n\r\n        item = onPositionItems[i];\r\n\r\n        if (!item.fired && s.position >= item.position) {\r\n\r\n          item.fired = true;\r\n          onPositionFired++;\r\n          item.method.apply(item.scope, [item.position]);\r\n\r\n          //  reset j -- onPositionItems.length can be changed in the item callback above... occasionally breaking the loop.\r\n          j = onPositionItems.length;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return true;\r\n\r\n    };\r\n\r\n    this._resetOnPosition = function(nPosition) {\r\n\r\n      // reset \"fired\" for items interested in this position\r\n      var i, item, j = onPositionItems.length;\r\n\r\n      if (!j) return false;\r\n\r\n      for (i = j - 1; i >= 0; i--) {\r\n\r\n        item = onPositionItems[i];\r\n\r\n        if (item.fired && nPosition <= item.position) {\r\n          item.fired = false;\r\n          onPositionFired--;\r\n        }\r\n\r\n      }\r\n\r\n      return true;\r\n\r\n    };\r\n\r\n    /**\r\n     * SMSound() private internals\r\n     * --------------------------------\r\n     */\r\n\r\n    applyFromTo = function() {\r\n\r\n      var instanceOptions = s._iO,\r\n          f = instanceOptions.from,\r\n          t = instanceOptions.to,\r\n          start, end;\r\n\r\n      end = function() {\r\n\r\n        // end has been reached.\r\n        sm2._wD(s.id + ': \"To\" time of ' + t + ' reached.');\r\n\r\n        // detach listener\r\n        s.clearOnPosition(t, end);\r\n\r\n        // stop should clear this, too\r\n        s.stop();\r\n\r\n      };\r\n\r\n      start = function() {\r\n\r\n        sm2._wD(s.id + ': Playing \"from\" ' + f);\r\n\r\n        // add listener for end\r\n        if (t !== null && !isNaN(t)) {\r\n          s.onPosition(t, end);\r\n        }\r\n\r\n      };\r\n\r\n      if (f !== null && !isNaN(f)) {\r\n\r\n        // apply to instance options, guaranteeing correct start position.\r\n        instanceOptions.position = f;\r\n\r\n        // multiShot timing can't be tracked, so prevent that.\r\n        instanceOptions.multiShot = false;\r\n\r\n        start();\r\n\r\n      }\r\n\r\n      // return updated instanceOptions including starting position\r\n      return instanceOptions;\r\n\r\n    };\r\n\r\n    attachOnPosition = function() {\r\n\r\n      var item,\r\n          op = s._iO.onposition;\r\n\r\n      // attach onposition things, if any, now.\r\n\r\n      if (op) {\r\n\r\n        for (item in op) {\r\n          if (op.hasOwnProperty(item)) {\r\n            s.onPosition(parseInt(item, 10), op[item]);\r\n          }\r\n        }\r\n\r\n      }\r\n\r\n    };\r\n\r\n    detachOnPosition = function() {\r\n\r\n      var item,\r\n          op = s._iO.onposition;\r\n\r\n      // detach any onposition()-style listeners.\r\n\r\n      if (op) {\r\n\r\n        for (item in op) {\r\n          if (op.hasOwnProperty(item)) {\r\n            s.clearOnPosition(parseInt(item, 10));\r\n          }\r\n        }\r\n\r\n      }\r\n\r\n    };\r\n\r\n    start_html5_timer = function() {\r\n\r\n      if (s.isHTML5) {\r\n        startTimer(s);\r\n      }\r\n\r\n    };\r\n\r\n    stop_html5_timer = function() {\r\n\r\n      if (s.isHTML5) {\r\n        stopTimer(s);\r\n      }\r\n\r\n    };\r\n\r\n    resetProperties = function(retainPosition) {\r\n\r\n      if (!retainPosition) {\r\n        onPositionItems = [];\r\n        onPositionFired = 0;\r\n      }\r\n\r\n      onplay_called = false;\r\n\r\n      s._hasTimer = null;\r\n      s._a = null;\r\n      s._html5_canplay = false;\r\n      s.bytesLoaded = null;\r\n      s.bytesTotal = null;\r\n      s.duration = (s._iO && s._iO.duration ? s._iO.duration : null);\r\n      s.durationEstimate = null;\r\n      s.buffered = [];\r\n\r\n      // legacy: 1D array\r\n      s.eqData = [];\r\n\r\n      s.eqData.left = [];\r\n      s.eqData.right = [];\r\n\r\n      s.failures = 0;\r\n      s.isBuffering = false;\r\n      s.instanceOptions = {};\r\n      s.instanceCount = 0;\r\n      s.loaded = false;\r\n      s.metadata = {};\r\n\r\n      // 0 = uninitialised, 1 = loading, 2 = failed/error, 3 = loaded/success\r\n      s.readyState = 0;\r\n\r\n      s.muted = false;\r\n      s.paused = false;\r\n\r\n      s.peakData = {\r\n        left: 0,\r\n        right: 0\r\n      };\r\n\r\n      s.waveformData = {\r\n        left: [],\r\n        right: []\r\n      };\r\n\r\n      s.playState = 0;\r\n      s.position = null;\r\n\r\n      s.id3 = {};\r\n\r\n    };\r\n\r\n    resetProperties();\r\n\r\n    /**\r\n     * Pseudo-private SMSound internals\r\n     * --------------------------------\r\n     */\r\n\r\n    this._onTimer = function(bForce) {\r\n\r\n      /**\r\n       * HTML5-only _whileplaying() etc.\r\n       * called from both HTML5 native events, and polling/interval-based timers\r\n       * mimics flash and fires only when time/duration change, so as to be polling-friendly\r\n       */\r\n\r\n      var duration, isNew = false, time, x = {};\r\n\r\n      if (s._hasTimer || bForce) {\r\n\r\n        // TODO: May not need to track readyState (1 = loading)\r\n\r\n        if (s._a && (bForce || ((s.playState > 0 || s.readyState === 1) && !s.paused))) {\r\n\r\n          duration = s._get_html5_duration();\r\n\r\n          if (duration !== lastHTML5State.duration) {\r\n\r\n            lastHTML5State.duration = duration;\r\n            s.duration = duration;\r\n            isNew = true;\r\n\r\n          }\r\n\r\n          // TODO: investigate why this goes wack if not set/re-set each time.\r\n          s.durationEstimate = s.duration;\r\n\r\n          time = (s._a.currentTime * msecScale || 0);\r\n\r\n          if (time !== lastHTML5State.time) {\r\n\r\n            lastHTML5State.time = time;\r\n            isNew = true;\r\n\r\n          }\r\n\r\n          if (isNew || bForce) {\r\n\r\n            s._whileplaying(time, x, x, x, x);\r\n\r\n          }\r\n\r\n        }/* else {\r\n\r\n          // sm2._wD('_onTimer: Warn for \"'+s.id+'\": '+(!s._a?'Could not find element. ':'')+(s.playState === 0?'playState bad, 0?':'playState = '+s.playState+', OK'));\r\n\r\n          return false;\r\n\r\n        }*/\r\n\r\n      }\r\n\r\n      return isNew;\r\n\r\n    };\r\n\r\n    this._get_html5_duration = function() {\r\n\r\n      var instanceOptions = s._iO,\r\n          // if audio object exists, use its duration - else, instance option duration (if provided - it's a hack, really, and should be retired) OR null\r\n          d = (s._a && s._a.duration ? s._a.duration * msecScale : (instanceOptions && instanceOptions.duration ? instanceOptions.duration : null)),\r\n          result = (d && !isNaN(d) && d !== Infinity ? d : null);\r\n\r\n      return result;\r\n\r\n    };\r\n\r\n    this._apply_loop = function(a, nLoops) {\r\n\r\n      /**\r\n       * boolean instead of \"loop\", for webkit? - spec says string. http://www.w3.org/TR/html-markup/audio.html#audio.attrs.loop\r\n       * note that loop is either off or infinite under HTML5, unlike Flash which allows arbitrary loop counts to be specified.\r\n       */\r\n\r\n      // <d>\r\n      if (!a.loop && nLoops > 1) {\r\n        sm2._wD('Note: Native HTML5 looping is infinite.', 1);\r\n      }\r\n      // </d>\r\n\r\n      a.loop = (nLoops > 1 ? 'loop' : '');\r\n\r\n    };\r\n\r\n    this._setup_html5 = function(options) {\r\n\r\n      var instanceOptions = mixin(s._iO, options),\r\n          a = useGlobalHTML5Audio ? globalHTML5Audio : s._a,\r\n          dURL = decodeURI(instanceOptions.url),\r\n          sameURL;\r\n\r\n      /**\r\n       * \"First things first, I, Poppa...\" (reset the previous state of the old sound, if playing)\r\n       * Fixes case with devices that can only play one sound at a time\r\n       * Otherwise, other sounds in mid-play will be terminated without warning and in a stuck state\r\n       */\r\n\r\n      if (useGlobalHTML5Audio) {\r\n\r\n        if (dURL === decodeURI(lastGlobalHTML5URL)) {\r\n          // global HTML5 audio: re-use of URL\r\n          sameURL = true;\r\n        }\r\n\r\n      } else if (dURL === decodeURI(lastURL)) {\r\n\r\n        // options URL is the same as the \"last\" URL, and we used (loaded) it\r\n        sameURL = true;\r\n\r\n      }\r\n\r\n      if (a) {\r\n\r\n        if (a._s) {\r\n\r\n          if (useGlobalHTML5Audio) {\r\n\r\n            if (a._s && a._s.playState && !sameURL) {\r\n\r\n              // global HTML5 audio case, and loading a new URL. stop the currently-playing one.\r\n              a._s.stop();\r\n\r\n            }\r\n\r\n          } else if (!useGlobalHTML5Audio && dURL === decodeURI(lastURL)) {\r\n\r\n            // non-global HTML5 reuse case: same url, ignore request\r\n            s._apply_loop(a, instanceOptions.loops);\r\n\r\n            return a;\r\n\r\n          }\r\n\r\n        }\r\n\r\n        if (!sameURL) {\r\n\r\n          // don't retain onPosition() stuff with new URLs.\r\n\r\n          if (lastURL) {\r\n            resetProperties(false);\r\n          }\r\n\r\n          // assign new HTML5 URL\r\n\r\n          a.src = instanceOptions.url;\r\n\r\n          s.url = instanceOptions.url;\r\n\r\n          lastURL = instanceOptions.url;\r\n\r\n          lastGlobalHTML5URL = instanceOptions.url;\r\n\r\n          a._called_load = false;\r\n\r\n        }\r\n\r\n      } else {\r\n\r\n        if (instanceOptions.autoLoad || instanceOptions.autoPlay) {\r\n\r\n          s._a = new Audio(instanceOptions.url);\r\n          s._a.load();\r\n\r\n        } else {\r\n\r\n          // null for stupid Opera 9.64 case\r\n          s._a = (isOpera && opera.version() < 10 ? new Audio(null) : new Audio());\r\n\r\n        }\r\n\r\n        // assign local reference\r\n        a = s._a;\r\n\r\n        a._called_load = false;\r\n\r\n        if (useGlobalHTML5Audio) {\r\n\r\n          globalHTML5Audio = a;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      s.isHTML5 = true;\r\n\r\n      // store a ref on the track\r\n      s._a = a;\r\n\r\n      // store a ref on the audio\r\n      a._s = s;\r\n\r\n      add_html5_events();\r\n\r\n      s._apply_loop(a, instanceOptions.loops);\r\n\r\n      if (instanceOptions.autoLoad || instanceOptions.autoPlay) {\r\n\r\n        s.load();\r\n\r\n      } else {\r\n\r\n        // early HTML5 implementation (non-standard)\r\n        a.autobuffer = false;\r\n\r\n        // standard ('none' is also an option.)\r\n        a.preload = 'auto';\r\n\r\n      }\r\n\r\n      return a;\r\n\r\n    };\r\n\r\n    add_html5_events = function() {\r\n\r\n      if (s._a._added_events) return false;\r\n\r\n      var f;\r\n\r\n      function add(oEvt, oFn, bCapture) {\r\n        return s._a ? s._a.addEventListener(oEvt, oFn, bCapture || false) : null;\r\n      }\r\n\r\n      s._a._added_events = true;\r\n\r\n      for (f in html5_events) {\r\n        if (html5_events.hasOwnProperty(f)) {\r\n          add(f, html5_events[f]);\r\n        }\r\n      }\r\n\r\n      return true;\r\n\r\n    };\r\n\r\n    remove_html5_events = function() {\r\n\r\n      // Remove event listeners\r\n\r\n      var f;\r\n\r\n      function remove(oEvt, oFn, bCapture) {\r\n        return (s._a ? s._a.removeEventListener(oEvt, oFn, bCapture || false) : null);\r\n      }\r\n\r\n      sm2._wD(s.id + ': Removing event listeners');\r\n      s._a._added_events = false;\r\n\r\n      for (f in html5_events) {\r\n        if (html5_events.hasOwnProperty(f)) {\r\n          remove(f, html5_events[f]);\r\n        }\r\n      }\r\n\r\n    };\r\n\r\n    /**\r\n     * Pseudo-private event internals\r\n     * ------------------------------\r\n     */\r\n\r\n    this._onload = function(nSuccess) {\r\n\r\n      var fN,\r\n          // check for duration to prevent false positives from flash 8 when loading from cache.\r\n          loadOK = !!nSuccess || (!s.isHTML5 && fV === 8 && s.duration);\r\n\r\n      // <d>\r\n      fN = s.id + ': ';\r\n      sm2._wD(fN + (loadOK ? 'onload()' : 'Failed to load / invalid sound?' + (!s.duration ? ' Zero-length duration reported.' : ' -') + ' (' + s.url + ')'), (loadOK ? 1 : 2));\r\n\r\n      if (!loadOK && !s.isHTML5) {\r\n        if (sm2.sandbox.noRemote === true) {\r\n          sm2._wD(fN + str('noNet'), 1);\r\n        }\r\n        if (sm2.sandbox.noLocal === true) {\r\n          sm2._wD(fN + str('noLocal'), 1);\r\n        }\r\n      }\r\n      // </d>\r\n\r\n      s.loaded = loadOK;\r\n      s.readyState = (loadOK ? 3 : 2);\r\n      s._onbufferchange(0);\r\n\r\n      if (!loadOK && !s.isHTML5) {\r\n        // note: no error code from Flash.\r\n        s._onerror();\r\n      }\r\n\r\n      if (s._iO.onload) {\r\n        wrapCallback(s, function() {\r\n          s._iO.onload.apply(s, [loadOK]);\r\n        });\r\n      }\r\n\r\n      return true;\r\n\r\n    };\r\n\r\n    this._onerror = function(errorCode, description) {\r\n\r\n      // https://html.spec.whatwg.org/multipage/embedded-content.html#error-codes\r\n      if (s._iO.onerror) {\r\n        wrapCallback(s, function() {\r\n          s._iO.onerror.apply(s, [errorCode, description]);\r\n        });\r\n      }\r\n\r\n    };\r\n\r\n    this._onbufferchange = function(nIsBuffering) {\r\n\r\n      // ignore if not playing\r\n      if (s.playState === 0) return false;\r\n\r\n      if ((nIsBuffering && s.isBuffering) || (!nIsBuffering && !s.isBuffering)) return false;\r\n\r\n      s.isBuffering = (nIsBuffering === 1);\r\n\r\n      if (s._iO.onbufferchange) {\r\n        sm2._wD(s.id + ': Buffer state change: ' + nIsBuffering);\r\n        s._iO.onbufferchange.apply(s, [nIsBuffering]);\r\n      }\r\n\r\n      return true;\r\n\r\n    };\r\n\r\n    /**\r\n     * Playback may have stopped due to buffering, or related reason.\r\n     * This state can be encountered on iOS < 6 when auto-play is blocked.\r\n     */\r\n\r\n    this._onsuspend = function() {\r\n\r\n      if (s._iO.onsuspend) {\r\n        sm2._wD(s.id + ': Playback suspended');\r\n        s._iO.onsuspend.apply(s);\r\n      }\r\n\r\n      return true;\r\n\r\n    };\r\n\r\n    /**\r\n     * flash 9/movieStar + RTMP-only method, should fire only once at most\r\n     * at this point we just recreate failed sounds rather than trying to reconnect\r\n     */\r\n\r\n    this._onfailure = function(msg, level, code) {\r\n\r\n      s.failures++;\r\n      sm2._wD(s.id + ': Failure (' + s.failures + '): ' + msg);\r\n\r\n      if (s._iO.onfailure && s.failures === 1) {\r\n        s._iO.onfailure(msg, level, code);\r\n      } else {\r\n        sm2._wD(s.id + ': Ignoring failure');\r\n      }\r\n\r\n    };\r\n\r\n    /**\r\n     * flash 9/movieStar + RTMP-only method for unhandled warnings/exceptions from Flash\r\n     * e.g., RTMP \"method missing\" warning (non-fatal) for getStreamLength on server\r\n     */\r\n\r\n    this._onwarning = function(msg, level, code) {\r\n\r\n      if (s._iO.onwarning) {\r\n        s._iO.onwarning(msg, level, code);\r\n      }\r\n\r\n    };\r\n\r\n    this._onfinish = function() {\r\n\r\n      // store local copy before it gets trashed...\r\n      var io_onfinish = s._iO.onfinish;\r\n\r\n      s._onbufferchange(0);\r\n      s._resetOnPosition(0);\r\n\r\n      // reset some state items\r\n      if (s.instanceCount) {\r\n\r\n        s.instanceCount--;\r\n\r\n        if (!s.instanceCount) {\r\n\r\n          // remove onPosition listeners, if any\r\n          detachOnPosition();\r\n\r\n          // reset instance options\r\n          s.playState = 0;\r\n          s.paused = false;\r\n          s.instanceCount = 0;\r\n          s.instanceOptions = {};\r\n          s._iO = {};\r\n          stop_html5_timer();\r\n\r\n          // reset position, too\r\n          if (s.isHTML5) {\r\n            s.position = 0;\r\n          }\r\n\r\n        }\r\n\r\n        if (!s.instanceCount || s._iO.multiShotEvents) {\r\n          // fire onfinish for last, or every instance\r\n          if (io_onfinish) {\r\n            sm2._wD(s.id + ': onfinish()');\r\n            wrapCallback(s, function() {\r\n              io_onfinish.apply(s);\r\n            });\r\n          }\r\n        }\r\n\r\n      }\r\n\r\n    };\r\n\r\n    this._whileloading = function(nBytesLoaded, nBytesTotal, nDuration, nBufferLength) {\r\n\r\n      var instanceOptions = s._iO;\r\n\r\n      s.bytesLoaded = nBytesLoaded;\r\n      s.bytesTotal = nBytesTotal;\r\n      s.duration = Math.floor(nDuration);\r\n      s.bufferLength = nBufferLength;\r\n\r\n      if (!s.isHTML5 && !instanceOptions.isMovieStar) {\r\n\r\n        if (instanceOptions.duration) {\r\n          // use duration from options, if specified and larger. nobody should be specifying duration in options, actually, and it should be retired.\r\n          s.durationEstimate = (s.duration > instanceOptions.duration) ? s.duration : instanceOptions.duration;\r\n        } else {\r\n          s.durationEstimate = parseInt((s.bytesTotal / s.bytesLoaded) * s.duration, 10);\r\n        }\r\n\r\n      } else {\r\n\r\n        s.durationEstimate = s.duration;\r\n\r\n      }\r\n\r\n      // for flash, reflect sequential-load-style buffering\r\n      if (!s.isHTML5) {\r\n        s.buffered = [{\r\n          start: 0,\r\n          end: s.duration\r\n        }];\r\n      }\r\n\r\n      // allow whileloading to fire even if \"load\" fired under HTML5, due to HTTP range/partials\r\n      if ((s.readyState !== 3 || s.isHTML5) && instanceOptions.whileloading) {\r\n        instanceOptions.whileloading.apply(s);\r\n      }\r\n\r\n    };\r\n\r\n    this._whileplaying = function(nPosition, oPeakData, oWaveformDataLeft, oWaveformDataRight, oEQData) {\r\n\r\n      var instanceOptions = s._iO,\r\n          eqLeft;\r\n\r\n      // flash safety net\r\n      if (isNaN(nPosition) || nPosition === null) return false;\r\n\r\n      // Safari HTML5 play() may return small -ve values when starting from position: 0, eg. -50.120396875. Unexpected/invalid per W3, I think. Normalize to 0.\r\n      s.position = Math.max(0, nPosition);\r\n\r\n      s._processOnPosition();\r\n\r\n      if (!s.isHTML5 && fV > 8) {\r\n\r\n        if (instanceOptions.usePeakData && oPeakData !== _undefined && oPeakData) {\r\n          s.peakData = {\r\n            left: oPeakData.leftPeak,\r\n            right: oPeakData.rightPeak\r\n          };\r\n        }\r\n\r\n        if (instanceOptions.useWaveformData && oWaveformDataLeft !== _undefined && oWaveformDataLeft) {\r\n          s.waveformData = {\r\n            left: oWaveformDataLeft.split(','),\r\n            right: oWaveformDataRight.split(',')\r\n          };\r\n        }\r\n\r\n        if (instanceOptions.useEQData) {\r\n          if (oEQData !== _undefined && oEQData && oEQData.leftEQ) {\r\n            eqLeft = oEQData.leftEQ.split(',');\r\n            s.eqData = eqLeft;\r\n            s.eqData.left = eqLeft;\r\n            if (oEQData.rightEQ !== _undefined && oEQData.rightEQ) {\r\n              s.eqData.right = oEQData.rightEQ.split(',');\r\n            }\r\n          }\r\n        }\r\n\r\n      }\r\n\r\n      if (s.playState === 1) {\r\n\r\n        // special case/hack: ensure buffering is false if loading from cache (and not yet started)\r\n        if (!s.isHTML5 && fV === 8 && !s.position && s.isBuffering) {\r\n          s._onbufferchange(0);\r\n        }\r\n\r\n        if (instanceOptions.whileplaying) {\r\n          // flash may call after actual finish\r\n          instanceOptions.whileplaying.apply(s);\r\n        }\r\n\r\n      }\r\n\r\n      return true;\r\n\r\n    };\r\n\r\n    this._oncaptiondata = function(oData) {\r\n\r\n      /**\r\n       * internal: flash 9 + NetStream (MovieStar/RTMP-only) feature\r\n       *\r\n       * @param {object} oData\r\n       */\r\n\r\n      sm2._wD(s.id + ': Caption data received.');\r\n\r\n      s.captiondata = oData;\r\n\r\n      if (s._iO.oncaptiondata) {\r\n        s._iO.oncaptiondata.apply(s, [oData]);\r\n      }\r\n\r\n    };\r\n\r\n    this._onmetadata = function(oMDProps, oMDData) {\r\n\r\n      /**\r\n       * internal: flash 9 + NetStream (MovieStar/RTMP-only) feature\r\n       * RTMP may include song title, MovieStar content may include encoding info\r\n       *\r\n       * @param {array} oMDProps (names)\r\n       * @param {array} oMDData (values)\r\n       */\r\n\r\n      sm2._wD(s.id + ': Metadata received.');\r\n\r\n      var oData = {}, i, j;\r\n\r\n      for (i = 0, j = oMDProps.length; i < j; i++) {\r\n        oData[oMDProps[i]] = oMDData[i];\r\n      }\r\n\r\n      s.metadata = oData;\r\n\r\n      if (s._iO.onmetadata) {\r\n        s._iO.onmetadata.call(s, s.metadata);\r\n      }\r\n\r\n    };\r\n\r\n    this._onid3 = function(oID3Props, oID3Data) {\r\n\r\n      /**\r\n       * internal: flash 8 + flash 9 ID3 feature\r\n       * may include artist, song title etc.\r\n       *\r\n       * @param {array} oID3Props (names)\r\n       * @param {array} oID3Data (values)\r\n       */\r\n\r\n      sm2._wD(s.id + ': ID3 data received.');\r\n\r\n      var oData = [], i, j;\r\n\r\n      for (i = 0, j = oID3Props.length; i < j; i++) {\r\n        oData[oID3Props[i]] = oID3Data[i];\r\n      }\r\n\r\n      s.id3 = mixin(s.id3, oData);\r\n\r\n      if (s._iO.onid3) {\r\n        s._iO.onid3.apply(s);\r\n      }\r\n\r\n    };\r\n\r\n    // flash/RTMP-only\r\n\r\n    this._onconnect = function(bSuccess) {\r\n\r\n      bSuccess = (bSuccess === 1);\r\n      sm2._wD(s.id + ': ' + (bSuccess ? 'Connected.' : 'Failed to connect? - ' + s.url), (bSuccess ? 1 : 2));\r\n      s.connected = bSuccess;\r\n\r\n      if (bSuccess) {\r\n\r\n        s.failures = 0;\r\n\r\n        if (idCheck(s.id)) {\r\n          if (s.getAutoPlay()) {\r\n            // only update the play state if auto playing\r\n            s.play(_undefined, s.getAutoPlay());\r\n          } else if (s._iO.autoLoad) {\r\n            s.load();\r\n          }\r\n        }\r\n\r\n        if (s._iO.onconnect) {\r\n          s._iO.onconnect.apply(s, [bSuccess]);\r\n        }\r\n\r\n      }\r\n\r\n    };\r\n\r\n    this._ondataerror = function(sError) {\r\n\r\n      // flash 9 wave/eq data handler\r\n      // hack: called at start, and end from flash at/after onfinish()\r\n      if (s.playState > 0) {\r\n        sm2._wD(s.id + ': Data error: ' + sError);\r\n        if (s._iO.ondataerror) {\r\n          s._iO.ondataerror.apply(s);\r\n        }\r\n      }\r\n\r\n    };\r\n\r\n    // <d>\r\n    this._debug();\r\n    // </d>\r\n\r\n  }; // SMSound()\r\n\r\n  /**\r\n   * Private SoundManager internals\r\n   * ------------------------------\r\n   */\r\n\r\n  getDocument = function() {\r\n\r\n    return (doc.body || doc.getElementsByTagName('div')[0]);\r\n\r\n  };\r\n\r\n  id = function(sID) {\r\n\r\n    return doc.getElementById(sID);\r\n\r\n  };\r\n\r\n  mixin = function(oMain, oAdd) {\r\n\r\n    // non-destructive merge\r\n    var o1 = (oMain || {}), o2, o;\r\n\r\n    // if unspecified, o2 is the default options object\r\n    o2 = (oAdd === _undefined ? sm2.defaultOptions : oAdd);\r\n\r\n    for (o in o2) {\r\n\r\n      if (o2.hasOwnProperty(o) && o1[o] === _undefined) {\r\n\r\n        if (typeof o2[o] !== 'object' || o2[o] === null) {\r\n\r\n          // assign directly\r\n          o1[o] = o2[o];\r\n\r\n        } else {\r\n\r\n          // recurse through o2\r\n          o1[o] = mixin(o1[o], o2[o]);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return o1;\r\n\r\n  };\r\n\r\n  wrapCallback = function(oSound, callback) {\r\n\r\n    /**\r\n     * 03/03/2013: Fix for Flash Player 11.6.602.171 + Flash 8 (flashVersion = 8) SWF issue\r\n     * setTimeout() fix for certain SMSound callbacks like onload() and onfinish(), where subsequent calls like play() and load() fail when Flash Player 11.6.602.171 is installed, and using soundManager with flashVersion = 8 (which is the default).\r\n     * Not sure of exact cause. Suspect race condition and/or invalid (NaN-style) position argument trickling down to the next JS -> Flash _start() call, in the play() case.\r\n     * Fix: setTimeout() to yield, plus safer null / NaN checking on position argument provided to Flash.\r\n     * https://getsatisfaction.com/schillmania/topics/recent_chrome_update_seems_to_have_broken_my_sm2_audio_player\r\n     */\r\n    if (!oSound.isHTML5 && fV === 8) {\r\n      window.setTimeout(callback, 0);\r\n    } else {\r\n      callback();\r\n    }\r\n\r\n  };\r\n\r\n  // additional soundManager properties that soundManager.setup() will accept\r\n\r\n  extraOptions = {\r\n    onready: 1,\r\n    ontimeout: 1,\r\n    defaultOptions: 1,\r\n    flash9Options: 1,\r\n    movieStarOptions: 1\r\n  };\r\n\r\n  assign = function(o, oParent) {\r\n\r\n    /**\r\n     * recursive assignment of properties, soundManager.setup() helper\r\n     * allows property assignment based on whitelist\r\n     */\r\n\r\n    var i,\r\n        result = true,\r\n        hasParent = (oParent !== _undefined),\r\n        setupOptions = sm2.setupOptions,\r\n        bonusOptions = extraOptions;\r\n\r\n    // <d>\r\n\r\n    // if soundManager.setup() called, show accepted parameters.\r\n\r\n    if (o === _undefined) {\r\n\r\n      result = [];\r\n\r\n      for (i in setupOptions) {\r\n\r\n        if (setupOptions.hasOwnProperty(i)) {\r\n          result.push(i);\r\n        }\r\n\r\n      }\r\n\r\n      for (i in bonusOptions) {\r\n\r\n        if (bonusOptions.hasOwnProperty(i)) {\r\n\r\n          if (typeof sm2[i] === 'object') {\r\n            result.push(i + ': {...}');\r\n          } else if (sm2[i] instanceof Function) {\r\n            result.push(i + ': function() {...}');\r\n          } else {\r\n            result.push(i);\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n      sm2._wD(str('setup', result.join(', ')));\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    // </d>\r\n\r\n    for (i in o) {\r\n\r\n      if (o.hasOwnProperty(i)) {\r\n\r\n        // if not an {object} we want to recurse through...\r\n\r\n        if (typeof o[i] !== 'object' || o[i] === null || o[i] instanceof Array || o[i] instanceof RegExp) {\r\n\r\n          // check \"allowed\" options\r\n\r\n          if (hasParent && bonusOptions[oParent] !== _undefined) {\r\n\r\n            // valid recursive / nested object option, eg., { defaultOptions: { volume: 50 } }\r\n            sm2[oParent][i] = o[i];\r\n\r\n          } else if (setupOptions[i] !== _undefined) {\r\n\r\n            // special case: assign to setupOptions object, which soundManager property references\r\n            sm2.setupOptions[i] = o[i];\r\n\r\n            // assign directly to soundManager, too\r\n            sm2[i] = o[i];\r\n\r\n          } else if (bonusOptions[i] === _undefined) {\r\n\r\n            // invalid or disallowed parameter. complain.\r\n            complain(str((sm2[i] === _undefined ? 'setupUndef' : 'setupError'), i), 2);\r\n\r\n            result = false;\r\n\r\n          } else if (sm2[i] instanceof Function) {\r\n\r\n            /**\r\n             * valid extraOptions (bonusOptions) parameter.\r\n             * is it a method, like onready/ontimeout? call it.\r\n             * multiple parameters should be in an array, eg. soundManager.setup({onready: [myHandler, myScope]});\r\n             */\r\n            sm2[i].apply(sm2, (o[i] instanceof Array ? o[i] : [o[i]]));\r\n\r\n          } else {\r\n\r\n            // good old-fashioned direct assignment\r\n            sm2[i] = o[i];\r\n\r\n          }\r\n\r\n        } else if (bonusOptions[i] === _undefined) {\r\n\r\n          // recursion case, eg., { defaultOptions: { ... } }\r\n\r\n          // invalid or disallowed parameter. complain.\r\n          complain(str((sm2[i] === _undefined ? 'setupUndef' : 'setupError'), i), 2);\r\n\r\n          result = false;\r\n\r\n        } else {\r\n\r\n          // recurse through object\r\n          return assign(o[i], i);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  function preferFlashCheck(kind) {\r\n\r\n    // whether flash should play a given type\r\n    return (sm2.preferFlash && hasFlash && !sm2.ignoreFlash && (sm2.flash[kind] !== _undefined && sm2.flash[kind]));\r\n\r\n  }\r\n\r\n  /**\r\n   * Internal DOM2-level event helpers\r\n   * ---------------------------------\r\n   */\r\n\r\n  event = (function() {\r\n\r\n    // normalize event methods\r\n    var old = (window.attachEvent),\r\n    evt = {\r\n      add: (old ? 'attachEvent' : 'addEventListener'),\r\n      remove: (old ? 'detachEvent' : 'removeEventListener')\r\n    };\r\n\r\n    // normalize \"on\" event prefix, optional capture argument\r\n    function getArgs(oArgs) {\r\n\r\n      var args = slice.call(oArgs),\r\n          len = args.length;\r\n\r\n      if (old) {\r\n        // prefix\r\n        args[1] = 'on' + args[1];\r\n        if (len > 3) {\r\n          // no capture\r\n          args.pop();\r\n        }\r\n      } else if (len === 3) {\r\n        args.push(false);\r\n      }\r\n\r\n      return args;\r\n\r\n    }\r\n\r\n    function apply(args, sType) {\r\n\r\n      // normalize and call the event method, with the proper arguments\r\n      var element = args.shift(),\r\n          method = [evt[sType]];\r\n\r\n      if (old) {\r\n        // old IE can't do apply().\r\n        element[method](args[0], args[1]);\r\n      } else {\r\n        element[method].apply(element, args);\r\n      }\r\n\r\n    }\r\n\r\n    function add() {\r\n      apply(getArgs(arguments), 'add');\r\n    }\r\n\r\n    function remove() {\r\n      apply(getArgs(arguments), 'remove');\r\n    }\r\n\r\n    return {\r\n      add: add,\r\n      remove: remove\r\n    };\r\n\r\n  }());\r\n\r\n  /**\r\n   * Internal HTML5 event handling\r\n   * -----------------------------\r\n   */\r\n\r\n  function html5_event(oFn) {\r\n\r\n    // wrap html5 event handlers so we don't call them on destroyed and/or unloaded sounds\r\n\r\n    return function(e) {\r\n\r\n      var s = this._s,\r\n          result;\r\n\r\n      if (!s || !s._a) {\r\n        // <d>\r\n        if (s && s.id) {\r\n          sm2._wD(s.id + ': Ignoring ' + e.type);\r\n        } else {\r\n          sm2._wD(h5 + 'Ignoring ' + e.type);\r\n        }\r\n        // </d>\r\n        result = null;\r\n      } else {\r\n        result = oFn.call(this, e);\r\n      }\r\n\r\n      return result;\r\n\r\n    };\r\n\r\n  }\r\n\r\n  html5_events = {\r\n\r\n    // HTML5 event-name-to-handler map\r\n\r\n    abort: html5_event(function() {\r\n\r\n      sm2._wD(this._s.id + ': abort');\r\n\r\n    }),\r\n\r\n    // enough has loaded to play\r\n\r\n    canplay: html5_event(function() {\r\n\r\n      var s = this._s,\r\n          position1K;\r\n\r\n      if (s._html5_canplay) {\r\n        // this event has already fired. ignore.\r\n        return;\r\n      }\r\n\r\n      s._html5_canplay = true;\r\n      sm2._wD(s.id + ': canplay');\r\n      s._onbufferchange(0);\r\n\r\n      // position according to instance options\r\n      position1K = (s._iO.position !== _undefined && !isNaN(s._iO.position) ? s._iO.position / msecScale : null);\r\n\r\n      // set the position if position was provided before the sound loaded\r\n      if (this.currentTime !== position1K) {\r\n        sm2._wD(s.id + ': canplay: Setting position to ' + position1K);\r\n        try {\r\n          this.currentTime = position1K;\r\n        } catch(ee) {\r\n          sm2._wD(s.id + ': canplay: Setting position of ' + position1K + ' failed: ' + ee.message, 2);\r\n        }\r\n      }\r\n\r\n      // hack for HTML5 from/to case\r\n      if (s._iO._oncanplay) {\r\n        s._iO._oncanplay();\r\n      }\r\n\r\n    }),\r\n\r\n    canplaythrough: html5_event(function() {\r\n\r\n      var s = this._s;\r\n\r\n      if (!s.loaded) {\r\n        s._onbufferchange(0);\r\n        s._whileloading(s.bytesLoaded, s.bytesTotal, s._get_html5_duration());\r\n        s._onload(true);\r\n      }\r\n\r\n    }),\r\n\r\n    durationchange: html5_event(function() {\r\n\r\n      // durationchange may fire at various times, probably the safest way to capture accurate/final duration.\r\n\r\n      var s = this._s,\r\n          duration;\r\n\r\n      duration = s._get_html5_duration();\r\n\r\n      if (!isNaN(duration) && duration !== s.duration) {\r\n\r\n        sm2._wD(this._s.id + ': durationchange (' + duration + ')' + (s.duration ? ', previously ' + s.duration : ''));\r\n\r\n        s.durationEstimate = s.duration = duration;\r\n\r\n      }\r\n\r\n    }),\r\n\r\n    // TODO: Reserved for potential use\r\n    /*\r\n    emptied: html5_event(function() {\r\n\r\n      sm2._wD(this._s.id + ': emptied');\r\n\r\n    }),\r\n    */\r\n\r\n    ended: html5_event(function() {\r\n\r\n      var s = this._s;\r\n\r\n      sm2._wD(s.id + ': ended');\r\n\r\n      s._onfinish();\r\n\r\n    }),\r\n\r\n    error: html5_event(function() {\r\n\r\n      var description = (html5ErrorCodes[this.error.code] || null);\r\n      sm2._wD(this._s.id + ': HTML5 error, code ' + this.error.code + (description ? ' (' + description + ')' : ''));\r\n      this._s._onload(false);\r\n      this._s._onerror(this.error.code, description);\r\n\r\n    }),\r\n\r\n    loadeddata: html5_event(function() {\r\n\r\n      var s = this._s;\r\n\r\n      sm2._wD(s.id + ': loadeddata');\r\n\r\n      // safari seems to nicely report progress events, eventually totalling 100%\r\n      if (!s._loaded && !isSafari) {\r\n        s.duration = s._get_html5_duration();\r\n      }\r\n\r\n    }),\r\n\r\n    loadedmetadata: html5_event(function() {\r\n\r\n      sm2._wD(this._s.id + ': loadedmetadata');\r\n\r\n    }),\r\n\r\n    loadstart: html5_event(function() {\r\n\r\n      sm2._wD(this._s.id + ': loadstart');\r\n      // assume buffering at first\r\n      this._s._onbufferchange(1);\r\n\r\n    }),\r\n\r\n    play: html5_event(function() {\r\n\r\n      // sm2._wD(this._s.id + ': play()');\r\n      // once play starts, no buffering\r\n      this._s._onbufferchange(0);\r\n\r\n    }),\r\n\r\n    playing: html5_event(function() {\r\n\r\n      sm2._wD(this._s.id + ': playing ' + String.fromCharCode(9835));\r\n      // once play starts, no buffering\r\n      this._s._onbufferchange(0);\r\n\r\n    }),\r\n\r\n    progress: html5_event(function(e) {\r\n\r\n      // note: can fire repeatedly after \"loaded\" event, due to use of HTTP range/partials\r\n\r\n      var s = this._s,\r\n          i, j, progStr, buffered = 0,\r\n          isProgress = (e.type === 'progress'),\r\n          ranges = e.target.buffered,\r\n          // firefox 3.6 implements e.loaded/total (bytes)\r\n          loaded = (e.loaded || 0),\r\n          total = (e.total || 1);\r\n\r\n      // reset the \"buffered\" (loaded byte ranges) array\r\n      s.buffered = [];\r\n\r\n      if (ranges && ranges.length) {\r\n\r\n        // if loaded is 0, try TimeRanges implementation as % of load\r\n        // https://developer.mozilla.org/en/DOM/TimeRanges\r\n\r\n        // re-build \"buffered\" array\r\n        // HTML5 returns seconds. SM2 API uses msec for setPosition() etc., whether Flash or HTML5.\r\n        for (i = 0, j = ranges.length; i < j; i++) {\r\n          s.buffered.push({\r\n            start: ranges.start(i) * msecScale,\r\n            end: ranges.end(i) * msecScale\r\n          });\r\n        }\r\n\r\n        // use the last value locally\r\n        buffered = (ranges.end(0) - ranges.start(0)) * msecScale;\r\n\r\n        // linear case, buffer sum; does not account for seeking and HTTP partials / byte ranges\r\n        loaded = Math.min(1, buffered / (e.target.duration * msecScale));\r\n\r\n        // <d>\r\n        if (isProgress && ranges.length > 1) {\r\n          progStr = [];\r\n          j = ranges.length;\r\n          for (i = 0; i < j; i++) {\r\n            progStr.push((e.target.buffered.start(i) * msecScale) + '-' + (e.target.buffered.end(i) * msecScale));\r\n          }\r\n          sm2._wD(this._s.id + ': progress, timeRanges: ' + progStr.join(', '));\r\n        }\r\n\r\n        if (isProgress && !isNaN(loaded)) {\r\n          sm2._wD(this._s.id + ': progress, ' + Math.floor(loaded * 100) + '% loaded');\r\n        }\r\n        // </d>\r\n\r\n      }\r\n\r\n      if (!isNaN(loaded)) {\r\n\r\n        // TODO: prevent calls with duplicate values.\r\n        s._whileloading(loaded, total, s._get_html5_duration());\r\n        if (loaded && total && loaded === total) {\r\n          // in case \"onload\" doesn't fire (eg. gecko 1.9.2)\r\n          html5_events.canplaythrough.call(this, e);\r\n        }\r\n\r\n      }\r\n\r\n    }),\r\n\r\n    ratechange: html5_event(function() {\r\n\r\n      sm2._wD(this._s.id + ': ratechange');\r\n\r\n    }),\r\n\r\n    suspend: html5_event(function(e) {\r\n\r\n      // download paused/stopped, may have finished (eg. onload)\r\n      var s = this._s;\r\n\r\n      sm2._wD(this._s.id + ': suspend');\r\n      html5_events.progress.call(this, e);\r\n      s._onsuspend();\r\n\r\n    }),\r\n\r\n    stalled: html5_event(function() {\r\n\r\n      sm2._wD(this._s.id + ': stalled');\r\n\r\n    }),\r\n\r\n    timeupdate: html5_event(function() {\r\n\r\n      this._s._onTimer();\r\n\r\n    }),\r\n\r\n    waiting: html5_event(function() {\r\n\r\n      var s = this._s;\r\n\r\n      // see also: seeking\r\n      sm2._wD(this._s.id + ': waiting');\r\n\r\n      // playback faster than download rate, etc.\r\n      s._onbufferchange(1);\r\n\r\n    })\r\n\r\n  };\r\n\r\n  html5OK = function(iO) {\r\n\r\n    // playability test based on URL or MIME type\r\n\r\n    var result;\r\n\r\n    if (!iO || (!iO.type && !iO.url && !iO.serverURL)) {\r\n\r\n      // nothing to check\r\n      result = false;\r\n\r\n    } else if (iO.serverURL || (iO.type && preferFlashCheck(iO.type))) {\r\n\r\n      // RTMP, or preferring flash\r\n      result = false;\r\n\r\n    } else {\r\n\r\n      // Use type, if specified. Pass data: URIs to HTML5. If HTML5-only mode, no other options, so just give 'er\r\n      result = ((iO.type ? html5CanPlay({ type: iO.type }) : html5CanPlay({ url: iO.url }) || sm2.html5Only || iO.url.match(/data:/i)));\r\n\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  html5Unload = function(oAudio) {\r\n\r\n    /**\r\n     * Internal method: Unload media, and cancel any current/pending network requests.\r\n     * Firefox can load an empty URL, which allegedly destroys the decoder and stops the download.\r\n     * https://developer.mozilla.org/En/Using_audio_and_video_in_Firefox#Stopping_the_download_of_media\r\n     * However, Firefox has been seen loading a relative URL from '' and thus requesting the hosting page on unload.\r\n     * Other UA behaviour is unclear, so everyone else gets an about:blank-style URL.\r\n     */\r\n\r\n    var url;\r\n\r\n    if (oAudio) {\r\n\r\n      // Firefox and Chrome accept short WAVe data: URIs. Chome dislikes audio/wav, but accepts audio/wav for data: MIME.\r\n      // Desktop Safari complains / fails on data: URI, so it gets about:blank.\r\n      url = (isSafari ? emptyURL : (sm2.html5.canPlayType('audio/wav') ? emptyWAV : emptyURL));\r\n\r\n      oAudio.src = url;\r\n\r\n      // reset some state, too\r\n      if (oAudio._called_unload !== _undefined) {\r\n        oAudio._called_load = false;\r\n      }\r\n\r\n    }\r\n\r\n    if (useGlobalHTML5Audio) {\r\n\r\n      // ensure URL state is trashed, also\r\n      lastGlobalHTML5URL = null;\r\n\r\n    }\r\n\r\n    return url;\r\n\r\n  };\r\n\r\n  html5CanPlay = function(o) {\r\n\r\n    /**\r\n     * Try to find MIME, test and return truthiness\r\n     * o = {\r\n     *  url: '/path/to/an.mp3',\r\n     *  type: 'audio/mp3'\r\n     * }\r\n     */\r\n\r\n    if (!sm2.useHTML5Audio || !sm2.hasHTML5) return false;\r\n\r\n    var url = (o.url || null),\r\n        mime = (o.type || null),\r\n        aF = sm2.audioFormats,\r\n        result,\r\n        offset,\r\n        fileExt,\r\n        item;\r\n\r\n    // account for known cases like audio/mp3\r\n\r\n    if (mime && sm2.html5[mime] !== _undefined) return (sm2.html5[mime] && !preferFlashCheck(mime));\r\n\r\n    if (!html5Ext) {\r\n\r\n      html5Ext = [];\r\n\r\n      for (item in aF) {\r\n\r\n        if (aF.hasOwnProperty(item)) {\r\n\r\n          html5Ext.push(item);\r\n\r\n          if (aF[item].related) {\r\n            html5Ext = html5Ext.concat(aF[item].related);\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n      html5Ext = new RegExp('\\\\.(' + html5Ext.join('|') + ')(\\\\?.*)?$', 'i');\r\n\r\n    }\r\n\r\n    // TODO: Strip URL queries, etc.\r\n    fileExt = (url ? url.toLowerCase().match(html5Ext) : null);\r\n\r\n    if (!fileExt || !fileExt.length) {\r\n\r\n      if (!mime) {\r\n\r\n        result = false;\r\n\r\n      } else {\r\n\r\n        // audio/mp3 -> mp3, result should be known\r\n        offset = mime.indexOf(';');\r\n\r\n        // strip \"audio/X; codecs...\"\r\n        fileExt = (offset !== -1 ? mime.substr(0, offset) : mime).substr(6);\r\n\r\n      }\r\n\r\n    } else {\r\n\r\n      // match the raw extension name - \"mp3\", for example\r\n      fileExt = fileExt[1];\r\n\r\n    }\r\n\r\n    if (fileExt && sm2.html5[fileExt] !== _undefined) {\r\n\r\n      // result known\r\n      result = (sm2.html5[fileExt] && !preferFlashCheck(fileExt));\r\n\r\n    } else {\r\n\r\n      mime = 'audio/' + fileExt;\r\n      result = sm2.html5.canPlayType({ type: mime });\r\n\r\n      sm2.html5[fileExt] = result;\r\n\r\n      // sm2._wD('canPlayType, found result: ' + result);\r\n      result = (result && sm2.html5[mime] && !preferFlashCheck(mime));\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  testHTML5 = function() {\r\n\r\n    /**\r\n     * Internal: Iterates over audioFormats, determining support eg. audio/mp3, audio/mpeg and so on\r\n     * assigns results to html5[] and flash[].\r\n     */\r\n\r\n    if (!sm2.useHTML5Audio || !sm2.hasHTML5) {\r\n\r\n      // without HTML5, we need Flash.\r\n      sm2.html5.usingFlash = true;\r\n      needsFlash = true;\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    // double-whammy: Opera 9.64 throws WRONG_ARGUMENTS_ERR if no parameter passed to Audio(), and Webkit + iOS happily tries to load \"null\" as a URL. :/\r\n    var a = (Audio !== _undefined ? (isOpera && opera.version() < 10 ? new Audio(null) : new Audio()) : null),\r\n        item, lookup, support = {}, aF, i;\r\n\r\n    function cp(m) {\r\n\r\n      var canPlay, j,\r\n          result = false,\r\n          isOK = false;\r\n\r\n      if (!a || typeof a.canPlayType !== 'function') return result;\r\n\r\n      if (m instanceof Array) {\r\n\r\n        // iterate through all mime types, return any successes\r\n\r\n        for (i = 0, j = m.length; i < j; i++) {\r\n\r\n          if (sm2.html5[m[i]] || a.canPlayType(m[i]).match(sm2.html5Test)) {\r\n\r\n            isOK = true;\r\n            sm2.html5[m[i]] = true;\r\n\r\n            // note flash support, too\r\n            sm2.flash[m[i]] = !!(m[i].match(flashMIME));\r\n\r\n          }\r\n\r\n        }\r\n\r\n        result = isOK;\r\n\r\n      } else {\r\n\r\n        canPlay = (a && typeof a.canPlayType === 'function' ? a.canPlayType(m) : false);\r\n        result = !!(canPlay && (canPlay.match(sm2.html5Test)));\r\n\r\n      }\r\n\r\n      return result;\r\n\r\n    }\r\n\r\n    // test all registered formats + codecs\r\n\r\n    aF = sm2.audioFormats;\r\n\r\n    for (item in aF) {\r\n\r\n      if (aF.hasOwnProperty(item)) {\r\n\r\n        lookup = 'audio/' + item;\r\n\r\n        support[item] = cp(aF[item].type);\r\n\r\n        // write back generic type too, eg. audio/mp3\r\n        support[lookup] = support[item];\r\n\r\n        // assign flash\r\n        if (item.match(flashMIME)) {\r\n\r\n          sm2.flash[item] = true;\r\n          sm2.flash[lookup] = true;\r\n\r\n        } else {\r\n\r\n          sm2.flash[item] = false;\r\n          sm2.flash[lookup] = false;\r\n\r\n        }\r\n\r\n        // assign result to related formats, too\r\n\r\n        if (aF[item] && aF[item].related) {\r\n\r\n          for (i = aF[item].related.length - 1; i >= 0; i--) {\r\n\r\n            // eg. audio/m4a\r\n            support['audio/' + aF[item].related[i]] = support[item];\r\n            sm2.html5[aF[item].related[i]] = support[item];\r\n            sm2.flash[aF[item].related[i]] = support[item];\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    support.canPlayType = (a ? cp : null);\r\n    sm2.html5 = mixin(sm2.html5, support);\r\n\r\n    sm2.html5.usingFlash = featureCheck();\r\n    needsFlash = sm2.html5.usingFlash;\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  strings = {\r\n\r\n    // <d>\r\n    notReady: 'Unavailable - wait until onready() has fired.',\r\n    notOK: 'Audio support is not available.',\r\n    domError: sm + 'exception caught while appending SWF to DOM.',\r\n    spcWmode: 'Removing wmode, preventing known SWF loading issue(s)',\r\n    swf404: smc + 'Verify that %s is a valid path.',\r\n    tryDebug: 'Try ' + sm + '.debugFlash = true for more security details (output goes to SWF.)',\r\n    checkSWF: 'See SWF output for more debug info.',\r\n    localFail: smc + 'Non-HTTP page (' + doc.location.protocol + ' URL?) Review Flash player security settings for this special case:\\nhttp://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html\\nMay need to add/allow path, eg. c:/sm2/ or /users/me/sm2/',\r\n    waitFocus: smc + 'Special case: Waiting for SWF to load with window focus...',\r\n    waitForever: smc + 'Waiting indefinitely for Flash (will recover if unblocked)...',\r\n    waitSWF: smc + 'Waiting for 100% SWF load...',\r\n    needFunction: smc + 'Function object expected for %s',\r\n    badID: 'Sound ID \"%s\" should be a string, starting with a non-numeric character',\r\n    currentObj: smc + '_debug(): Current sound objects',\r\n    waitOnload: smc + 'Waiting for window.onload()',\r\n    docLoaded: smc + 'Document already loaded',\r\n    onload: smc + 'initComplete(): calling soundManager.onload()',\r\n    onloadOK: sm + '.onload() complete',\r\n    didInit: smc + 'init(): Already called?',\r\n    secNote: 'Flash security note: Network/internet URLs will not load due to security restrictions. Access can be configured via Flash Player Global Security Settings Page: http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html',\r\n    badRemove: smc + 'Failed to remove Flash node.',\r\n    shutdown: sm + '.disable(): Shutting down',\r\n    queue: smc + 'Queueing %s handler',\r\n    smError: 'SMSound.load(): Exception: JS-Flash communication failed, or JS error.',\r\n    fbTimeout: 'No flash response, applying .' + swfCSS.swfTimedout + ' CSS...',\r\n    fbLoaded: 'Flash loaded',\r\n    fbHandler: smc + 'flashBlockHandler()',\r\n    manURL: 'SMSound.load(): Using manually-assigned URL',\r\n    onURL: sm + '.load(): current URL already assigned.',\r\n    badFV: sm + '.flashVersion must be 8 or 9. \"%s\" is invalid. Reverting to %s.',\r\n    as2loop: 'Note: Setting stream:false so looping can work (flash 8 limitation)',\r\n    noNSLoop: 'Note: Looping not implemented for MovieStar formats',\r\n    needfl9: 'Note: Switching to flash 9, required for MP4 formats.',\r\n    mfTimeout: 'Setting flashLoadTimeout = 0 (infinite) for off-screen, mobile flash case',\r\n    needFlash: smc + 'Fatal error: Flash is needed to play some required formats, but is not available.',\r\n    gotFocus: smc + 'Got window focus.',\r\n    policy: 'Enabling usePolicyFile for data access',\r\n    setup: sm + '.setup(): allowed parameters: %s',\r\n    setupError: sm + '.setup(): \"%s\" cannot be assigned with this method.',\r\n    setupUndef: sm + '.setup(): Could not find option \"%s\"',\r\n    setupLate: sm + '.setup(): url, flashVersion and html5Test property changes will not take effect until reboot().',\r\n    noURL: smc + 'Flash URL required. Call soundManager.setup({url:...}) to get started.',\r\n    sm2Loaded: 'SoundManager 2: Ready. ' + String.fromCharCode(10003),\r\n    reset: sm + '.reset(): Removing event callbacks',\r\n    mobileUA: 'Mobile UA detected, preferring HTML5 by default.',\r\n    globalHTML5: 'Using singleton HTML5 Audio() pattern for this device.',\r\n    ignoreMobile: 'Ignoring mobile restrictions for this device.'\r\n    // </d>\r\n\r\n  };\r\n\r\n  str = function() {\r\n\r\n    // internal string replace helper.\r\n    // arguments: o [,items to replace]\r\n    // <d>\r\n\r\n    var args,\r\n        i, j, o,\r\n        sstr;\r\n\r\n    // real array, please\r\n    args = slice.call(arguments);\r\n\r\n    // first argument\r\n    o = args.shift();\r\n\r\n    sstr = (strings && strings[o] ? strings[o] : '');\r\n\r\n    if (sstr && args && args.length) {\r\n      for (i = 0, j = args.length; i < j; i++) {\r\n        sstr = sstr.replace('%s', args[i]);\r\n      }\r\n    }\r\n\r\n    return sstr;\r\n    // </d>\r\n\r\n  };\r\n\r\n  loopFix = function(sOpt) {\r\n\r\n    // flash 8 requires stream = false for looping to work\r\n    if (fV === 8 && sOpt.loops > 1 && sOpt.stream) {\r\n      _wDS('as2loop');\r\n      sOpt.stream = false;\r\n    }\r\n\r\n    return sOpt;\r\n\r\n  };\r\n\r\n  policyFix = function(sOpt, sPre) {\r\n\r\n    if (sOpt && !sOpt.usePolicyFile && (sOpt.onid3 || sOpt.usePeakData || sOpt.useWaveformData || sOpt.useEQData)) {\r\n      sm2._wD((sPre || '') + str('policy'));\r\n      sOpt.usePolicyFile = true;\r\n    }\r\n\r\n    return sOpt;\r\n\r\n  };\r\n\r\n  complain = function(sMsg) {\r\n\r\n    // <d>\r\n    if (hasConsole && console.warn !== _undefined) {\r\n      console.warn(sMsg);\r\n    } else {\r\n      sm2._wD(sMsg);\r\n    }\r\n    // </d>\r\n\r\n  };\r\n\r\n  doNothing = function() {\r\n\r\n    return false;\r\n\r\n  };\r\n\r\n  disableObject = function(o) {\r\n\r\n    var oProp;\r\n\r\n    for (oProp in o) {\r\n      if (o.hasOwnProperty(oProp) && typeof o[oProp] === 'function') {\r\n        o[oProp] = doNothing;\r\n      }\r\n    }\r\n\r\n    oProp = null;\r\n\r\n  };\r\n\r\n  failSafely = function(bNoDisable) {\r\n\r\n    // general failure exception handler\r\n\r\n    if (bNoDisable === _undefined) {\r\n      bNoDisable = false;\r\n    }\r\n\r\n    if (disabled || bNoDisable) {\r\n      sm2.disable(bNoDisable);\r\n    }\r\n\r\n  };\r\n\r\n  normalizeMovieURL = function(movieURL) {\r\n\r\n    var urlParams = null, url;\r\n\r\n    if (movieURL) {\r\n\r\n      if (movieURL.match(/\\.swf(\\?.*)?$/i)) {\r\n\r\n        urlParams = movieURL.substr(movieURL.toLowerCase().lastIndexOf('.swf?') + 4);\r\n\r\n        // assume user knows what they're doing\r\n        if (urlParams) return movieURL;\r\n\r\n      } else if (movieURL.lastIndexOf('/') !== movieURL.length - 1) {\r\n\r\n        // append trailing slash, if needed\r\n        movieURL += '/';\r\n\r\n      }\r\n\r\n    }\r\n\r\n    url = (movieURL && movieURL.lastIndexOf('/') !== -1 ? movieURL.substr(0, movieURL.lastIndexOf('/') + 1) : './') + sm2.movieURL;\r\n\r\n    if (sm2.noSWFCache) {\r\n      url += ('?ts=' + new Date().getTime());\r\n    }\r\n\r\n    return url;\r\n\r\n  };\r\n\r\n  setVersionInfo = function() {\r\n\r\n    // short-hand for internal use\r\n\r\n    fV = parseInt(sm2.flashVersion, 10);\r\n\r\n    if (fV !== 8 && fV !== 9) {\r\n      sm2._wD(str('badFV', fV, defaultFlashVersion));\r\n      sm2.flashVersion = fV = defaultFlashVersion;\r\n    }\r\n\r\n    // debug flash movie, if applicable\r\n\r\n    var isDebug = (sm2.debugMode || sm2.debugFlash ? '_debug.swf' : '.swf');\r\n\r\n    if (sm2.useHTML5Audio && !sm2.html5Only && sm2.audioFormats.mp4.required && fV < 9) {\r\n      sm2._wD(str('needfl9'));\r\n      sm2.flashVersion = fV = 9;\r\n    }\r\n\r\n    sm2.version = sm2.versionNumber + (sm2.html5Only ? ' (HTML5-only mode)' : (fV === 9 ? ' (AS3/Flash 9)' : ' (AS2/Flash 8)'));\r\n\r\n    // set up default options\r\n    if (fV > 8) {\r\n\r\n      // +flash 9 base options\r\n      sm2.defaultOptions = mixin(sm2.defaultOptions, sm2.flash9Options);\r\n      sm2.features.buffering = true;\r\n\r\n      // +moviestar support\r\n      sm2.defaultOptions = mixin(sm2.defaultOptions, sm2.movieStarOptions);\r\n      sm2.filePatterns.flash9 = new RegExp('\\\\.(mp3|' + netStreamTypes.join('|') + ')(\\\\?.*)?$', 'i');\r\n      sm2.features.movieStar = true;\r\n\r\n    } else {\r\n\r\n      sm2.features.movieStar = false;\r\n\r\n    }\r\n\r\n    // regExp for flash canPlay(), etc.\r\n    sm2.filePattern = sm2.filePatterns[(fV !== 8 ? 'flash9' : 'flash8')];\r\n\r\n    // if applicable, use _debug versions of SWFs\r\n    sm2.movieURL = (fV === 8 ? 'soundmanager2.swf' : 'soundmanager2_flash9.swf').replace('.swf', isDebug);\r\n\r\n    sm2.features.peakData = sm2.features.waveformData = sm2.features.eqData = (fV > 8);\r\n\r\n  };\r\n\r\n  setPolling = function(bPolling, bHighPerformance) {\r\n\r\n    if (!flash) {\r\n      return;\r\n    }\r\n\r\n    flash._setPolling(bPolling, bHighPerformance);\r\n\r\n  };\r\n\r\n  initDebug = function() {\r\n\r\n    // starts debug mode, creating output <div> for UAs without console object\r\n\r\n    // allow force of debug mode via URL\r\n    // <d>\r\n    if (sm2.debugURLParam.test(wl)) {\r\n      sm2.setupOptions.debugMode = sm2.debugMode = true;\r\n    }\r\n\r\n    if (id(sm2.debugID)) {\r\n      return;\r\n    }\r\n\r\n    var oD, oDebug, oTarget, oToggle, tmp;\r\n\r\n    if (sm2.debugMode && !id(sm2.debugID) && (!hasConsole || !sm2.useConsole || !sm2.consoleOnly)) {\r\n\r\n      oD = doc.createElement('div');\r\n      oD.id = sm2.debugID + '-toggle';\r\n\r\n      oToggle = {\r\n        position: 'fixed',\r\n        bottom: '0px',\r\n        right: '0px',\r\n        width: '1.2em',\r\n        height: '1.2em',\r\n        lineHeight: '1.2em',\r\n        margin: '2px',\r\n        textAlign: 'center',\r\n        border: '1px solid #999',\r\n        cursor: 'pointer',\r\n        background: '#fff',\r\n        color: '#333',\r\n        zIndex: 10001\r\n      };\r\n\r\n      oD.appendChild(doc.createTextNode('-'));\r\n      oD.onclick = toggleDebug;\r\n      oD.title = 'Toggle SM2 debug console';\r\n\r\n      if (ua.match(/msie 6/i)) {\r\n        oD.style.position = 'absolute';\r\n        oD.style.cursor = 'hand';\r\n      }\r\n\r\n      for (tmp in oToggle) {\r\n        if (oToggle.hasOwnProperty(tmp)) {\r\n          oD.style[tmp] = oToggle[tmp];\r\n        }\r\n      }\r\n\r\n      oDebug = doc.createElement('div');\r\n      oDebug.id = sm2.debugID;\r\n      oDebug.style.display = (sm2.debugMode ? 'block' : 'none');\r\n\r\n      if (sm2.debugMode && !id(oD.id)) {\r\n        try {\r\n          oTarget = getDocument();\r\n          oTarget.appendChild(oD);\r\n        } catch(e2) {\r\n          throw new Error(str('domError') + ' \\n' + e2.toString());\r\n        }\r\n        oTarget.appendChild(oDebug);\r\n      }\r\n\r\n    }\r\n\r\n    oTarget = null;\r\n    // </d>\r\n\r\n  };\r\n\r\n  idCheck = this.getSoundById;\r\n\r\n  // <d>\r\n  _wDS = function(o, errorLevel) {\r\n\r\n    return (!o ? '' : sm2._wD(str(o), errorLevel));\r\n\r\n  };\r\n\r\n  toggleDebug = function() {\r\n\r\n    var o = id(sm2.debugID),\r\n    oT = id(sm2.debugID + '-toggle');\r\n\r\n    if (!o) {\r\n      return;\r\n    }\r\n\r\n    if (debugOpen) {\r\n      // minimize\r\n      oT.innerHTML = '+';\r\n      o.style.display = 'none';\r\n    } else {\r\n      oT.innerHTML = '-';\r\n      o.style.display = 'block';\r\n    }\r\n\r\n    debugOpen = !debugOpen;\r\n\r\n  };\r\n\r\n  debugTS = function(sEventType, bSuccess, sMessage) {\r\n\r\n    // troubleshooter debug hooks\r\n\r\n    if (window.sm2Debugger !== _undefined) {\r\n      try {\r\n        sm2Debugger.handleEvent(sEventType, bSuccess, sMessage);\r\n      } catch(e) {\r\n        // oh well\r\n        return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n\r\n  };\r\n  // </d>\r\n\r\n  getSWFCSS = function() {\r\n\r\n    var css = [];\r\n\r\n    if (sm2.debugMode) {\r\n      css.push(swfCSS.sm2Debug);\r\n    }\r\n\r\n    if (sm2.debugFlash) {\r\n      css.push(swfCSS.flashDebug);\r\n    }\r\n\r\n    if (sm2.useHighPerformance) {\r\n      css.push(swfCSS.highPerf);\r\n    }\r\n\r\n    return css.join(' ');\r\n\r\n  };\r\n\r\n  flashBlockHandler = function() {\r\n\r\n    // *possible* flash block situation.\r\n\r\n    var name = str('fbHandler'),\r\n        p = sm2.getMoviePercent(),\r\n        css = swfCSS,\r\n        error = {\r\n          type: 'FLASHBLOCK'\r\n        };\r\n\r\n    if (sm2.html5Only) {\r\n      // no flash, or unused\r\n      return;\r\n    }\r\n\r\n    if (!sm2.ok()) {\r\n\r\n      if (needsFlash) {\r\n        // make the movie more visible, so user can fix\r\n        sm2.oMC.className = getSWFCSS() + ' ' + css.swfDefault + ' ' + (p === null ? css.swfTimedout : css.swfError);\r\n        sm2._wD(name + ': ' + str('fbTimeout') + (p ? ' (' + str('fbLoaded') + ')' : ''));\r\n      }\r\n\r\n      sm2.didFlashBlock = true;\r\n\r\n      // fire onready(), complain lightly\r\n      processOnEvents({\r\n        type: 'ontimeout',\r\n        ignoreInit: true,\r\n        error: error\r\n      });\r\n\r\n      catchError(error);\r\n\r\n    } else {\r\n\r\n      // SM2 loaded OK (or recovered)\r\n\r\n      // <d>\r\n      if (sm2.didFlashBlock) {\r\n        sm2._wD(name + ': Unblocked');\r\n      }\r\n      // </d>\r\n\r\n      if (sm2.oMC) {\r\n        sm2.oMC.className = [getSWFCSS(), css.swfDefault, css.swfLoaded + (sm2.didFlashBlock ? ' ' + css.swfUnblocked : '')].join(' ');\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  addOnEvent = function(sType, oMethod, oScope) {\r\n\r\n    if (on_queue[sType] === _undefined) {\r\n      on_queue[sType] = [];\r\n    }\r\n\r\n    on_queue[sType].push({\r\n      method: oMethod,\r\n      scope: (oScope || null),\r\n      fired: false\r\n    });\r\n\r\n  };\r\n\r\n  processOnEvents = function(oOptions) {\r\n\r\n    // if unspecified, assume OK/error\r\n\r\n    if (!oOptions) {\r\n      oOptions = {\r\n        type: (sm2.ok() ? 'onready' : 'ontimeout')\r\n      };\r\n    }\r\n\r\n    // not ready yet.\r\n    if (!didInit && oOptions && !oOptions.ignoreInit) return false;\r\n\r\n    // invalid case\r\n    if (oOptions.type === 'ontimeout' && (sm2.ok() || (disabled && !oOptions.ignoreInit))) return false;\r\n\r\n    var status = {\r\n          success: (oOptions && oOptions.ignoreInit ? sm2.ok() : !disabled)\r\n        },\r\n\r\n        // queue specified by type, or none\r\n        srcQueue = (oOptions && oOptions.type ? on_queue[oOptions.type] || [] : []),\r\n\r\n        queue = [], i, j,\r\n        args = [status],\r\n        canRetry = (needsFlash && !sm2.ok());\r\n\r\n    if (oOptions.error) {\r\n      args[0].error = oOptions.error;\r\n    }\r\n\r\n    for (i = 0, j = srcQueue.length; i < j; i++) {\r\n      if (srcQueue[i].fired !== true) {\r\n        queue.push(srcQueue[i]);\r\n      }\r\n    }\r\n\r\n    if (queue.length) {\r\n\r\n      // sm2._wD(sm + ': Firing ' + queue.length + ' ' + oOptions.type + '() item' + (queue.length === 1 ? '' : 's'));\r\n      for (i = 0, j = queue.length; i < j; i++) {\r\n\r\n        if (queue[i].scope) {\r\n          queue[i].method.apply(queue[i].scope, args);\r\n        } else {\r\n          queue[i].method.apply(this, args);\r\n        }\r\n\r\n        if (!canRetry) {\r\n          // useFlashBlock and SWF timeout case doesn't count here.\r\n          queue[i].fired = true;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  initUserOnload = function() {\r\n\r\n    window.setTimeout(function() {\r\n\r\n      if (sm2.useFlashBlock) {\r\n        flashBlockHandler();\r\n      }\r\n\r\n      processOnEvents();\r\n\r\n      // call user-defined \"onload\", scoped to window\r\n\r\n      if (typeof sm2.onload === 'function') {\r\n        _wDS('onload', 1);\r\n        sm2.onload.apply(window);\r\n        _wDS('onloadOK', 1);\r\n      }\r\n\r\n      if (sm2.waitForWindowLoad) {\r\n        event.add(window, 'load', initUserOnload);\r\n      }\r\n\r\n    }, 1);\r\n\r\n  };\r\n\r\n  detectFlash = function() {\r\n\r\n    /**\r\n     * Hat tip: Flash Detect library (BSD, (C) 2007) by Carl \"DocYes\" S. Yestrau\r\n     * http://featureblend.com/javascript-flash-detection-library.html / http://featureblend.com/license.txt\r\n     */\r\n\r\n    // this work has already been done.\r\n    if (hasFlash !== _undefined) return hasFlash;\r\n\r\n    var hasPlugin = false, n = navigator, obj, type, types, AX = window.ActiveXObject;\r\n\r\n    // MS Edge 14 throws an \"Unspecified Error\" because n.plugins is inaccessible due to permissions\r\n    var nP;\r\n\r\n    try {\r\n      nP = n.plugins;\r\n    } catch(e) {\r\n      nP = undefined;\r\n    }\r\n\r\n    if (nP && nP.length) {\r\n\r\n      type = 'application/x-shockwave-flash';\r\n      types = n.mimeTypes;\r\n\r\n      if (types && types[type] && types[type].enabledPlugin && types[type].enabledPlugin.description) {\r\n        hasPlugin = true;\r\n      }\r\n\r\n    } else if (AX !== _undefined && !ua.match(/MSAppHost/i)) {\r\n\r\n      // Windows 8 Store Apps (MSAppHost) are weird (compatibility?) and won't complain here, but will barf if Flash/ActiveX object is appended to the DOM.\r\n      try {\r\n        obj = new AX('ShockwaveFlash.ShockwaveFlash');\r\n      } catch(e) {\r\n        // oh well\r\n        obj = null;\r\n      }\r\n\r\n      hasPlugin = (!!obj);\r\n\r\n      // cleanup, because it is ActiveX after all\r\n      obj = null;\r\n\r\n    }\r\n\r\n    hasFlash = hasPlugin;\r\n\r\n    return hasPlugin;\r\n\r\n  };\r\n\r\n  featureCheck = function() {\r\n\r\n    var flashNeeded,\r\n        item,\r\n        formats = sm2.audioFormats,\r\n        // iPhone <= 3.1 has broken HTML5 audio(), but firmware 3.2 (original iPad) + iOS4 works.\r\n        isSpecial = (is_iDevice && !!(ua.match(/os (1|2|3_0|3_1)\\s/i)));\r\n\r\n    if (isSpecial) {\r\n\r\n      // has Audio(), but is broken; let it load links directly.\r\n      sm2.hasHTML5 = false;\r\n\r\n      // ignore flash case, however\r\n      sm2.html5Only = true;\r\n\r\n      // hide the SWF, if present\r\n      if (sm2.oMC) {\r\n        sm2.oMC.style.display = 'none';\r\n      }\r\n\r\n    } else if (sm2.useHTML5Audio) {\r\n\r\n        if (!sm2.html5 || !sm2.html5.canPlayType) {\r\n          sm2._wD('SoundManager: No HTML5 Audio() support detected.');\r\n          sm2.hasHTML5 = false;\r\n        }\r\n\r\n        // <d>\r\n        if (isBadSafari) {\r\n          sm2._wD(smc + 'Note: Buggy HTML5 Audio in Safari on this OS X release, see https://bugs.webkit.org/show_bug.cgi?id=32159 - ' + (!hasFlash ? ' would use flash fallback for MP3/MP4, but none detected.' : 'will use flash fallback for MP3/MP4, if available'), 1);\r\n        }\r\n        // </d>\r\n\r\n      }\r\n\r\n    if (sm2.useHTML5Audio && sm2.hasHTML5) {\r\n\r\n      // sort out whether flash is optional, required or can be ignored.\r\n\r\n      // innocent until proven guilty.\r\n      canIgnoreFlash = true;\r\n\r\n      for (item in formats) {\r\n\r\n        if (formats.hasOwnProperty(item)) {\r\n\r\n          if (formats[item].required) {\r\n\r\n            if (!sm2.html5.canPlayType(formats[item].type)) {\r\n\r\n              // 100% HTML5 mode is not possible.\r\n              canIgnoreFlash = false;\r\n              flashNeeded = true;\r\n\r\n            } else if (sm2.preferFlash && (sm2.flash[item] || sm2.flash[formats[item].type])) {\r\n\r\n              // flash may be required, or preferred for this format.\r\n              flashNeeded = true;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // sanity check...\r\n    if (sm2.ignoreFlash) {\r\n      flashNeeded = false;\r\n      canIgnoreFlash = true;\r\n    }\r\n\r\n    sm2.html5Only = (sm2.hasHTML5 && sm2.useHTML5Audio && !flashNeeded);\r\n\r\n    return (!sm2.html5Only);\r\n\r\n  };\r\n\r\n  parseURL = function(url) {\r\n\r\n    /**\r\n     * Internal: Finds and returns the first playable URL (or failing that, the first URL.)\r\n     * @param {string or array} url A single URL string, OR, an array of URL strings or {url:'/path/to/resource', type:'audio/mp3'} objects.\r\n     */\r\n\r\n    var i, j, urlResult = 0, result;\r\n\r\n    if (url instanceof Array) {\r\n\r\n      // find the first good one\r\n      for (i = 0, j = url.length; i < j; i++) {\r\n\r\n        if (url[i] instanceof Object) {\r\n\r\n          // MIME check\r\n          if (sm2.canPlayMIME(url[i].type)) {\r\n            urlResult = i;\r\n            break;\r\n          }\r\n\r\n        } else if (sm2.canPlayURL(url[i])) {\r\n\r\n          // URL string check\r\n          urlResult = i;\r\n          break;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      // normalize to string\r\n      if (url[urlResult].url) {\r\n        url[urlResult] = url[urlResult].url;\r\n      }\r\n\r\n      result = url[urlResult];\r\n\r\n    } else {\r\n\r\n      // single URL case\r\n      result = url;\r\n\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n\r\n  startTimer = function(oSound) {\r\n\r\n    /**\r\n     * attach a timer to this sound, and start an interval if needed\r\n     */\r\n\r\n    if (!oSound._hasTimer) {\r\n\r\n      oSound._hasTimer = true;\r\n\r\n      if (!mobileHTML5 && sm2.html5PollingInterval) {\r\n\r\n        if (h5IntervalTimer === null && h5TimerCount === 0) {\r\n\r\n          h5IntervalTimer = setInterval(timerExecute, sm2.html5PollingInterval);\r\n\r\n        }\r\n\r\n        h5TimerCount++;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  stopTimer = function(oSound) {\r\n\r\n    /**\r\n     * detach a timer\r\n     */\r\n\r\n    if (oSound._hasTimer) {\r\n\r\n      oSound._hasTimer = false;\r\n\r\n      if (!mobileHTML5 && sm2.html5PollingInterval) {\r\n\r\n        // interval will stop itself at next execution.\r\n\r\n        h5TimerCount--;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  timerExecute = function() {\r\n\r\n    /**\r\n     * manual polling for HTML5 progress events, ie., whileplaying()\r\n     * (can achieve greater precision than conservative default HTML5 interval)\r\n     */\r\n\r\n    var i;\r\n\r\n    if (h5IntervalTimer !== null && !h5TimerCount) {\r\n\r\n      // no active timers, stop polling interval.\r\n\r\n      clearInterval(h5IntervalTimer);\r\n\r\n      h5IntervalTimer = null;\r\n\r\n      return;\r\n\r\n    }\r\n\r\n    // check all HTML5 sounds with timers\r\n\r\n    for (i = sm2.soundIDs.length - 1; i >= 0; i--) {\r\n\r\n      if (sm2.sounds[sm2.soundIDs[i]].isHTML5 && sm2.sounds[sm2.soundIDs[i]]._hasTimer) {\r\n        sm2.sounds[sm2.soundIDs[i]]._onTimer();\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  catchError = function(options) {\r\n\r\n    options = (options !== _undefined ? options : {});\r\n\r\n    if (typeof sm2.onerror === 'function') {\r\n      sm2.onerror.apply(window, [{\r\n        type: (options.type !== _undefined ? options.type : null)\r\n      }]);\r\n    }\r\n\r\n    if (options.fatal !== _undefined && options.fatal) {\r\n      sm2.disable();\r\n    }\r\n\r\n  };\r\n\r\n  badSafariFix = function() {\r\n\r\n    // special case: \"bad\" Safari (OS X 10.3 - 10.7) must fall back to flash for MP3/MP4\r\n    if (!isBadSafari || !detectFlash()) {\r\n      // doesn't apply\r\n      return;\r\n    }\r\n\r\n    var aF = sm2.audioFormats, i, item;\r\n\r\n    for (item in aF) {\r\n\r\n      if (aF.hasOwnProperty(item)) {\r\n\r\n        if (item === 'mp3' || item === 'mp4') {\r\n\r\n          sm2._wD(sm + ': Using flash fallback for ' + item + ' format');\r\n          sm2.html5[item] = false;\r\n\r\n          // assign result to related formats, too\r\n          if (aF[item] && aF[item].related) {\r\n            for (i = aF[item].related.length - 1; i >= 0; i--) {\r\n              sm2.html5[aF[item].related[i]] = false;\r\n            }\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  /**\r\n   * Pseudo-private flash/ExternalInterface methods\r\n   * ----------------------------------------------\r\n   */\r\n\r\n  this._setSandboxType = function(sandboxType) {\r\n\r\n    // <d>\r\n    // Security sandbox according to Flash plugin\r\n    var sb = sm2.sandbox;\r\n\r\n    sb.type = sandboxType;\r\n    sb.description = sb.types[(sb.types[sandboxType] !== _undefined ? sandboxType : 'unknown')];\r\n\r\n    if (sb.type === 'localWithFile') {\r\n\r\n      sb.noRemote = true;\r\n      sb.noLocal = false;\r\n      _wDS('secNote', 2);\r\n\r\n    } else if (sb.type === 'localWithNetwork') {\r\n\r\n      sb.noRemote = false;\r\n      sb.noLocal = true;\r\n\r\n    } else if (sb.type === 'localTrusted') {\r\n\r\n      sb.noRemote = false;\r\n      sb.noLocal = false;\r\n\r\n    }\r\n    // </d>\r\n\r\n  };\r\n\r\n  this._externalInterfaceOK = function(swfVersion) {\r\n\r\n    // flash callback confirming flash loaded, EI working etc.\r\n    // swfVersion: SWF build string\r\n\r\n    if (sm2.swfLoaded) {\r\n      return;\r\n    }\r\n\r\n    var e;\r\n\r\n    debugTS('swf', true);\r\n    debugTS('flashtojs', true);\r\n    sm2.swfLoaded = true;\r\n    tryInitOnFocus = false;\r\n\r\n    if (isBadSafari) {\r\n      badSafariFix();\r\n    }\r\n\r\n    // complain if JS + SWF build/version strings don't match, excluding +DEV builds\r\n    // <d>\r\n    if (!swfVersion || swfVersion.replace(/\\+dev/i, '') !== sm2.versionNumber.replace(/\\+dev/i, '')) {\r\n\r\n      e = sm + ': Fatal: JavaScript file build \"' + sm2.versionNumber + '\" does not match Flash SWF build \"' + swfVersion + '\" at ' + sm2.url + '. Ensure both are up-to-date.';\r\n\r\n      // escape flash -> JS stack so this error fires in window.\r\n      setTimeout(function() {\r\n        throw new Error(e);\r\n      }, 0);\r\n\r\n      // exit, init will fail with timeout\r\n      return;\r\n\r\n    }\r\n    // </d>\r\n\r\n    // IE needs a larger timeout\r\n    setTimeout(init, isIE ? 100 : 1);\r\n\r\n  };\r\n\r\n  /**\r\n   * Private initialization helpers\r\n   * ------------------------------\r\n   */\r\n\r\n  createMovie = function(movieID, movieURL) {\r\n\r\n    // ignore if already connected\r\n    if (didAppend && appendSuccess) return false;\r\n\r\n    function initMsg() {\r\n\r\n      // <d>\r\n\r\n      var options = [],\r\n          title,\r\n          msg = [],\r\n          delimiter = ' + ';\r\n\r\n      title = 'SoundManager ' + sm2.version + (!sm2.html5Only && sm2.useHTML5Audio ? (sm2.hasHTML5 ? ' + HTML5 audio' : ', no HTML5 audio support') : '');\r\n\r\n      if (!sm2.html5Only) {\r\n\r\n        if (sm2.preferFlash) {\r\n          options.push('preferFlash');\r\n        }\r\n\r\n        if (sm2.useHighPerformance) {\r\n          options.push('useHighPerformance');\r\n        }\r\n\r\n        if (sm2.flashPollingInterval) {\r\n          options.push('flashPollingInterval (' + sm2.flashPollingInterval + 'ms)');\r\n        }\r\n\r\n        if (sm2.html5PollingInterval) {\r\n          options.push('html5PollingInterval (' + sm2.html5PollingInterval + 'ms)');\r\n        }\r\n\r\n        if (sm2.wmode) {\r\n          options.push('wmode (' + sm2.wmode + ')');\r\n        }\r\n\r\n        if (sm2.debugFlash) {\r\n          options.push('debugFlash');\r\n        }\r\n\r\n        if (sm2.useFlashBlock) {\r\n          options.push('flashBlock');\r\n        }\r\n\r\n      } else if (sm2.html5PollingInterval) {\r\n          options.push('html5PollingInterval (' + sm2.html5PollingInterval + 'ms)');\r\n        }\r\n\r\n      if (options.length) {\r\n        msg = msg.concat([options.join(delimiter)]);\r\n      }\r\n\r\n      sm2._wD(title + (msg.length ? delimiter + msg.join(', ') : ''), 1);\r\n\r\n      showSupport();\r\n\r\n      // </d>\r\n\r\n    }\r\n\r\n    if (sm2.html5Only) {\r\n\r\n      // 100% HTML5 mode\r\n      setVersionInfo();\r\n\r\n      initMsg();\r\n      sm2.oMC = id(sm2.movieID);\r\n      init();\r\n\r\n      // prevent multiple init attempts\r\n      didAppend = true;\r\n\r\n      appendSuccess = true;\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    // flash path\r\n    var remoteURL = (movieURL || sm2.url),\r\n    localURL = (sm2.altURL || remoteURL),\r\n    swfTitle = 'JS/Flash audio component (SoundManager 2)',\r\n    oTarget = getDocument(),\r\n    extraClass = getSWFCSS(),\r\n    isRTL = null,\r\n    html = doc.getElementsByTagName('html')[0],\r\n    oEmbed, oMovie, tmp, movieHTML, oEl, s, x, sClass;\r\n\r\n    isRTL = (html && html.dir && html.dir.match(/rtl/i));\r\n    movieID = (movieID === _undefined ? sm2.id : movieID);\r\n\r\n    function param(name, value) {\r\n      return '<param name=\"' + name + '\" value=\"' + value + '\" />';\r\n    }\r\n\r\n    // safety check for legacy (change to Flash 9 URL)\r\n    setVersionInfo();\r\n    sm2.url = normalizeMovieURL(overHTTP ? remoteURL : localURL);\r\n    movieURL = sm2.url;\r\n\r\n    sm2.wmode = (!sm2.wmode && sm2.useHighPerformance ? 'transparent' : sm2.wmode);\r\n\r\n    if (sm2.wmode !== null && (ua.match(/msie 8/i) || (!isIE && !sm2.useHighPerformance)) && navigator.platform.match(/win32|win64/i)) {\r\n      /**\r\n       * extra-special case: movie doesn't load until scrolled into view when using wmode = anything but 'window' here\r\n       * does not apply when using high performance (position:fixed means on-screen), OR infinite flash load timeout\r\n       * wmode breaks IE 8 on Vista + Win7 too in some cases, as of January 2011 (?)\r\n       */\r\n      messages.push(strings.spcWmode);\r\n      sm2.wmode = null;\r\n    }\r\n\r\n    oEmbed = {\r\n      name: movieID,\r\n      id: movieID,\r\n      src: movieURL,\r\n      quality: 'high',\r\n      allowScriptAccess: sm2.allowScriptAccess,\r\n      bgcolor: sm2.bgColor,\r\n      pluginspage: http + 'www.macromedia.com/go/getflashplayer',\r\n      title: swfTitle,\r\n      type: 'application/x-shockwave-flash',\r\n      wmode: sm2.wmode,\r\n      // http://help.adobe.com/en_US/as3/mobile/WS4bebcd66a74275c36cfb8137124318eebc6-7ffd.html\r\n      hasPriority: 'true'\r\n    };\r\n\r\n    if (sm2.debugFlash) {\r\n      oEmbed.FlashVars = 'debug=1';\r\n    }\r\n\r\n    if (!sm2.wmode) {\r\n      // don't write empty attribute\r\n      delete oEmbed.wmode;\r\n    }\r\n\r\n    if (isIE) {\r\n\r\n      // IE is \"special\".\r\n      oMovie = doc.createElement('div');\r\n      movieHTML = [\r\n        '<object id=\"' + movieID + '\" data=\"' + movieURL + '\" type=\"' + oEmbed.type + '\" title=\"' + oEmbed.title + '\" classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" codebase=\"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0\">',\r\n        param('movie', movieURL),\r\n        param('AllowScriptAccess', sm2.allowScriptAccess),\r\n        param('quality', oEmbed.quality),\r\n        (sm2.wmode ? param('wmode', sm2.wmode) : ''),\r\n        param('bgcolor', sm2.bgColor),\r\n        param('hasPriority', 'true'),\r\n        (sm2.debugFlash ? param('FlashVars', oEmbed.FlashVars) : ''),\r\n        '</object>'\r\n      ].join('');\r\n\r\n    } else {\r\n\r\n      oMovie = doc.createElement('embed');\r\n      for (tmp in oEmbed) {\r\n        if (oEmbed.hasOwnProperty(tmp)) {\r\n          oMovie.setAttribute(tmp, oEmbed[tmp]);\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n    initDebug();\r\n    extraClass = getSWFCSS();\r\n    oTarget = getDocument();\r\n\r\n    if (oTarget) {\r\n\r\n      sm2.oMC = (id(sm2.movieID) || doc.createElement('div'));\r\n\r\n      if (!sm2.oMC.id) {\r\n\r\n        sm2.oMC.id = sm2.movieID;\r\n        sm2.oMC.className = swfCSS.swfDefault + ' ' + extraClass;\r\n        s = null;\r\n        oEl = null;\r\n\r\n        if (!sm2.useFlashBlock) {\r\n          if (sm2.useHighPerformance) {\r\n            // on-screen at all times\r\n            s = {\r\n              position: 'fixed',\r\n              width: '8px',\r\n              height: '8px',\r\n              // >= 6px for flash to run fast, >= 8px to start up under Firefox/win32 in some cases. odd? yes.\r\n              bottom: '0px',\r\n              left: '0px',\r\n              overflow: 'hidden'\r\n            };\r\n          } else {\r\n            // hide off-screen, lower priority\r\n            s = {\r\n              position: 'absolute',\r\n              width: '6px',\r\n              height: '6px',\r\n              top: '-9999px',\r\n              left: '-9999px'\r\n            };\r\n            if (isRTL) {\r\n              s.left = Math.abs(parseInt(s.left, 10)) + 'px';\r\n            }\r\n          }\r\n        }\r\n\r\n        if (isWebkit) {\r\n          // soundcloud-reported render/crash fix, safari 5\r\n          sm2.oMC.style.zIndex = 10000;\r\n        }\r\n\r\n        if (!sm2.debugFlash) {\r\n          for (x in s) {\r\n            if (s.hasOwnProperty(x)) {\r\n              sm2.oMC.style[x] = s[x];\r\n            }\r\n          }\r\n        }\r\n\r\n        try {\r\n\r\n          if (!isIE) {\r\n            sm2.oMC.appendChild(oMovie);\r\n          }\r\n\r\n          oTarget.appendChild(sm2.oMC);\r\n\r\n          if (isIE) {\r\n            oEl = sm2.oMC.appendChild(doc.createElement('div'));\r\n            oEl.className = swfCSS.swfBox;\r\n            oEl.innerHTML = movieHTML;\r\n          }\r\n\r\n          appendSuccess = true;\r\n\r\n        } catch(e) {\r\n\r\n          throw new Error(str('domError') + ' \\n' + e.toString());\r\n\r\n        }\r\n\r\n      } else {\r\n\r\n        // SM2 container is already in the document (eg. flashblock use case)\r\n        sClass = sm2.oMC.className;\r\n        sm2.oMC.className = (sClass ? sClass + ' ' : swfCSS.swfDefault) + (extraClass ? ' ' + extraClass : '');\r\n        sm2.oMC.appendChild(oMovie);\r\n\r\n        if (isIE) {\r\n          oEl = sm2.oMC.appendChild(doc.createElement('div'));\r\n          oEl.className = swfCSS.swfBox;\r\n          oEl.innerHTML = movieHTML;\r\n        }\r\n\r\n        appendSuccess = true;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    didAppend = true;\r\n\r\n    initMsg();\r\n\r\n    // sm2._wD(sm + ': Trying to load ' + movieURL + (!overHTTP && sm2.altURL ? ' (alternate URL)' : ''), 1);\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  initMovie = function() {\r\n\r\n    if (sm2.html5Only) {\r\n      createMovie();\r\n      return false;\r\n    }\r\n\r\n    // attempt to get, or create, movie (may already exist)\r\n    if (flash) return false;\r\n\r\n    if (!sm2.url) {\r\n\r\n      /**\r\n       * Something isn't right - we've reached init, but the soundManager url property has not been set.\r\n       * User has not called setup({url: ...}), or has not set soundManager.url (legacy use case) directly before init time.\r\n       * Notify and exit. If user calls setup() with a url: property, init will be restarted as in the deferred loading case.\r\n       */\r\n\r\n       _wDS('noURL');\r\n       return false;\r\n\r\n    }\r\n\r\n    // inline markup case\r\n    flash = sm2.getMovie(sm2.id);\r\n\r\n    if (!flash) {\r\n\r\n      if (!oRemoved) {\r\n\r\n        // try to create\r\n        createMovie(sm2.id, sm2.url);\r\n\r\n      } else {\r\n\r\n        // try to re-append removed movie after reboot()\r\n        if (!isIE) {\r\n          sm2.oMC.appendChild(oRemoved);\r\n        } else {\r\n          sm2.oMC.innerHTML = oRemovedHTML;\r\n        }\r\n\r\n        oRemoved = null;\r\n        didAppend = true;\r\n\r\n      }\r\n\r\n      flash = sm2.getMovie(sm2.id);\r\n\r\n    }\r\n\r\n    if (typeof sm2.oninitmovie === 'function') {\r\n      setTimeout(sm2.oninitmovie, 1);\r\n    }\r\n\r\n    // <d>\r\n    flushMessages();\r\n    // </d>\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  delayWaitForEI = function() {\r\n\r\n    setTimeout(waitForEI, 1000);\r\n\r\n  };\r\n\r\n  rebootIntoHTML5 = function() {\r\n\r\n    // special case: try for a reboot with preferFlash: false, if 100% HTML5 mode is possible and useFlashBlock is not enabled.\r\n\r\n    window.setTimeout(function() {\r\n\r\n      complain(smc + 'useFlashBlock is false, 100% HTML5 mode is possible. Rebooting with preferFlash: false...');\r\n\r\n      sm2.setup({\r\n        preferFlash: false\r\n      }).reboot();\r\n\r\n      // if for some reason you want to detect this case, use an ontimeout() callback and look for html5Only and didFlashBlock == true.\r\n      sm2.didFlashBlock = true;\r\n\r\n      sm2.beginDelayedInit();\r\n\r\n    }, 1);\r\n\r\n  };\r\n\r\n  waitForEI = function() {\r\n\r\n    var p,\r\n        loadIncomplete = false;\r\n\r\n    if (!sm2.url) {\r\n      // No SWF url to load (noURL case) - exit for now. Will be retried when url is set.\r\n      return;\r\n    }\r\n\r\n    if (waitingForEI) {\r\n      return;\r\n    }\r\n\r\n    waitingForEI = true;\r\n    event.remove(window, 'load', delayWaitForEI);\r\n\r\n    if (hasFlash && tryInitOnFocus && !isFocused) {\r\n      // Safari won't load flash in background tabs, only when focused.\r\n      _wDS('waitFocus');\r\n      return;\r\n    }\r\n\r\n    if (!didInit) {\r\n      p = sm2.getMoviePercent();\r\n      if (p > 0 && p < 100) {\r\n        loadIncomplete = true;\r\n      }\r\n    }\r\n\r\n    setTimeout(function() {\r\n\r\n      p = sm2.getMoviePercent();\r\n\r\n      if (loadIncomplete) {\r\n        // special case: if movie *partially* loaded, retry until it's 100% before assuming failure.\r\n        waitingForEI = false;\r\n        sm2._wD(str('waitSWF'));\r\n        window.setTimeout(delayWaitForEI, 1);\r\n        return;\r\n      }\r\n\r\n      // <d>\r\n      if (!didInit) {\r\n\r\n        sm2._wD(sm + ': No Flash response within expected time. Likely causes: ' + (p === 0 ? 'SWF load failed, ' : '') + 'Flash blocked or JS-Flash security error.' + (sm2.debugFlash ? ' ' + str('checkSWF') : ''), 2);\r\n\r\n        if (!overHTTP && p) {\r\n\r\n          _wDS('localFail', 2);\r\n\r\n          if (!sm2.debugFlash) {\r\n            _wDS('tryDebug', 2);\r\n          }\r\n\r\n        }\r\n\r\n        if (p === 0) {\r\n\r\n          // if 0 (not null), probably a 404.\r\n          sm2._wD(str('swf404', sm2.url), 1);\r\n\r\n        }\r\n\r\n        debugTS('flashtojs', false, ': Timed out' + (overHTTP ? ' (Check flash security or flash blockers)' : ' (No plugin/missing SWF?)'));\r\n\r\n      }\r\n      // </d>\r\n\r\n      // give up / time-out, depending\r\n\r\n      if (!didInit && okToDisable) {\r\n\r\n        if (p === null) {\r\n\r\n          // SWF failed to report load progress. Possibly blocked.\r\n\r\n          if (sm2.useFlashBlock || sm2.flashLoadTimeout === 0) {\r\n\r\n            if (sm2.useFlashBlock) {\r\n\r\n              flashBlockHandler();\r\n\r\n            }\r\n\r\n            _wDS('waitForever');\r\n\r\n          } else if (!sm2.useFlashBlock && canIgnoreFlash) {\r\n\r\n            // no custom flash block handling, but SWF has timed out. Will recover if user unblocks / allows SWF load.\r\n            rebootIntoHTML5();\r\n\r\n          } else {\r\n\r\n            _wDS('waitForever');\r\n\r\n            // fire any regular registered ontimeout() listeners.\r\n            processOnEvents({\r\n              type: 'ontimeout',\r\n              ignoreInit: true,\r\n              error: {\r\n                type: 'INIT_FLASHBLOCK'\r\n              }\r\n            });\r\n\r\n          }\r\n\r\n        } else if (sm2.flashLoadTimeout === 0) {\r\n\r\n          // SWF loaded? Shouldn't be a blocking issue, then.\r\n\r\n          _wDS('waitForever');\r\n\r\n        } else if (!sm2.useFlashBlock && canIgnoreFlash) {\r\n\r\n          rebootIntoHTML5();\r\n\r\n        } else {\r\n\r\n          failSafely(true);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }, sm2.flashLoadTimeout);\r\n\r\n  };\r\n\r\n  handleFocus = function() {\r\n\r\n    function cleanup() {\r\n      event.remove(window, 'focus', handleFocus);\r\n    }\r\n\r\n    if (isFocused || !tryInitOnFocus) {\r\n      // already focused, or not special Safari background tab case\r\n      cleanup();\r\n      return true;\r\n    }\r\n\r\n    okToDisable = true;\r\n    isFocused = true;\r\n    _wDS('gotFocus');\r\n\r\n    // allow init to restart\r\n    waitingForEI = false;\r\n\r\n    // kick off ExternalInterface timeout, now that the SWF has started\r\n    delayWaitForEI();\r\n\r\n    cleanup();\r\n    return true;\r\n\r\n  };\r\n\r\n  flushMessages = function() {\r\n\r\n    // <d>\r\n\r\n    // SM2 pre-init debug messages\r\n    if (messages.length) {\r\n      sm2._wD('SoundManager 2: ' + messages.join(' '), 1);\r\n      messages = [];\r\n    }\r\n\r\n    // </d>\r\n\r\n  };\r\n\r\n  showSupport = function() {\r\n\r\n    // <d>\r\n\r\n    flushMessages();\r\n\r\n    var item, tests = [];\r\n\r\n    if (sm2.useHTML5Audio && sm2.hasHTML5) {\r\n      for (item in sm2.audioFormats) {\r\n        if (sm2.audioFormats.hasOwnProperty(item)) {\r\n          tests.push(item + ' = ' + sm2.html5[item] + (!sm2.html5[item] && needsFlash && sm2.flash[item] ? ' (using flash)' : (sm2.preferFlash && sm2.flash[item] && needsFlash ? ' (preferring flash)' : (!sm2.html5[item] ? ' (' + (sm2.audioFormats[item].required ? 'required, ' : '') + 'and no flash support)' : ''))));\r\n        }\r\n      }\r\n      sm2._wD('SoundManager 2 HTML5 support: ' + tests.join(', '), 1);\r\n    }\r\n\r\n    // </d>\r\n\r\n  };\r\n\r\n  initComplete = function(bNoDisable) {\r\n\r\n    if (didInit) return false;\r\n\r\n    if (sm2.html5Only) {\r\n      // all good.\r\n      _wDS('sm2Loaded', 1);\r\n      didInit = true;\r\n      initUserOnload();\r\n      debugTS('onload', true);\r\n      return true;\r\n    }\r\n\r\n    var wasTimeout = (sm2.useFlashBlock && sm2.flashLoadTimeout && !sm2.getMoviePercent()),\r\n        result = true,\r\n        error;\r\n\r\n    if (!wasTimeout) {\r\n      didInit = true;\r\n    }\r\n\r\n    error = {\r\n      type: (!hasFlash && needsFlash ? 'NO_FLASH' : 'INIT_TIMEOUT')\r\n    };\r\n\r\n    sm2._wD('SoundManager 2 ' + (disabled ? 'failed to load' : 'loaded') + ' (' + (disabled ? 'Flash security/load error' : 'OK') + ') ' + String.fromCharCode(disabled ? 10006 : 10003), disabled ? 2 : 1);\r\n\r\n    if (disabled || bNoDisable) {\r\n\r\n      if (sm2.useFlashBlock && sm2.oMC) {\r\n        sm2.oMC.className = getSWFCSS() + ' ' + (sm2.getMoviePercent() === null ? swfCSS.swfTimedout : swfCSS.swfError);\r\n      }\r\n\r\n      processOnEvents({\r\n        type: 'ontimeout',\r\n        error: error,\r\n        ignoreInit: true\r\n      });\r\n\r\n      debugTS('onload', false);\r\n      catchError(error);\r\n\r\n      result = false;\r\n\r\n    } else {\r\n\r\n      debugTS('onload', true);\r\n\r\n    }\r\n\r\n    if (!disabled) {\r\n\r\n      if (sm2.waitForWindowLoad && !windowLoaded) {\r\n\r\n        _wDS('waitOnload');\r\n        event.add(window, 'load', initUserOnload);\r\n\r\n      } else {\r\n\r\n        // <d>\r\n        if (sm2.waitForWindowLoad && windowLoaded) {\r\n          _wDS('docLoaded');\r\n        }\r\n        // </d>\r\n\r\n        initUserOnload();\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  /**\r\n   * apply top-level setupOptions object as local properties, eg., this.setupOptions.flashVersion -> this.flashVersion (soundManager.flashVersion)\r\n   * this maintains backward compatibility, and allows properties to be defined separately for use by soundManager.setup().\r\n   */\r\n\r\n  setProperties = function() {\r\n\r\n    var i,\r\n        o = sm2.setupOptions;\r\n\r\n    for (i in o) {\r\n\r\n      if (o.hasOwnProperty(i)) {\r\n\r\n        // assign local property if not already defined\r\n\r\n        if (sm2[i] === _undefined) {\r\n\r\n          sm2[i] = o[i];\r\n\r\n        } else if (sm2[i] !== o[i]) {\r\n\r\n          // legacy support: write manually-assigned property (eg., soundManager.url) back to setupOptions to keep things in sync\r\n          sm2.setupOptions[i] = sm2[i];\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n\r\n  init = function() {\r\n\r\n    // called after onload()\r\n\r\n    if (didInit) {\r\n      _wDS('didInit');\r\n      return false;\r\n    }\r\n\r\n    function cleanup() {\r\n      event.remove(window, 'load', sm2.beginDelayedInit);\r\n    }\r\n\r\n    if (sm2.html5Only) {\r\n\r\n      if (!didInit) {\r\n        // we don't need no steenking flash!\r\n        cleanup();\r\n        sm2.enabled = true;\r\n        initComplete();\r\n      }\r\n\r\n      return true;\r\n\r\n    }\r\n\r\n    // flash path\r\n    initMovie();\r\n\r\n    try {\r\n\r\n      // attempt to talk to Flash\r\n      flash._externalInterfaceTest(false);\r\n\r\n      /**\r\n       * Apply user-specified polling interval, OR, if \"high performance\" set, faster vs. default polling\r\n       * (determines frequency of whileloading/whileplaying callbacks, effectively driving UI framerates)\r\n       */\r\n      setPolling(true, (sm2.flashPollingInterval || (sm2.useHighPerformance ? 10 : 50)));\r\n\r\n      if (!sm2.debugMode) {\r\n        // stop the SWF from making debug output calls to JS\r\n        flash._disableDebug();\r\n      }\r\n\r\n      sm2.enabled = true;\r\n      debugTS('jstoflash', true);\r\n\r\n      if (!sm2.html5Only) {\r\n        // prevent browser from showing cached page state (or rather, restoring \"suspended\" page state) via back button, because flash may be dead\r\n        // http://www.webkit.org/blog/516/webkit-page-cache-ii-the-unload-event/\r\n        event.add(window, 'unload', doNothing);\r\n      }\r\n\r\n    } catch(e) {\r\n\r\n      sm2._wD('js/flash exception: ' + e.toString());\r\n\r\n      debugTS('jstoflash', false);\r\n\r\n      catchError({\r\n        type: 'JS_TO_FLASH_EXCEPTION',\r\n        fatal: true\r\n      });\r\n\r\n      // don't disable, for reboot()\r\n      failSafely(true);\r\n\r\n      initComplete();\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    initComplete();\r\n\r\n    // disconnect events\r\n    cleanup();\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  domContentLoaded = function() {\r\n\r\n    if (didDCLoaded) return false;\r\n\r\n    didDCLoaded = true;\r\n\r\n    // assign top-level soundManager properties eg. soundManager.url\r\n    setProperties();\r\n\r\n    initDebug();\r\n\r\n    if (!hasFlash && sm2.hasHTML5) {\r\n\r\n      sm2._wD('SoundManager 2: No Flash detected' + (!sm2.useHTML5Audio ? ', enabling HTML5.' : '. Trying HTML5-only mode.'), 1);\r\n\r\n      sm2.setup({\r\n        useHTML5Audio: true,\r\n        // make sure we aren't preferring flash, either\r\n        // TODO: preferFlash should not matter if flash is not installed. Currently, stuff breaks without the below tweak.\r\n        preferFlash: false\r\n      });\r\n\r\n    }\r\n\r\n    testHTML5();\r\n\r\n    if (!hasFlash && needsFlash) {\r\n\r\n      messages.push(strings.needFlash);\r\n\r\n      // TODO: Fatal here vs. timeout approach, etc.\r\n      // hack: fail sooner.\r\n      sm2.setup({\r\n        flashLoadTimeout: 1\r\n      });\r\n\r\n    }\r\n\r\n    if (doc.removeEventListener) {\r\n      doc.removeEventListener('DOMContentLoaded', domContentLoaded, false);\r\n    }\r\n\r\n    initMovie();\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  domContentLoadedIE = function() {\r\n\r\n    if (doc.readyState === 'complete') {\r\n      domContentLoaded();\r\n      doc.detachEvent('onreadystatechange', domContentLoadedIE);\r\n    }\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  winOnLoad = function() {\r\n\r\n    // catch edge case of initComplete() firing after window.load()\r\n    windowLoaded = true;\r\n\r\n    // catch case where DOMContentLoaded has been sent, but we're still in doc.readyState = 'interactive'\r\n    domContentLoaded();\r\n\r\n    event.remove(window, 'load', winOnLoad);\r\n\r\n  };\r\n\r\n  // sniff up-front\r\n  detectFlash();\r\n\r\n  // focus and window load, init (primarily flash-driven)\r\n  event.add(window, 'focus', handleFocus);\r\n  event.add(window, 'load', delayWaitForEI);\r\n  event.add(window, 'load', winOnLoad);\r\n\r\n  if (doc.addEventListener) {\r\n\r\n    doc.addEventListener('DOMContentLoaded', domContentLoaded, false);\r\n\r\n  } else if (doc.attachEvent) {\r\n\r\n    doc.attachEvent('onreadystatechange', domContentLoadedIE);\r\n\r\n  } else {\r\n\r\n    // no add/attachevent support - safe to assume no JS -> Flash either\r\n    debugTS('onload', false);\r\n    catchError({\r\n      type: 'NO_DOM2_EVENTS',\r\n      fatal: true\r\n    });\r\n\r\n  }\r\n\r\n} // SoundManager()\r\n\r\n// SM2_DEFER details: http://www.schillmania.com/projects/soundmanager2/doc/getstarted/#lazy-loading\r\n\r\nif (window.SM2_DEFER === _undefined || !SM2_DEFER) {\r\n  soundManager = new SoundManager();\r\n}\r\n\r\n/**\r\n * SoundManager public interfaces\r\n * ------------------------------\r\n */\r\n\r\nif (typeof module === 'object' && module && typeof module.exports === 'object') {\r\n\r\n  /**\r\n   * commonJS module\r\n   */\r\n\r\n  module.exports.SoundManager = SoundManager;\r\n  module.exports.soundManager = soundManager;\r\n\r\n} else if (typeof define === 'function' && define.amd) {\r\n\r\n  /**\r\n   * AMD - requireJS\r\n   * basic usage:\r\n   * require([\"/path/to/soundmanager2.js\"], function(SoundManager) {\r\n   *   SoundManager.getInstance().setup({\r\n   *     url: '/swf/',\r\n   *     onready: function() { ... }\r\n   *   })\r\n   * });\r\n   *\r\n   * SM2_DEFER usage:\r\n   * window.SM2_DEFER = true;\r\n   * require([\"/path/to/soundmanager2.js\"], function(SoundManager) {\r\n   *   SoundManager.getInstance(function() {\r\n   *     var soundManager = new SoundManager.constructor();\r\n   *     soundManager.setup({\r\n   *       url: '/swf/',\r\n   *       ...\r\n   *     });\r\n   *     ...\r\n   *     soundManager.beginDelayedInit();\r\n   *     return soundManager;\r\n   *   })\r\n   * });\r\n   */\r\n\r\n  define(function() {\r\n    /**\r\n     * Retrieve the global instance of SoundManager.\r\n     * If a global instance does not exist it can be created using a callback.\r\n     *\r\n     * @param {Function} smBuilder Optional: Callback used to create a new SoundManager instance\r\n     * @return {SoundManager} The global SoundManager instance\r\n     */\r\n    function getInstance(smBuilder) {\r\n      if (!window.soundManager && smBuilder instanceof Function) {\r\n        var instance = smBuilder(SoundManager);\r\n        if (instance instanceof SoundManager) {\r\n          window.soundManager = instance;\r\n        }\r\n      }\r\n      return window.soundManager;\r\n    }\r\n    return {\r\n      constructor: SoundManager,\r\n      getInstance: getInstance\r\n    };\r\n  });\r\n\r\n}\r\n\r\n// standard browser case\r\n\r\n// constructor\r\nwindow.SoundManager = SoundManager;\r\n\r\n/**\r\n * note: SM2 requires a window global due to Flash, which makes calls to window.soundManager.\r\n * Flash may not always be needed, but this is not known until async init and SM2 may even \"reboot\" into Flash mode.\r\n */\r\n\r\n// public API, flash callbacks etc.\r\nwindow.soundManager = soundManager;\r\n\r\n}(window));\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","import Game from './components/Game';\nimport { preloadSounds } from './utils/sound';\nimport video from '../img/intro.mp4';\nimport { MenuSounds } from './components/Audio';\n\nconst SLIDE_MAP = {\n  LEFT: 'left',\n  RIGHT: 'right',\n};\n\nconst SLIDE_CONFIG = {\n  [SLIDE_MAP.LEFT]: {\n    title: document.querySelector(`.slider-${SLIDE_MAP.LEFT} .slider-title`),\n    data: document.querySelector(`.slider-${SLIDE_MAP.LEFT} .slider-data`),\n  },\n  [SLIDE_MAP.RIGHT]: {\n    title: document.querySelector(`.slider-${SLIDE_MAP.RIGHT} .slider-title`),\n    data: document.querySelector(`.slider-${SLIDE_MAP.RIGHT} .slider-data`),\n  },\n};\n\nconst snowBlock = document.querySelector('.snow');\nconst checkbox = document.querySelector('#checkbox');\nconst playButton = document.querySelector('#play');\nconst mainBlock = document.querySelector('.menu');\n\nconst hideMainBlock = () => {\n  mainBlock.classList.add('fadeOut');\n\n  setTimeout(() => mainBlock.classList.add('none'), 700);\n};\n\nconst snowHandler = () => {\n  if (snowBlock.style.display === 'block') snowBlock.style.display = 'none';\n  else snowBlock.style.display = 'block';\n};\n\nconst setSlides = (side, isHovered) => {\n  const value = isHovered ? '50px' : 'calc(-40vw - 70px)';\n  const direction = isHovered ? 'over' : 'out';\n\n  const mouseMoveHandler = () => {\n    SLIDE_CONFIG[side].data.style[side] = value;\n  };\n\n  SLIDE_CONFIG[side].title.addEventListener(\n    `mouse${direction}`,\n    mouseMoveHandler,\n  );\n};\n\nconst changeGameMode = (game, menuSounds) => {\n  if (checkbox.checked) {\n    snowBlock.classList.add('block');\n\n    menuSounds.winterModeSound();\n    game.setToWinter();\n  } else {\n    snowBlock.classList.remove('block');\n\n    game.setToVanilla();\n  }\n};\n\nconst initializeSlides = () => {\n  setSlides(SLIDE_MAP.LEFT, true);\n  setSlides(SLIDE_MAP.LEFT, false);\n  setSlides(SLIDE_MAP.RIGHT, true);\n  setSlides(SLIDE_MAP.RIGHT, false);\n};\n\nconst init = () => {\n  const game = new Game();\n  const menuSounds = new MenuSounds();\n\n  const checkboxHandler = () => {\n    snowHandler();\n    changeGameMode(game, menuSounds);\n  };\n\n  const gameHandler = () => {\n    hideMainBlock();\n    MenuSounds.disableMenuSounds();\n\n    game.loadGame();\n  };\n\n  checkbox.addEventListener('change', checkboxHandler);\n  playButton.addEventListener('click', gameHandler);\n\n  initializeSlides();\n  preloadSounds();\n\n  menuSounds.enableMenuSounds();\n  game.setToVanilla();\n};\n\ndocument.addEventListener('DOMContentLoaded', init);\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};"],"sourceRoot":""}